
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 8 - spaCy and textaCy &#8212; Text Analysis and Machine Learning (TAML) Group</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 9 - New Developments: Topic Modeling with BERTopic!" href="9_BERTopic.html" />
    <link rel="prev" title="Chapter 7 - English text preprocessing basics - and applications" href="7_English_text_preprocessing_basics_applications.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Text Analysis and Machine Learning (TAML) Group</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to TAML!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_How_to_use_this_book.html">
   Chapter 1 - How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Python_environments.html">
   Chapter 2 - Python environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Basic_Python_syntax.html">
   Chapter 3 - Basic Python syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Numeric_data_wrangling.html">
   Chapter 4 - Numeric data wrangling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Data_visualization_essentials.html">
   Chapter 5 - Data visualization essentials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Text analysis and machine learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="6_Core_concepts_vocabularies.html">
   Chapter 6 - Core machine learning concepts; building text vocabularies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_English_text_preprocessing_basics_applications.html">
   Chapter 7 - English text preprocessing basics - and applications
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 8 - spaCy and textaCy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_BERTopic.html">
   Chapter 9 - New Developments: Topic Modeling with BERTopic!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix.html">
   <strong>
    Appendix
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions.html">
   Solutions
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/EastBayEv/SSDS-TAML/master?urlpath=tree/spring2023/8_spaCy_textaCy.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/EastBayEv/SSDS-TAML"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/EastBayEv/SSDS-TAML/issues/new?title=Issue%20on%20page%20%2Fspring2023/8_spaCy_textaCy.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/spring2023/8_spaCy_textaCy.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Chapter 8 - spaCy and textaCy
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-spacy-and-textacy">
     Why spaCy and textacy?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#topics">
       Topics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-brief-word-about-terms">
       A brief word about terms
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#document-level-analysis-with-spacy">
   Document-level analysis with
   <code class="docutils literal notranslate">
    <span class="pre">
     spaCy
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tokenization">
     Tokenization
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filtering-tokens">
       Filtering tokens
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#counting-tokens">
       Counting tokens
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-of-speech-tagging">
     Part-of-speech tagging
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parsing">
       Parsing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#named-entity-recognition">
     Named-entity recognition
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-parses">
       Visualizing Parses
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corpus-level-analysis-with-textacy">
   Corpus-level analysis with
   <code class="docutils literal notranslate">
    <span class="pre">
     textacy
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-corpora">
     Generating corpora
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-important-words-in-the-corpus">
     Finding important words in the corpus
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keyword-in-context">
     Keyword in context
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectorization">
     Vectorization
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-topic-modeling">
     Exercise - topic modeling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#document-similarity-with-word2vec-and-clustering">
     Document similarity with word2vec and clustering
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#topic-modeling-going-further">
     Topic modeling - going further
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chapter 8 - spaCy and textaCy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Chapter 8 - spaCy and textaCy
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-spacy-and-textacy">
     Why spaCy and textacy?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#topics">
       Topics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-brief-word-about-terms">
       A brief word about terms
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#document-level-analysis-with-spacy">
   Document-level analysis with
   <code class="docutils literal notranslate">
    <span class="pre">
     spaCy
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tokenization">
     Tokenization
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filtering-tokens">
       Filtering tokens
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#counting-tokens">
       Counting tokens
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-of-speech-tagging">
     Part-of-speech tagging
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parsing">
       Parsing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#named-entity-recognition">
     Named-entity recognition
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-parses">
       Visualizing Parses
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corpus-level-analysis-with-textacy">
   Corpus-level analysis with
   <code class="docutils literal notranslate">
    <span class="pre">
     textacy
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-corpora">
     Generating corpora
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-important-words-in-the-corpus">
     Finding important words in the corpus
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keyword-in-context">
     Keyword in context
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectorization">
     Vectorization
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-topic-modeling">
     Exercise - topic modeling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#document-similarity-with-word2vec-and-clustering">
     Document similarity with word2vec and clustering
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#topic-modeling-going-further">
     Topic modeling - going further
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-8-spacy-and-textacy">
<h1>Chapter 8 - spaCy and textaCy<a class="headerlink" href="#chapter-8-spacy-and-textacy" title="Permalink to this heading">#</a></h1>
<p>2023 April 7</p>
<blockquote>
<div><p>These abridged materials are borrowed from the CIDR Workshop <a class="reference external" href="https://github.com/sul-cidr/Workshops/tree/master/Text_Analysis_with_Python">Text Analysis with Python</a></p>
</div></blockquote>
<a target="_blank" href="https://colab.research.google.com/github/EastBayEv/SSDS-TAML/blob/main/spring2023/8_spaCy_textaCy.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><section id="why-spacy-and-textacy">
<h2>Why spaCy and textacy?<a class="headerlink" href="#why-spacy-and-textacy" title="Permalink to this heading">#</a></h2>
<p>The language processing features of spaCy and the corpus analysis methods of textacy together offer a wide range of functionality for text analysis in a well-maintained and well-documented software package that incorporates cutting-edge techniques as well as standard approaches.</p>
<p>The “C” in spaCy (and textacy) stands for Cython, which is Python that is compiled to C code and thus offers some performance advantages over interpreted Python, especially when working with large machine-learning models. The use of machine-learning models, including neural networks, is a key feature of spaCy and textacy. The writers of these libraries also have developed <a class="reference external" href="https://prodi.gy/">Prodigy</a>, a similarly leading-edge but approachable tool for training custom machine-learning models for text analysis, among other uses.</p>
<p>Check out the <a class="reference external" href="https://spacy.io/usage/spacy-101">spaCy 101</a> to learn more.</p>
<section id="topics">
<h3>Topics<a class="headerlink" href="#topics" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Document Tokenization</p></li>
<li><p>Part-of-Speech (POS) Tagging</p></li>
<li><p>Named-Entity Recognition (NER)</p></li>
<li><p>Corpus Vectorization</p></li>
<li><p>Topic Modeling</p></li>
<li><p>Document Similarity</p></li>
<li><p>Stylistic Analysis</p></li>
</ul>
<p><strong>Note:</strong> The examples from this workshop use English texts, but all of the methods are applicable to other languages. The availability of specialized resources (parsing rules, dictionaries, trained models) can vary considerably by language, however.</p>
</section>
<section id="a-brief-word-about-terms">
<h3>A brief word about terms<a class="headerlink" href="#a-brief-word-about-terms" title="Permalink to this heading">#</a></h3>
<p><strong>Text analysis</strong> involves extraction of information from significant amounts  of free-form text, e.g., literature (prose, poetry), historical records, long-form survey responses, legal documents. Some of the techniques used also are applicable to short-form text data, including documents that are already in tabular format.</p>
<p>Text analysis methods are built upon techniques for <strong>Natural Language Processing</strong> (NLP), which began as rule-based approaches to parsing human language and eventually incorporated statistical machine learning methods as well as, most recently, neural network/deep learning-based approaches.</p>
<p><strong>Text mining</strong> typically refers to the extraction of information from very large corpora of unstructured texts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install textacy</span>
<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">import</span> <span class="nn">textacy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-04-20 11:49:35.321792: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.23.5
  warnings.warn(f&quot;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&quot;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="document-level-analysis-with-spacy">
<h1>Document-level analysis with <code class="docutils literal notranslate"><span class="pre">spaCy</span></code><a class="headerlink" href="#document-level-analysis-with-spacy" title="Permalink to this heading">#</a></h1>
<p>Let’s start by learning how spaCy works and using it to begin analyzing a single text document. We’ll work with larger corpora later in the workshop.</p>
<p>For this workshop we will work with a pre-trained statistical and deep-learning model provided by spaCy to process text. spaCy’s <a class="reference external" href="https://spacy.io/models">models</a> are differentiated by language (21 languages are supported at present), capabilities, training text, and size. Smaller models are more efficient; larger models are more accurate. Here we’ll download and use a medium-sized English multi-task model, which supports part of speech tagging, entity recognition, and includes a word vector model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python -m spacy download en_core_web_md
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-04-20 11:49:42.448832: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.23.5
  warnings.warn(f&quot;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
Collecting en-core-web-md==3.3.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_md-3.3.0/en_core_web_md-3.3.0-py3-none-any.whl (33.5 MB)
?25l     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/33.5 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.2/33.5 MB</span> <span class=" -Color -Color-Red">7.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:05</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.1/33.5 MB</span> <span class=" -Color -Color-Red">16.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
     ━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">2.9/33.5 MB</span> <span class=" -Color -Color-Red">27.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">37.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">37.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">37.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">20.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">20.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.3/33.5 MB</span> <span class=" -Color -Color-Red">20.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
     ━━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">6.0/33.5 MB</span> <span class=" -Color -Color-Red">16.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">8.2/33.5 MB</span> <span class=" -Color -Color-Red">20.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:02</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">10.7/33.5 MB</span> <span class=" -Color -Color-Red">25.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">12.8/33.5 MB</span> <span class=" -Color -Color-Red">27.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">14.1/33.5 MB</span> <span class=" -Color -Color-Red">26.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">14.1/33.5 MB</span> <span class=" -Color -Color-Red">26.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">14.1/33.5 MB</span> <span class=" -Color -Color-Red">26.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">14.1/33.5 MB</span> <span class=" -Color -Color-Red">26.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">16.8/33.5 MB</span> <span class=" -Color -Color-Red">36.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">20.1/33.5 MB</span> <span class=" -Color -Color-Red">38.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">21.7/33.5 MB</span> <span class=" -Color -Color-Red">36.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━━━ <span class=" -Color -Color-Green">23.7/33.5 MB</span> <span class=" -Color -Color-Red">38.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━ <span class=" -Color -Color-Green">25.3/33.5 MB</span> <span class=" -Color -Color-Red">71.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━ <span class=" -Color -Color-Green">25.3/33.5 MB</span> <span class=" -Color -Color-Red">71.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━━━━ <span class=" -Color -Color-Green">29.4/33.5 MB</span> <span class=" -Color -Color-Red">52.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━ <span class=" -Color -Color-Green">32.0/33.5 MB</span> <span class=" -Color -Color-Red">56.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Green">33.4/33.5 MB</span> <span class=" -Color -Color-Red">55.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Green">33.4/33.5 MB</span> <span class=" -Color -Color-Red">55.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:01</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">33.5/33.5 MB</span> <span class=" -Color -Color-Red">35.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25h
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: spacy&lt;3.4.0,&gt;=3.3.0.dev0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from en-core-web-md==3.3.0) (3.3.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2.0.7)
Requirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.9 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.0.10)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2.4.4)
Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (4.64.1)
Requirement already satisfied: thinc&lt;8.1.0,&gt;=8.0.14 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (8.0.17)
Requirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.3.0)
Requirement already satisfied: typer&lt;0.5.0,&gt;=0.3.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (0.4.1)
Requirement already satisfied: jinja2 in /Users/evanmuzzall/.local/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.1.2)
Requirement already satisfied: setuptools in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (66.1.1)
Requirement already satisfied: requests&lt;3.0.0,&gt;=2.13.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2.28.2)
Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.9.1 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (0.10.1)
Requirement already satisfied: pathy&gt;=0.3.5 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (0.10.1)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,&lt;1.9.0,&gt;=1.7.4 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (1.8.2)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.4.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (0.7.7)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.0.6)
Requirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (1.0.1)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (1.0.7)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2.0.6)
Requirement already satisfied: packaging&gt;=20.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (23.0)
Requirement already satisfied: numpy&gt;=1.15.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (1.23.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: smart-open&lt;7.0.0,&gt;=5.2.1 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from pathy&gt;=0.3.5-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (5.2.1)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from pydantic!=1.8,!=1.8.1,&lt;1.9.0,&gt;=1.7.4-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (4.4.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2022.12.7)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (1.26.14)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.4)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (3.0.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: click&lt;9.0.0,&gt;=7.1.1 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from typer&lt;0.5.0,&gt;=0.3.0-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (8.1.3)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages (from jinja2-&gt;spacy&lt;3.4.0,&gt;=3.3.0.dev0-&gt;en-core-web-md==3.3.0) (2.1.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -lotly (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>
<span class=" -Color -Color-Yellow">WARNING: Ignoring invalid distribution -ensorflow (/Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages)</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-C2">✔ Download and installation successful</span>
You can now load the package via spacy.load(&#39;en_core_web_md&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Once we&#39;ve installed the model, we can import it like any other Python library</span>
<span class="kn">import</span> <span class="nn">en_core_web_md</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This instantiates a spaCy text processor based on the installed model</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">en_core_web_md</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From H.G. Wells&#39;s A Short History of the World, Project Gutenberg </span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Even under the Assyrian monarchs and especially under</span>
<span class="s2">Sardanapalus, Babylon had been a scene of great intellectual</span>
<span class="s2">activity.  </span><span class="si">{111}</span><span class="s2"> Sardanapalus, though an Assyrian, had been quite</span>
<span class="s2">Babylon-ized.  He made a library, a library not of paper but of</span>
<span class="s2">the clay tablets that were used for writing in Mesopotamia since</span>
<span class="s2">early Sumerian days.  His collection has been unearthed and is</span>
<span class="s2">perhaps the most precious store of historical material in the</span>
<span class="s2">world.  The last of the Chaldean line of Babylonian monarchs,</span>
<span class="s2">Nabonidus, had even keener literary tastes.  He patronized</span>
<span class="s2">antiquarian researches, and when a date was worked out by his</span>
<span class="s2">investigators for the accession of Sargon I he commemorated the</span>
<span class="s2">fact by inscriptions.  But there were many signs of disunion in</span>
<span class="s2">his empire, and he sought to centralize it by bringing a number of</span>
<span class="s2">the various local gods to Babylon and setting up temples to them</span>
<span class="s2">there.  This device was to be practised quite successfully by the</span>
<span class="s2">Romans in later times, but in Babylon it roused the jealousy of</span>
<span class="s2">the powerful priesthood of Bel Marduk, the dominant god of the</span>
<span class="s2">Babylonians.  They cast about for a possible alternative to</span>
<span class="s2">Nabonidus and found it in Cyrus the Persian, the ruler of the</span>
<span class="s2">adjacent Median Empire.  Cyrus had already distinguished himself</span>
<span class="s2">by conquering Croesus, the rich king of Lydia in Eastern Asia</span>
<span class="s2">Minor.  </span><span class="si">{112}</span><span class="s2"> He came up against Babylon, there was a battle</span>
<span class="s2">outside the walls, and the gates of the city were opened to him</span>
<span class="s2">(538 B.C.).  His soldiers entered the city without fighting.  The</span>
<span class="s2">crown prince Belshazzar, the son of Nabonidus, was feasting, the</span>
<span class="s2">Bible relates, when a hand appeared and wrote in letters of fire</span>
<span class="s2">upon the wall these mystical words: _&quot;Mene, Mene, Tekel,</span>
<span class="s2">Upharsin,&quot;_ which was interpreted by the prophet Daniel, whom he</span>
<span class="s2">summoned to read the riddle, as &quot;God has numbered thy kingdom and</span>
<span class="s2">finished it; thou art weighed in the balance and found wanting and</span>
<span class="s2">thy kingdom is given to the Medes and Persians.&quot;  Possibly the</span>
<span class="s2">priests of Bel Marduk knew something about that writing on the</span>
<span class="s2">wall.  Belshazzar was killed that night, says the Bible.</span>
<span class="s2">Nabonidus was taken prisoner, and the occupation of the city was</span>
<span class="s2">so peaceful that the services of Bel Marduk continued without</span>
<span class="s2">intermission.&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>By default, spaCy applies its entire NLP “pipeline” to the text as soon as it is provided to the model and outputs a processed “doc.”</p>
<img src="https://d33wubrfki0l68.cloudfront.net/3ad0582d97663a1272ffc4ccf09f1c5b335b17e9/7f49c/pipeline-fde48da9b43661abcdf62ab70a546d71.svg"><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="tokenization">
<h2>Tokenization<a class="headerlink" href="#tokenization" title="Permalink to this heading">#</a></h2>
<p>The doc created by spaCy immediately provides access to the word-level tokens of the text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[:</span><span class="mi">15</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even
under
the
Assyrian
monarchs
and
especially
under


Sardanapalus
,
Babylon
had
been
a
</pre></div>
</div>
</div>
</div>
<p>Each of these tokens has a number of properties, and we’ll look a bit more closely at them in a minute.</p>
<p>spaCy also automatically provides sentence-level segmenting (senticization).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sent</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even under the Assyrian monarchs and especially under
Sardanapalus, Babylon had been a scene of great intellectual
activity.
--

 {111} Sardanapalus, though an Assyrian, had been quite
Babylon-ized.
--

 He made a library, a library not of paper but of
the clay tablets that were used for writing in Mesopotamia since
early Sumerian days.
--

 His collection has been unearthed and is
perhaps the most precious store of historical material in the
world.
--

 The last of the Chaldean line of Babylonian monarchs,
Nabonidus, had even keener literary tastes.
--

 He patronized
antiquarian researches, and when a date was worked out by his
investigators for the accession of Sargon I he commemorated the
fact by inscriptions.
--

 But there were many signs of disunion in
his empire, and he sought to centralize it by bringing a number of
the various local gods to Babylon and setting up temples to them
there.
--

 This device was to be practised quite successfully by the
Romans in later times, but in Babylon it roused the jealousy of
the powerful priesthood of Bel Marduk, the dominant god of the
Babylonians.
--

 They cast about for a possible alternative to
Nabonidus and found it in Cyrus the Persian, the ruler of the
adjacent Median Empire.
--

 Cyrus had already distinguished himself
by conquering Croesus, the rich king of Lydia in Eastern Asia
Minor.
--
</pre></div>
</div>
</div>
</div>
<p>You’ll notice that the line breaks in the sample text are making the extracted sentences and also the word-level tokens a bit messy. The simplest way to avoid this is just to replace all single line breaks from the text with spaces before running it throug the spaCy pipeline, i.e., as a <strong>preprocessing</strong> step.</p>
<p>There are other ways to handle this within the spaCy pipeline; an important feature of spaCy is that every phase of the built-in pipeline can be replaced by a custom module. One could imagine, for example, writing a replacement sentencizer that takes advantage of the presence of two spaces between all sentences in the sample text. But we will leave that as an exercise for the reader.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_as_line</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text_as_line</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sent</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even under the Assyrian monarchs and especially under Sardanapalus, Babylon had been a scene of great intellectual activity.
--

 {111} Sardanapalus, though an Assyrian, had been quite Babylon-ized.
--

 He made a library, a library not of paper but of the clay tablets that were used for writing in Mesopotamia since early Sumerian days.
--

 His collection has been unearthed and is perhaps the most precious store of historical material in the world.
--

 The last of the Chaldean line of Babylonian monarchs, Nabonidus, had even keener literary tastes.
--

 He patronized antiquarian researches, and when a date was worked out by his investigators for the accession of Sargon I he commemorated the fact by inscriptions.
--

 But there were many signs of disunion in his empire, and he sought to centralize it by bringing a number of the various local gods to Babylon and setting up temples to them there.
--

 This device was to be practised quite successfully by the Romans in later times, but in Babylon it roused the jealousy of the powerful priesthood of Bel Marduk, the dominant god of the Babylonians.
--

 They cast about for a possible alternative to Nabonidus and found it in Cyrus the Persian, the ruler of the adjacent Median Empire.
--

 Cyrus had already distinguished himself by conquering Croesus, the rich king of Lydia in Eastern Asia Minor.
--
</pre></div>
</div>
</div>
</div>
<p>We can collect both words and sentences into standard Python data structures (lists, in this case).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
<span class="n">sentences</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Even under the Assyrian monarchs and especially under Sardanapalus, Babylon had been a scene of great intellectual activity.&#39;,
 &#39; {111} Sardanapalus, though an Assyrian, had been quite Babylon-ized.&#39;,
 &#39; He made a library, a library not of paper but of the clay tablets that were used for writing in Mesopotamia since early Sumerian days.&#39;,
 &#39; His collection has been unearthed and is perhaps the most precious store of historical material in the world.&#39;,
 &#39; The last of the Chaldean line of Babylonian monarchs, Nabonidus, had even keener literary tastes.&#39;,
 &#39; He patronized antiquarian researches, and when a date was worked out by his investigators for the accession of Sargon I he commemorated the fact by inscriptions.&#39;,
 &#39; But there were many signs of disunion in his empire, and he sought to centralize it by bringing a number of the various local gods to Babylon and setting up temples to them there.&#39;,
 &#39; This device was to be practised quite successfully by the Romans in later times, but in Babylon it roused the jealousy of the powerful priesthood of Bel Marduk, the dominant god of the Babylonians.&#39;,
 &#39; They cast about for a possible alternative to Nabonidus and found it in Cyrus the Persian, the ruler of the adjacent Median Empire.&#39;,
 &#39; Cyrus had already distinguished himself by conquering Croesus, the rich king of Lydia in Eastern Asia Minor.&#39;,
 &#39; {112} He came up against Babylon, there was a battle outside the walls, and the gates of the city were opened to him (538 B.C.).&#39;,
 &#39; His soldiers entered the city without fighting.&#39;,
 &#39; The crown prince Belshazzar, the son of Nabonidus, was feasting, the Bible relates, when a hand appeared and wrote in letters of fire upon the wall these mystical words: _&quot;Mene, Mene, Tekel, Upharsin,&quot;_ which was interpreted by the prophet Daniel, whom he summoned to read the riddle, as &quot;God has numbered thy kingdom and finished it; thou art weighed in the balance and found wanting and thy kingdom is given to the Medes and Persians.&quot;&#39;,
 &#39; Possibly the priests of Bel Marduk knew something about that writing on the wall.&#39;,
 &#39; Belshazzar was killed that night, says the Bible.&#39;,
 &#39;Nabonidus was taken prisoner, and the occupation of the city was so peaceful that the services of Bel Marduk continued without intermission.&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
<span class="n">words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Even&#39;,
 &#39;under&#39;,
 &#39;the&#39;,
 &#39;Assyrian&#39;,
 &#39;monarchs&#39;,
 &#39;and&#39;,
 &#39;especially&#39;,
 &#39;under&#39;,
 &#39;Sardanapalus&#39;,
 &#39;,&#39;,
 &#39;Babylon&#39;,
 &#39;had&#39;,
 &#39;been&#39;,
 &#39;a&#39;,
 &#39;scene&#39;,
 &#39;of&#39;,
 &#39;great&#39;,
 &#39;intellectual&#39;,
 &#39;activity&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;{&#39;,
 &#39;111&#39;,
 &#39;}&#39;,
 &#39;Sardanapalus&#39;,
 &#39;,&#39;,
 &#39;though&#39;,
 &#39;an&#39;,
 &#39;Assyrian&#39;,
 &#39;,&#39;,
 &#39;had&#39;,
 &#39;been&#39;,
 &#39;quite&#39;,
 &#39;Babylon&#39;,
 &#39;-&#39;,
 &#39;ized&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;He&#39;,
 &#39;made&#39;,
 &#39;a&#39;,
 &#39;library&#39;,
 &#39;,&#39;,
 &#39;a&#39;,
 &#39;library&#39;,
 &#39;not&#39;,
 &#39;of&#39;,
 &#39;paper&#39;,
 &#39;but&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;clay&#39;,
 &#39;tablets&#39;,
 &#39;that&#39;,
 &#39;were&#39;,
 &#39;used&#39;,
 &#39;for&#39;,
 &#39;writing&#39;,
 &#39;in&#39;,
 &#39;Mesopotamia&#39;,
 &#39;since&#39;,
 &#39;early&#39;,
 &#39;Sumerian&#39;,
 &#39;days&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;His&#39;,
 &#39;collection&#39;,
 &#39;has&#39;,
 &#39;been&#39;,
 &#39;unearthed&#39;,
 &#39;and&#39;,
 &#39;is&#39;,
 &#39;perhaps&#39;,
 &#39;the&#39;,
 &#39;most&#39;,
 &#39;precious&#39;,
 &#39;store&#39;,
 &#39;of&#39;,
 &#39;historical&#39;,
 &#39;material&#39;,
 &#39;in&#39;,
 &#39;the&#39;,
 &#39;world&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;The&#39;,
 &#39;last&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;Chaldean&#39;,
 &#39;line&#39;,
 &#39;of&#39;,
 &#39;Babylonian&#39;,
 &#39;monarchs&#39;,
 &#39;,&#39;,
 &#39;Nabonidus&#39;,
 &#39;,&#39;,
 &#39;had&#39;,
 &#39;even&#39;,
 &#39;keener&#39;,
 &#39;literary&#39;,
 &#39;tastes&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;He&#39;,
 &#39;patronized&#39;,
 &#39;antiquarian&#39;,
 &#39;researches&#39;,
 &#39;,&#39;,
 &#39;and&#39;,
 &#39;when&#39;,
 &#39;a&#39;,
 &#39;date&#39;,
 &#39;was&#39;,
 &#39;worked&#39;,
 &#39;out&#39;,
 &#39;by&#39;,
 &#39;his&#39;,
 &#39;investigators&#39;,
 &#39;for&#39;,
 &#39;the&#39;,
 &#39;accession&#39;,
 &#39;of&#39;,
 &#39;Sargon&#39;,
 &#39;I&#39;,
 &#39;he&#39;,
 &#39;commemorated&#39;,
 &#39;the&#39;,
 &#39;fact&#39;,
 &#39;by&#39;,
 &#39;inscriptions&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;But&#39;,
 &#39;there&#39;,
 &#39;were&#39;,
 &#39;many&#39;,
 &#39;signs&#39;,
 &#39;of&#39;,
 &#39;disunion&#39;,
 &#39;in&#39;,
 &#39;his&#39;,
 &#39;empire&#39;,
 &#39;,&#39;,
 &#39;and&#39;,
 &#39;he&#39;,
 &#39;sought&#39;,
 &#39;to&#39;,
 &#39;centralize&#39;,
 &#39;it&#39;,
 &#39;by&#39;,
 &#39;bringing&#39;,
 &#39;a&#39;,
 &#39;number&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;various&#39;,
 &#39;local&#39;,
 &#39;gods&#39;,
 &#39;to&#39;,
 &#39;Babylon&#39;,
 &#39;and&#39;,
 &#39;setting&#39;,
 &#39;up&#39;,
 &#39;temples&#39;,
 &#39;to&#39;,
 &#39;them&#39;,
 &#39;there&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;This&#39;,
 &#39;device&#39;,
 &#39;was&#39;,
 &#39;to&#39;,
 &#39;be&#39;,
 &#39;practised&#39;,
 &#39;quite&#39;,
 &#39;successfully&#39;,
 &#39;by&#39;,
 &#39;the&#39;,
 &#39;Romans&#39;,
 &#39;in&#39;,
 &#39;later&#39;,
 &#39;times&#39;,
 &#39;,&#39;,
 &#39;but&#39;,
 &#39;in&#39;,
 &#39;Babylon&#39;,
 &#39;it&#39;,
 &#39;roused&#39;,
 &#39;the&#39;,
 &#39;jealousy&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;powerful&#39;,
 &#39;priesthood&#39;,
 &#39;of&#39;,
 &#39;Bel&#39;,
 &#39;Marduk&#39;,
 &#39;,&#39;,
 &#39;the&#39;,
 &#39;dominant&#39;,
 &#39;god&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;Babylonians&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;They&#39;,
 &#39;cast&#39;,
 &#39;about&#39;,
 &#39;for&#39;,
 &#39;a&#39;,
 &#39;possible&#39;,
 &#39;alternative&#39;,
 &#39;to&#39;,
 &#39;Nabonidus&#39;,
 &#39;and&#39;,
 &#39;found&#39;,
 &#39;it&#39;,
 &#39;in&#39;,
 &#39;Cyrus&#39;,
 &#39;the&#39;,
 &#39;Persian&#39;,
 &#39;,&#39;,
 &#39;the&#39;,
 &#39;ruler&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;adjacent&#39;,
 &#39;Median&#39;,
 &#39;Empire&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;Cyrus&#39;,
 &#39;had&#39;,
 &#39;already&#39;,
 &#39;distinguished&#39;,
 &#39;himself&#39;,
 &#39;by&#39;,
 &#39;conquering&#39;,
 &#39;Croesus&#39;,
 &#39;,&#39;,
 &#39;the&#39;,
 &#39;rich&#39;,
 &#39;king&#39;,
 &#39;of&#39;,
 &#39;Lydia&#39;,
 &#39;in&#39;,
 &#39;Eastern&#39;,
 &#39;Asia&#39;,
 &#39;Minor&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;{&#39;,
 &#39;112&#39;,
 &#39;}&#39;,
 &#39;He&#39;,
 &#39;came&#39;,
 &#39;up&#39;,
 &#39;against&#39;,
 &#39;Babylon&#39;,
 &#39;,&#39;,
 &#39;there&#39;,
 &#39;was&#39;,
 &#39;a&#39;,
 &#39;battle&#39;,
 &#39;outside&#39;,
 &#39;the&#39;,
 &#39;walls&#39;,
 &#39;,&#39;,
 &#39;and&#39;,
 &#39;the&#39;,
 &#39;gates&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;city&#39;,
 &#39;were&#39;,
 &#39;opened&#39;,
 &#39;to&#39;,
 &#39;him&#39;,
 &#39;(&#39;,
 &#39;538&#39;,
 &#39;B.C.&#39;,
 &#39;)&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;His&#39;,
 &#39;soldiers&#39;,
 &#39;entered&#39;,
 &#39;the&#39;,
 &#39;city&#39;,
 &#39;without&#39;,
 &#39;fighting&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;The&#39;,
 &#39;crown&#39;,
 &#39;prince&#39;,
 &#39;Belshazzar&#39;,
 &#39;,&#39;,
 &#39;the&#39;,
 &#39;son&#39;,
 &#39;of&#39;,
 &#39;Nabonidus&#39;,
 &#39;,&#39;,
 &#39;was&#39;,
 &#39;feasting&#39;,
 &#39;,&#39;,
 &#39;the&#39;,
 &#39;Bible&#39;,
 &#39;relates&#39;,
 &#39;,&#39;,
 &#39;when&#39;,
 &#39;a&#39;,
 &#39;hand&#39;,
 &#39;appeared&#39;,
 &#39;and&#39;,
 &#39;wrote&#39;,
 &#39;in&#39;,
 &#39;letters&#39;,
 &#39;of&#39;,
 &#39;fire&#39;,
 &#39;upon&#39;,
 &#39;the&#39;,
 &#39;wall&#39;,
 &#39;these&#39;,
 &#39;mystical&#39;,
 &#39;words&#39;,
 &#39;:&#39;,
 &#39;_&#39;,
 &#39;&quot;&#39;,
 &#39;Mene&#39;,
 &#39;,&#39;,
 &#39;Mene&#39;,
 &#39;,&#39;,
 &#39;Tekel&#39;,
 &#39;,&#39;,
 &#39;Upharsin&#39;,
 &#39;,&#39;,
 &#39;&quot;&#39;,
 &#39;_&#39;,
 &#39;which&#39;,
 &#39;was&#39;,
 &#39;interpreted&#39;,
 &#39;by&#39;,
 &#39;the&#39;,
 &#39;prophet&#39;,
 &#39;Daniel&#39;,
 &#39;,&#39;,
 &#39;whom&#39;,
 &#39;he&#39;,
 &#39;summoned&#39;,
 &#39;to&#39;,
 &#39;read&#39;,
 &#39;the&#39;,
 &#39;riddle&#39;,
 &#39;,&#39;,
 &#39;as&#39;,
 &#39;&quot;&#39;,
 &#39;God&#39;,
 &#39;has&#39;,
 &#39;numbered&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;and&#39;,
 &#39;finished&#39;,
 &#39;it&#39;,
 &#39;;&#39;,
 &#39;thou&#39;,
 &#39;art&#39;,
 &#39;weighed&#39;,
 &#39;in&#39;,
 &#39;the&#39;,
 &#39;balance&#39;,
 &#39;and&#39;,
 &#39;found&#39;,
 &#39;wanting&#39;,
 &#39;and&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;is&#39;,
 &#39;given&#39;,
 &#39;to&#39;,
 &#39;the&#39;,
 &#39;Medes&#39;,
 &#39;and&#39;,
 &#39;Persians&#39;,
 &#39;.&#39;,
 &#39;&quot;&#39;,
 &#39; &#39;,
 &#39;Possibly&#39;,
 &#39;the&#39;,
 &#39;priests&#39;,
 &#39;of&#39;,
 &#39;Bel&#39;,
 &#39;Marduk&#39;,
 &#39;knew&#39;,
 &#39;something&#39;,
 &#39;about&#39;,
 &#39;that&#39;,
 &#39;writing&#39;,
 &#39;on&#39;,
 &#39;the&#39;,
 &#39;wall&#39;,
 &#39;.&#39;,
 &#39; &#39;,
 &#39;Belshazzar&#39;,
 &#39;was&#39;,
 &#39;killed&#39;,
 &#39;that&#39;,
 &#39;night&#39;,
 &#39;,&#39;,
 &#39;says&#39;,
 &#39;the&#39;,
 &#39;Bible&#39;,
 &#39;.&#39;,
 &#39;Nabonidus&#39;,
 &#39;was&#39;,
 &#39;taken&#39;,
 &#39;prisoner&#39;,
 &#39;,&#39;,
 &#39;and&#39;,
 &#39;the&#39;,
 &#39;occupation&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;city&#39;,
 &#39;was&#39;,
 &#39;so&#39;,
 &#39;peaceful&#39;,
 &#39;that&#39;,
 &#39;the&#39;,
 &#39;services&#39;,
 &#39;of&#39;,
 &#39;Bel&#39;,
 &#39;Marduk&#39;,
 &#39;continued&#39;,
 &#39;without&#39;,
 &#39;intermission&#39;,
 &#39;.&#39;]
</pre></div>
</div>
</div>
</div>
<section id="filtering-tokens">
<h3>Filtering tokens<a class="headerlink" href="#filtering-tokens" title="Permalink to this heading">#</a></h3>
<p>After extracting the tokens, we can use some attributes and methods provided by spaCy, along with some vanilla Python methods, to filter the tokens to just the types we’re interested in analyzing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If we&#39;re only interested in analyzing word tokens, we can remove punctuation:</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[:</span><span class="mi">20</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;TOKEN: </span><span class="si">{</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="si">:</span><span class="s1">15</span><span class="si">}</span><span class="s1"> IS_PUNCTUATION: </span><span class="si">{</span><span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="si">:}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">no_punct</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>

<span class="n">no_punct</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TOKEN: Even            IS_PUNCTUATION: False
TOKEN: under           IS_PUNCTUATION: False
TOKEN: the             IS_PUNCTUATION: False
TOKEN: Assyrian        IS_PUNCTUATION: False
TOKEN: monarchs        IS_PUNCTUATION: False
TOKEN: and             IS_PUNCTUATION: False
TOKEN: especially      IS_PUNCTUATION: False
TOKEN: under           IS_PUNCTUATION: False
TOKEN: Sardanapalus    IS_PUNCTUATION: False
TOKEN: ,               IS_PUNCTUATION: True
TOKEN: Babylon         IS_PUNCTUATION: False
TOKEN: had             IS_PUNCTUATION: False
TOKEN: been            IS_PUNCTUATION: False
TOKEN: a               IS_PUNCTUATION: False
TOKEN: scene           IS_PUNCTUATION: False
TOKEN: of              IS_PUNCTUATION: False
TOKEN: great           IS_PUNCTUATION: False
TOKEN: intellectual    IS_PUNCTUATION: False
TOKEN: activity        IS_PUNCTUATION: False
TOKEN: .               IS_PUNCTUATION: True
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Even,
 under,
 the,
 Assyrian,
 monarchs,
 and,
 especially,
 under,
 Sardanapalus,
 Babylon,
 had,
 been,
 a,
 scene,
 of,
 great,
 intellectual,
 activity,
  ,
 111]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There are still some space tokens; here&#39;s how to remove spaces and newlines:</span>
<span class="n">no_punct_or_space</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">is_space</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">no_punct_or_space</span><span class="p">[:</span><span class="mi">30</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even
under
the
Assyrian
monarchs
and
especially
under
Sardanapalus
Babylon
had
been
a
scene
of
great
intellectual
activity
111
Sardanapalus
though
an
Assyrian
had
been
quite
Babylon
ized
He
made
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s say we also want to remove numbers and lowercase everything that remains</span>
<span class="n">lower_alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">no_punct_or_space</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_alpha</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">lower_alpha</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;even&#39;,
 &#39;under&#39;,
 &#39;the&#39;,
 &#39;assyrian&#39;,
 &#39;monarchs&#39;,
 &#39;and&#39;,
 &#39;especially&#39;,
 &#39;under&#39;,
 &#39;sardanapalus&#39;,
 &#39;babylon&#39;,
 &#39;had&#39;,
 &#39;been&#39;,
 &#39;a&#39;,
 &#39;scene&#39;,
 &#39;of&#39;,
 &#39;great&#39;,
 &#39;intellectual&#39;,
 &#39;activity&#39;,
 &#39;sardanapalus&#39;,
 &#39;though&#39;,
 &#39;an&#39;,
 &#39;assyrian&#39;,
 &#39;had&#39;,
 &#39;been&#39;,
 &#39;quite&#39;,
 &#39;babylon&#39;,
 &#39;ized&#39;,
 &#39;he&#39;,
 &#39;made&#39;,
 &#39;a&#39;]
</pre></div>
</div>
</div>
</div>
<p>One additional common filtering step is to remove stopwords. In theory, stopwords can be any words we’re not interested in analyzing, but in practice, they are often the most common words in a language that do not carry much semantic information (e.g., articles, conjunctions).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">no_punct_or_space</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_alpha</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">clean</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;assyrian&#39;,
 &#39;monarchs&#39;,
 &#39;especially&#39;,
 &#39;sardanapalus&#39;,
 &#39;babylon&#39;,
 &#39;scene&#39;,
 &#39;great&#39;,
 &#39;intellectual&#39;,
 &#39;activity&#39;,
 &#39;sardanapalus&#39;,
 &#39;assyrian&#39;,
 &#39;babylon&#39;,
 &#39;ized&#39;,
 &#39;library&#39;,
 &#39;library&#39;,
 &#39;paper&#39;,
 &#39;clay&#39;,
 &#39;tablets&#39;,
 &#39;writing&#39;,
 &#39;mesopotamia&#39;,
 &#39;early&#39;,
 &#39;sumerian&#39;,
 &#39;days&#39;,
 &#39;collection&#39;,
 &#39;unearthed&#39;,
 &#39;precious&#39;,
 &#39;store&#39;,
 &#39;historical&#39;,
 &#39;material&#39;,
 &#39;world&#39;]
</pre></div>
</div>
</div>
</div>
<p>We’ve used spaCy’s built-in stopword list; membership in this list determines the property <code class="docutils literal notranslate"><span class="pre">is_stop</span></code> for each token. It’s good practice to be wary of any built-in stopword list, however – there’s a good chance you will want to remove some words that aren’t on the list and to include some that are, especially if you’re working with specialized texts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We&#39;ll just pick a couple of words we know are in the example</span>
<span class="n">custom_stopwords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;assyrian&quot;</span><span class="p">,</span> <span class="s2">&quot;babylon&quot;</span><span class="p">]</span>

<span class="n">custom_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">clean</span> <span class="k">if</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">custom_stopwords</span><span class="p">]</span>
<span class="n">custom_clean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;monarchs&#39;,
 &#39;especially&#39;,
 &#39;sardanapalus&#39;,
 &#39;scene&#39;,
 &#39;great&#39;,
 &#39;intellectual&#39;,
 &#39;activity&#39;,
 &#39;sardanapalus&#39;,
 &#39;ized&#39;,
 &#39;library&#39;,
 &#39;library&#39;,
 &#39;paper&#39;,
 &#39;clay&#39;,
 &#39;tablets&#39;,
 &#39;writing&#39;,
 &#39;mesopotamia&#39;,
 &#39;early&#39;,
 &#39;sumerian&#39;,
 &#39;days&#39;,
 &#39;collection&#39;,
 &#39;unearthed&#39;,
 &#39;precious&#39;,
 &#39;store&#39;,
 &#39;historical&#39;,
 &#39;material&#39;,
 &#39;world&#39;,
 &#39;chaldean&#39;,
 &#39;line&#39;,
 &#39;babylonian&#39;,
 &#39;monarchs&#39;,
 &#39;nabonidus&#39;,
 &#39;keener&#39;,
 &#39;literary&#39;,
 &#39;tastes&#39;,
 &#39;patronized&#39;,
 &#39;antiquarian&#39;,
 &#39;researches&#39;,
 &#39;date&#39;,
 &#39;worked&#39;,
 &#39;investigators&#39;,
 &#39;accession&#39;,
 &#39;sargon&#39;,
 &#39;commemorated&#39;,
 &#39;fact&#39;,
 &#39;inscriptions&#39;,
 &#39;signs&#39;,
 &#39;disunion&#39;,
 &#39;empire&#39;,
 &#39;sought&#39;,
 &#39;centralize&#39;,
 &#39;bringing&#39;,
 &#39;number&#39;,
 &#39;local&#39;,
 &#39;gods&#39;,
 &#39;setting&#39;,
 &#39;temples&#39;,
 &#39;device&#39;,
 &#39;practised&#39;,
 &#39;successfully&#39;,
 &#39;romans&#39;,
 &#39;later&#39;,
 &#39;times&#39;,
 &#39;roused&#39;,
 &#39;jealousy&#39;,
 &#39;powerful&#39;,
 &#39;priesthood&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;dominant&#39;,
 &#39;god&#39;,
 &#39;babylonians&#39;,
 &#39;cast&#39;,
 &#39;possible&#39;,
 &#39;alternative&#39;,
 &#39;nabonidus&#39;,
 &#39;found&#39;,
 &#39;cyrus&#39;,
 &#39;persian&#39;,
 &#39;ruler&#39;,
 &#39;adjacent&#39;,
 &#39;median&#39;,
 &#39;empire&#39;,
 &#39;cyrus&#39;,
 &#39;distinguished&#39;,
 &#39;conquering&#39;,
 &#39;croesus&#39;,
 &#39;rich&#39;,
 &#39;king&#39;,
 &#39;lydia&#39;,
 &#39;eastern&#39;,
 &#39;asia&#39;,
 &#39;minor&#39;,
 &#39;came&#39;,
 &#39;battle&#39;,
 &#39;outside&#39;,
 &#39;walls&#39;,
 &#39;gates&#39;,
 &#39;city&#39;,
 &#39;opened&#39;,
 &#39;soldiers&#39;,
 &#39;entered&#39;,
 &#39;city&#39;,
 &#39;fighting&#39;,
 &#39;crown&#39;,
 &#39;prince&#39;,
 &#39;belshazzar&#39;,
 &#39;son&#39;,
 &#39;nabonidus&#39;,
 &#39;feasting&#39;,
 &#39;bible&#39;,
 &#39;relates&#39;,
 &#39;hand&#39;,
 &#39;appeared&#39;,
 &#39;wrote&#39;,
 &#39;letters&#39;,
 &#39;fire&#39;,
 &#39;wall&#39;,
 &#39;mystical&#39;,
 &#39;words&#39;,
 &#39;mene&#39;,
 &#39;mene&#39;,
 &#39;tekel&#39;,
 &#39;upharsin&#39;,
 &#39;interpreted&#39;,
 &#39;prophet&#39;,
 &#39;daniel&#39;,
 &#39;summoned&#39;,
 &#39;read&#39;,
 &#39;riddle&#39;,
 &#39;god&#39;,
 &#39;numbered&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;finished&#39;,
 &#39;thou&#39;,
 &#39;art&#39;,
 &#39;weighed&#39;,
 &#39;balance&#39;,
 &#39;found&#39;,
 &#39;wanting&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;given&#39;,
 &#39;medes&#39;,
 &#39;persians&#39;,
 &#39;possibly&#39;,
 &#39;priests&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;knew&#39;,
 &#39;writing&#39;,
 &#39;wall&#39;,
 &#39;belshazzar&#39;,
 &#39;killed&#39;,
 &#39;night&#39;,
 &#39;says&#39;,
 &#39;bible&#39;,
 &#39;nabonidus&#39;,
 &#39;taken&#39;,
 &#39;prisoner&#39;,
 &#39;occupation&#39;,
 &#39;city&#39;,
 &#39;peaceful&#39;,
 &#39;services&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;continued&#39;,
 &#39;intermission&#39;]
</pre></div>
</div>
</div>
</div>
<p>At this point, we have a list of lower-cased tokens that doesn’t contain punctuation, white-space, numbers, or stopwords. Depending on your analytical goals, you may or may not want to do this much cleaning, but hopefully you have a greater appreciation for the kinds of cleaning that can be done with spaCy.</p>
</section>
<section id="counting-tokens">
<h3>Counting tokens<a class="headerlink" href="#counting-tokens" title="Permalink to this heading">#</a></h3>
<p>Now that we’ve used spaCy to tokenize and clean our text, we can begin one of the most fundamental text analysis tasks: counting words!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of tokens in document: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of tokens in cleaned document: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of unique tokens in cleaned document: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">clean</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of tokens in document:  442
Number of tokens in cleaned document:  175
Number of unique tokens in cleaned document:  147
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">full_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">])</span>
<span class="n">full_counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;the&#39;, 36),
 (&#39;,&#39;, 26),
 (&#39;of&#39;, 20),
 (&#39;.&#39;, 16),
 (&#39; &#39;, 14),
 (&#39;and&#39;, 13),
 (&#39;in&#39;, 9),
 (&#39;a&#39;, 8),
 (&#39;was&#39;, 8),
 (&#39;to&#39;, 8),
 (&#39;he&#39;, 6),
 (&#39;by&#39;, 6),
 (&#39;babylon&#39;, 5),
 (&#39;had&#39;, 4),
 (&#39;that&#39;, 4),
 (&#39;his&#39;, 4),
 (&#39;nabonidus&#39;, 4),
 (&#39;it&#39;, 4),
 (&#39;&quot;&#39;, 4),
 (&#39;been&#39;, 3)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span>
<span class="n">cleaned_counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;babylon&#39;, 5),
 (&#39;nabonidus&#39;, 4),
 (&#39;bel&#39;, 3),
 (&#39;marduk&#39;, 3),
 (&#39;city&#39;, 3),
 (&#39;assyrian&#39;, 2),
 (&#39;monarchs&#39;, 2),
 (&#39;sardanapalus&#39;, 2),
 (&#39;library&#39;, 2),
 (&#39;writing&#39;, 2),
 (&#39;empire&#39;, 2),
 (&#39;god&#39;, 2),
 (&#39;found&#39;, 2),
 (&#39;cyrus&#39;, 2),
 (&#39;belshazzar&#39;, 2),
 (&#39;bible&#39;, 2),
 (&#39;wall&#39;, 2),
 (&#39;mene&#39;, 2),
 (&#39;thy&#39;, 2),
 (&#39;kingdom&#39;, 2)]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="part-of-speech-tagging">
<h2>Part-of-speech tagging<a class="headerlink" href="#part-of-speech-tagging" title="Permalink to this heading">#</a></h2>
<p>Let’s consider some other aspects of the text that spaCy exposes for us. One of the most noteworthy features is part-of-speech tagging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spaCy provides two levels of POS tagging. Here&#39;s the more general level.</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[:</span><span class="mi">30</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even ADV
under ADP
the DET
Assyrian ADJ
monarchs NOUN
and CCONJ
especially ADV
under ADP
Sardanapalus PROPN
, PUNCT
Babylon PROPN
had AUX
been AUX
a DET
scene NOUN
of ADP
great ADJ
intellectual ADJ
activity NOUN
. PUNCT
  SPACE
{ PUNCT
111 NUM
} PUNCT
Sardanapalus PROPN
, PUNCT
though SCONJ
an DET
Assyrian PROPN
, PUNCT
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spaCy also provides the more specific Penn Treenbank tags.</span>
<span class="c1"># https://www.ling.upenn.edu/courses/Fall_2003/ling001/penn_treebank_pos.html</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[:</span><span class="mi">30</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">tag_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Even RB
under IN
the DT
Assyrian JJ
monarchs NNS
and CC
especially RB
under IN
Sardanapalus NNP
, ,
Babylon NNP
had VBD
been VBN
a DT
scene NN
of IN
great JJ
intellectual JJ
activity NN
. .
  _SP
{ -LRB-
111 CD
} -RRB-
Sardanapalus NNP
, ,
though IN
an DT
Assyrian NNP
, ,
</pre></div>
</div>
</div>
</div>
<p>We can count the occurrences of each part of speech in the text, which may be useful for document classification (fiction may have different proportions of parts of speech relative to nonfiction, for example) or stylistic analysis (more on that later).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nouns</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s2">&quot;NOUN&quot;</span><span class="p">]</span>
<span class="n">verbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s2">&quot;VERB&quot;</span><span class="p">]</span>
<span class="n">proper_nouns</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s2">&quot;PROPN&quot;</span><span class="p">]</span>
<span class="n">adjectives</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s2">&quot;ADJ&quot;</span><span class="p">]</span>
<span class="n">adverbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s2">&quot;ADV&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos_counts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;nouns&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">nouns</span><span class="p">),</span>
    <span class="s2">&quot;verbs&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">verbs</span><span class="p">),</span>
    <span class="s2">&quot;proper_nouns&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">proper_nouns</span><span class="p">),</span>
    <span class="s2">&quot;adjectives&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">adjectives</span><span class="p">),</span>
    <span class="s2">&quot;adverbs&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">adverbs</span><span class="p">)</span> 
<span class="p">}</span>

<span class="n">pos_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;nouns&#39;: 66, &#39;verbs&#39;: 43, &#39;proper_nouns&#39;: 45, &#39;adjectives&#39;: 24, &#39;adverbs&#39;: 12}
</pre></div>
</div>
</div>
</div>
<p>spaCy performs morphosyntactic analysis of individual tokens, including lemmatizing inflected or conjugated forms to their base (dictionary) forms. Reducing words to their lemmatized forms can help to make a large corpus more manageable and is generally more effective than just stemming words (trimming the inflected/conjugated endings of words until just the base portion remains), but should only be done if the inflections are not relevant to your analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;NOUN&quot;</span><span class="p">,</span> <span class="s2">&quot;VERB&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">orth_</span> <span class="o">!=</span> <span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="si">:</span><span class="s2">15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>monarchs        monarch
ized            ize
made            make
tablets         tablet
used            use
writing         write
days            day
unearthed       unearth
monarchs        monarch
had             have
tastes          taste
patronized      patronize
researches      research
worked          work
investigators   investigator
commemorated    commemorate
inscriptions    inscription
were            be
signs           sign
sought          seek
bringing        bring
gods            god
setting         set
temples         temple
practised       practise
times           time
roused          rouse
found           find
distinguished   distinguish
conquering      conquer
came            come
was             be
walls           wall
gates           gate
opened          open
soldiers        soldier
entered         enter
fighting        fight
feasting        feast
relates         relate
appeared        appear
wrote           write
letters         letter
words           word
interpreted     interpret
summoned        summon
numbered        number
finished        finish
weighed         weigh
found           find
wanting         want
given           give
priests         priest
knew            know
killed          kill
says            say
taken           take
services        service
continued       continue
</pre></div>
</div>
</div>
</div>
<section id="parsing">
<h3>Parsing<a class="headerlink" href="#parsing" title="Permalink to this heading">#</a></h3>
<p>spaCy’s trained models also provide full dependency parsing, tagging word tokens with their syntactic relations to other tokens. This functionality drives spaCy’s built-in senticization as well.</p>
<p>We won’t spend much time exploring this feature, but it’s useful to see how it enables the extraction of multi-word “noun chunks” from the text. Note also that textacy (discussed below) has a built-in function to extract subject-verb-object triples from sentences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">noun_chunks</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the Assyrian monarchs
Sardanapalus
Babylon
a scene
great intellectual activity
 {111} Sardanapalus
an Assyrian
He
a library
a library
paper
the clay tablets
that
Mesopotamia
early Sumerian days
His collection
the most precious store
historical material
the world
 The last
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="named-entity-recognition">
<h2>Named-entity recognition<a class="headerlink" href="#named-entity-recognition" title="Permalink to this heading">#</a></h2>
<p>spaCy’s models do a pretty good job of identifying and classifying named entities (people, places, organizations).</p>
<p>It is also fairly easy to customize and fine-tune these models by providing additional training data (e.g., texts with entities labeled according to the desired scheme), but that’s out of the scope of this workshop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="si">:</span><span class="s1">20</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="si">:</span><span class="s1">15</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">spacy</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Assyrian             NORP            Nationalities or religious or political groups
Sardanapalus         WORK_OF_ART     Titles of books, songs, etc.
Babylon              GPE             Countries, cities, states
111                  CARDINAL        Numerals that do not fall under another type
Assyrian             NORP            Nationalities or religious or political groups
Babylon              ORG             Companies, agencies, institutions, etc.
Mesopotamia          LOC             Non-GPE locations, mountain ranges, bodies of water
early Sumerian days  DATE            Absolute or relative dates or periods
Chaldean             NORP            Nationalities or religious or political groups
Babylonian           NORP            Nationalities or religious or political groups
Nabonidus            ORG             Companies, agencies, institutions, etc.
Sargon               ORG             Companies, agencies, institutions, etc.
Romans               NORP            Nationalities or religious or political groups
Babylon              GPE             Countries, cities, states
Bel Marduk           PERSON          People, including fictional
Babylonians          NORP            Nationalities or religious or political groups
Nabonidus            ORG             Companies, agencies, institutions, etc.
Persian              NORP            Nationalities or religious or political groups
Croesus              PERSON          People, including fictional
Lydia                PERSON          People, including fictional
Eastern Asia Minor   LOC             Non-GPE locations, mountain ranges, bodies of water
112                  CARDINAL        Numerals that do not fall under another type
Babylon              ORG             Companies, agencies, institutions, etc.
538                  CARDINAL        Numerals that do not fall under another type
B.C.                 GPE             Countries, cities, states
Nabonidus            PERSON          People, including fictional
Bible                WORK_OF_ART     Titles of books, songs, etc.
Mene                 PERSON          People, including fictional
Tekel                ORG             Companies, agencies, institutions, etc.
Upharsin             PERSON          People, including fictional
Medes                NORP            Nationalities or religious or political groups
Persians             NORP            Nationalities or religious or political groups
Bel Marduk           PERSON          People, including fictional
that night           TIME            Times smaller than a day
Bible                WORK_OF_ART     Titles of books, songs, etc.
Nabonidus            PERSON          People, including fictional
Bel Marduk           PERSON          People, including fictional
</pre></div>
</div>
</div>
</div>
<p>What if we only care about geo-political entities or locations?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ent_filtered</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="k">if</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GPE&quot;</span><span class="p">,</span> <span class="s2">&quot;LOC&quot;</span><span class="p">]]</span>
<span class="n">ent_filtered</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Babylon&#39;, &#39;GPE&#39;),
 (&#39;Mesopotamia&#39;, &#39;LOC&#39;),
 (&#39;Babylon&#39;, &#39;GPE&#39;),
 (&#39;Eastern Asia Minor&#39;, &#39;LOC&#39;),
 (&#39;B.C.&#39;, &#39;GPE&#39;)]
</pre></div>
</div>
</div>
</div>
<section id="visualizing-parses">
<h3>Visualizing Parses<a class="headerlink" href="#visualizing-parses" title="Permalink to this heading">#</a></h3>
<p>The built-in displaCy visualizer can render the results of the named-entity recognition, as well as the dependency parser.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spacy</span> <span class="kn">import</span> <span class="n">displacy</span>
<span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;ent&quot;</span><span class="p">,</span> <span class="n">jupyter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span class="tex2jax_ignore"><div class="entities" style="line-height: 2.5; direction: ltr">Even under the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Assyrian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 monarchs and especially under 
<mark class="entity" style="background: #f0d0ff; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Sardanapalus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">WORK_OF_ART</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylon
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 had been a scene of great intellectual activity.  {
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    111
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>
} Sardanapalus, though an 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Assyrian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
, had been quite 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylon
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
-ized.  He made a library, a library not of paper but of the clay tablets that were used for writing in 
<mark class="entity" style="background: #ff9561; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Mesopotamia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
 since 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    early Sumerian days
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
.  His collection has been unearthed and is perhaps the most precious store of historical material in the world.  The last of the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Chaldean
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 line of 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylonian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 monarchs, 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Nabonidus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, had even keener literary tastes.  He patronized antiquarian researches, and when a date was worked out by his investigators for the accession of 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Sargon
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 I he commemorated the fact by inscriptions.  But there were many signs of disunion in his empire, and he sought to centralize it by bringing a number of the various local gods to Babylon and setting up temples to them there.  This device was to be practised quite successfully by the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Romans
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 in later times, but in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylon
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 it roused the jealousy of the powerful priesthood of 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Bel Marduk
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, the dominant god of the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylonians
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
.  They cast about for a possible alternative to 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Nabonidus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 and found it in Cyrus the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Persian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
, the ruler of the adjacent Median Empire.  Cyrus had already distinguished himself by conquering 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Croesus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, the rich king of 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Lydia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 in 
<mark class="entity" style="background: #ff9561; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Eastern Asia Minor
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
.  {
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    112
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>
} He came up against 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Babylon
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, there was a battle outside the walls, and the gates of the city were opened to him (
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    538
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>

<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    B.C.
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
).  His soldiers entered the city without fighting.  The crown prince Belshazzar, the son of 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Nabonidus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, was feasting, the 
<mark class="entity" style="background: #f0d0ff; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Bible
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">WORK_OF_ART</span>
</mark>
 relates, when a hand appeared and wrote in letters of fire upon the wall these mystical words: _&quot;Mene, 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Mene
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Tekel
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Upharsin
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
,&quot;_ which was interpreted by the prophet Daniel, whom he summoned to read the riddle, as &quot;God has numbered thy kingdom and finished it; thou art weighed in the balance and found wanting and thy kingdom is given to the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Medes
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 and 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Persians
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
.&quot;  Possibly the priests of 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Bel Marduk
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 knew something about that writing on the wall.  Belshazzar was killed 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    that night
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">TIME</span>
</mark>
, says the 
<mark class="entity" style="background: #f0d0ff; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Bible
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">WORK_OF_ART</span>
</mark>
. 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Nabonidus
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 was taken prisoner, and the occupation of the city was so peaceful that the services of 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Bel Marduk
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 continued without intermission.</div></span></div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="corpus-level-analysis-with-textacy">
<h1>Corpus-level analysis with <code class="docutils literal notranslate"><span class="pre">textacy</span></code><a class="headerlink" href="#corpus-level-analysis-with-textacy" title="Permalink to this heading">#</a></h1>
<p>Let’s shift to thinking about a whole corpus rather than a single document. We could analyze multiple documents with spaCy and then knit the results together with some extra Python. Instead, though, we’re going to take advantage of textacy, a library built on spaCy that adds corpus analysis features.</p>
<p>For reference, here’s the <a class="reference external" href="https://textacy.readthedocs.io/en/stable/api_reference/root.html">online documentation for textacy</a>.</p>
<section id="generating-corpora">
<h2>Generating corpora<a class="headerlink" href="#generating-corpora" title="Permalink to this heading">#</a></h2>
<p>We’ll use some of the data that is included in textacy as our corpus. It is certainly possible to build your own corpus by importing data from files in plain text, XML, JSON, CSV or other formats, but working with one of textacy’s “pre-cooked” datasets simplifies things a bit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textacy.datasets</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We&#39;ll work with a dataset of ~8,400 (&quot;almost all&quot;) U.S. Supreme Court</span>
<span class="c1"># decisions from November 1946 through June 2016</span>
<span class="c1"># https://github.com/bdewilde/textacy-data/releases/tag/supreme_court_py3_v1.0</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">textacy</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">SupremeCourt</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The documentation indicates the metadata that is available with each text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># help(textacy.datasets.supreme_court)</span>
</pre></div>
</div>
</div>
</div>
<p>textacy is based on the concept of a corpus, whereas spaCy focuses on single documents. A textacy corpus is instantiated with a spaCy language model (we’re using the one from the first half of this workshop) that is used to apply its analytical pipeline to each text in the corpus, and also given a set of records consisting of texts with metadata (if metadata is available).</p>
<p>Let’s go ahead and define a set of records (texts with metadata) that we’ll then add to our corpus. To keep the processing time of the data set a bit more manageable, we’ll just look at a set of court decisions from a short span of time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">textacy</span><span class="o">.</span><span class="n">Corpus</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

<span class="c1"># There are 79 docs in this range -- they&#39;ll take a minute or two to process</span>
<span class="n">recent_decisions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">records</span><span class="p">(</span><span class="n">date_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2010-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-12-31&#39;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">recent_decisions</span><span class="p">):</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;pre&gt;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;2</span><span class="si">}</span><span class="s2">/79: Adding </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;case_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/pre&gt;&quot;</span><span class="p">))</span>
    <span class="n">corpus</span><span class="o">.</span><span class="n">add_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

<span class="c1"># If the three lines above are taking too long to process all 79 docs,</span>
<span class="c1"># comment them out and uncomment the two lines below to download and import</span>
<span class="c1"># a preprocessed version of the corpus</span>

<span class="c1">#!wget https://github.com/sul-cidr/Workshops/raw/master/Text_Analysis_with_Python/data/scotus_2010.bin.gz</span>
<span class="c1">#corpus = textacy.Corpus.load(nlp, &quot;scotus_2010.bin.gz&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre>19/79: Adding SHADY GROVE ORTHOPEDIC ASSOCIATES, P. A. v. ALLSTATE INSURANCE COMPANY</pre></div><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">33</span><span class="p">],</span> <span class="n">line</span> <span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;pre&gt;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;2</span><span class="si">}</span><span class="s2">/79: Adding </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;case_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/pre&gt;&quot;</span><span class="p">))</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">corpus</span><span class="o">.</span><span class="n">add_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/textacy/corpus.py:287,</span> in <span class="ni">Corpus.add_record</span><span class="nt">(self, record)</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> <span class="k">def</span> <span class="nf">add_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">Record</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span><span class="sd">     Add one record to the corpus, processing it into a :class:`spacy.tokens.Doc`</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span><span class="sd">     using the :attr:`Corpus.spacy_lang` pipeline.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">285</span><span class="sd">         record</span>
<span class="g g-Whitespace">    </span><span class="mi">286</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">287</span>     <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacy_lang</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span>     <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_add_valid_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/language.py:1008,</span> in <span class="ni">Language.__call__</span><span class="nt">(self, text, disable, component_cfg)</span>
<span class="g g-Whitespace">    </span><span class="mi">987</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">988</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">989</span>     <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Doc</span><span class="p">],</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">992</span>     <span class="n">component_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">993</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">994</span>     <span class="sd">&quot;&quot;&quot;Apply the pipeline to some text. The text can span multiple sentences,</span>
<span class="g g-Whitespace">    </span><span class="mi">995</span><span class="sd">     and can contain arbitrary whitespace. Alignment into the original string</span>
<span class="g g-Whitespace">    </span><span class="mi">996</span><span class="sd">     is preserved.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1006</span><span class="sd">     DOCS: https://spacy.io/api/language#call</span>
<span class="g g-Whitespace">   </span><span class="mi">1007</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1008</span>     <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span>     <span class="k">if</span> <span class="n">component_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1010</span>         <span class="n">component_cfg</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/language.py:1099,</span> in <span class="ni">Language._ensure_doc</span><span class="nt">(self, doc_like)</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span>     <span class="k">return</span> <span class="n">doc_like</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc_like</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1099</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">doc_like</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc_like</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>     <span class="k">return</span> <span class="n">Doc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">doc_like</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/language.py:1091,</span> in <span class="ni">Language.make_doc</span><span class="nt">(self, text)</span>
<span class="g g-Whitespace">   </span><span class="mi">1087</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1088</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1089</span>         <span class="n">Errors</span><span class="o">.</span><span class="n">E088</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_length</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1090</span>     <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1091</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/tokenizer.pyx:155,</span> in <span class="ni">spacy.tokenizer.Tokenizer.__call__</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/tokenizer.pyx:191,</span> in <span class="ni">spacy.tokenizer.Tokenizer._tokenize_affixes</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/tokenizer.pyx:395,</span> in <span class="ni">spacy.tokenizer.Tokenizer._tokenize</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/tokenizer.pyx:473,</span> in <span class="ni">spacy.tokenizer.Tokenizer._attach_tokens</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/vocab.pyx:160,</span> in <span class="ni">spacy.vocab.Vocab.get</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/vocab.pyx:197,</span> in <span class="ni">spacy.vocab.Vocab._new_lexeme</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/spacy/lang/lex_attrs.py:145,</span> in <span class="ni">lower</span><span class="nt">(string)</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span>             <span class="n">shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_char</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span>     <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">145</span> <span class="k">def</span> <span class="nf">lower</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>     <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span> <span class="k">def</span> <span class="nf">prefix</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="p">))</span>
<span class="p">[</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">preview</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Doc(13007 tokens: &quot;Respondent New York City taxes the possession o...&quot;)&#39;,
 &#39;Doc(72325 tokens: &quot;As amended by §203 of the Bipartisan Campaign R...&quot;)&#39;,
 &#39;Doc(8333 tokens: &quot;Under 28 U. S. C. §2254(d)(2), a federal court ...&quot;)&#39;,
 &#39;Doc(9947 tokens: &quot;The Illegal Immigration Reform and Immigrant Re...&quot;)&#39;,
 &#39;Doc(5508 tokens: &quot;Per Curiam.  From beginning to end, judicial pr...&quot;)&#39;]
</pre></div>
</div>
</div>
</div>
<p>We can see that the type of each item in the corpus is a <code class="docutils literal notranslate"><span class="pre">Doc</span></code> - this is a processed spaCy output document, with all of the extracted features. textacy provides some capacity to work with those features via its API, and also exposes new document-level features, such as ngrams and algorithms to determine a document’s readability level, among others.</p>
<p>We can filter this corpus based on metadata attributes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;issue&#39;: &#39;80170&#39;,
 &#39;issue_area&#39;: 8,
 &#39;n_min_votes&#39;: 3,
 &#39;case_name&#39;: &#39;HEMI GROUP, LLC AND KAI GACHUPIN v. CITY OF NEW YORK, NEW YORK&#39;,
 &#39;maj_opinion_author&#39;: 111,
 &#39;decision_date&#39;: &#39;2010-01-25&#39;,
 &#39;decision_direction&#39;: &#39;conservative&#39;,
 &#39;n_maj_votes&#39;: 5,
 &#39;us_cite_id&#39;: &#39;559 U.S. 1&#39;,
 &#39;argument_date&#39;: &#39;2009-11-03&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we&#39;ll find all the cases where the number of justices voting in the majority was greater than 6. </span>
<span class="n">supermajorities</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_maj_votes&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">supermajorities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">supermajorities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">preview</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Doc(8333 tokens: &quot;Under 28 U. S. C. §2254(d)(2), a federal court ...&quot;)&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="finding-important-words-in-the-corpus">
<h2>Finding important words in the corpus<a class="headerlink" href="#finding-important-words-in-the-corpus" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of documents: &quot;</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">n_docs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of sentences: &quot;</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">n_sents</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of tokens: &quot;</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">n_tokens</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of documents:  79
number of sentences:  42470
number of tokens:  1189205
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus</span><span class="o">.</span><span class="n">word_counts</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;orth_&quot;</span><span class="p">,</span> <span class="n">filter_stops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_punct</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_nums</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Respondent&#39;: 250,
 &#39;New&#39;: 413,
 &#39;York&#39;: 284,
 &#39;City&#39;: 340,
 &#39;taxes&#39;: 56,
 &#39;the&#39;: 56729,
 &#39;possession&#39;: 216,
 &#39;of&#39;: 30659,
 &#39;cigarettes&#39;: 23,
 &#39;.&#39;: 44541,
 &#39;Petitioner&#39;: 246,
 &#39;Hemi&#39;: 82,
 &#39;Group&#39;: 37,
 &#39;,&#39;: 72059,
 &#39;based&#39;: 526,
 &#39;in&#39;: 14744,
 &#39;Mexico&#39;: 16,
 &#39;sells&#39;: 6,
 &#39;online&#39;: 49,
 &#39;to&#39;: 25427,
 &#39;residents&#39;: 25,
 &#39;Neither&#39;: 74,
 &#39;state&#39;: 1920,
 &#39;nor&#39;: 242,
 &#39;city&#39;: 48,
 &#39;law&#39;: 1899,
 &#39;requires&#39;: 352,
 &#39;out&#39;: 548,
 &#39;-&#39;: 10949,
 &#39;sellers&#39;: 13,
 &#39;such&#39;: 1571,
 &#39;as&#39;: 5683,
 &#39;charge&#39;: 102,
 &#39;collect&#39;: 35,
 &#39;or&#39;: 5809,
 &#39;remit&#39;: 7,
 &quot;&#39;s&quot;: 9728,
 &#39;tax&#39;: 175,
 &#39;;&#39;: 4864,
 &#39;instead&#39;: 175,
 &#39;must&#39;: 1197,
 &#39;recover&#39;: 50,
 &#39;its&#39;: 2590,
 &#39;on&#39;: 5214,
 &#39;sales&#39;: 48,
 &#39;directly&#39;: 134,
 &#39;from&#39;: 2842,
 &#39;purchasers&#39;: 16,
 &#39;But&#39;: 1066,
 &#39;Jenkins&#39;: 51,
 &#39;Act&#39;: 1278,
 &#39;15&#39;: 449,
 &#39;U.&#39;: 5900,
 &#39;S.&#39;: 6072,
 &#39;C.&#39;: 1321,
 &#39;§&#39;: 6375,
 &#39;375&#39;: 37,
 &#39;378&#39;: 36,
 &#39;submit&#39;: 57,
 &#39;customer&#39;: 9,
 &#39;information&#39;: 310,
 &#39;States&#39;: 2256,
 &#39;into&#39;: 572,
 &#39;which&#39;: 2646,
 &#39;they&#39;: 1302,
 &#39;ship&#39;: 22,
 &#39;and&#39;: 15113,
 &#39;State&#39;: 1262,
 &#39;has&#39;: 2191,
 &#39;agreed&#39;: 176,
 &#39;forward&#39;: 51,
 &#39;that&#39;: 18373,
 &#39;That&#39;: 507,
 &#39;helps&#39;: 26,
 &#39;track&#39;: 19,
 &#39;down&#39;: 115,
 &#39;cigarette&#39;: 14,
 &#39;who&#39;: 1201,
 &#39;do&#39;: 1015,
 &#39;not&#39;: 8499,
 &#39;pay&#39;: 124,
 &#39;their&#39;: 1507,
 &#39;Against&#39;: 27,
 &#39;backdrop&#39;: 10,
 &#39;filed&#39;: 402,
 &#39;this&#39;: 3792,
 &#39;lawsuit&#39;: 51,
 &#39;under&#39;: 2030,
 &#39;Racketeer&#39;: 6,
 &#39;Influenced&#39;: 6,
 &#39;Corrupt&#39;: 6,
 &#39;Organizations&#39;: 11,
 &#39;(&#39;: 14766,
 &#39;RICO&#39;: 99,
 &#39;)&#39;: 18634,
 &#39;alleging&#39;: 33,
 &#39;failure&#39;: 216,
 &#39;file&#39;: 195,
 &#39;reports&#39;: 84,
 &#39;with&#39;: 3669,
 &#39;constituted&#39;: 41,
 &#39;mail&#39;: 76,
 &#39;wire&#39;: 37,
 &#39;fraud&#39;: 328,
 &#39;are&#39;: 2675,
 &#39;defined&#39;: 144,
 &#39;&quot;&#39;: 30807,
 &#39;racketeering&#39;: 5,
 &#39;activit[ies&#39;: 1,
 &#39;]&#39;: 3140,
 &#39;18&#39;: 499,
 &#39;1961(1&#39;: 4,
 &#39;subject&#39;: 502,
 &#39;enforcement&#39;: 148,
 &#39;civil&#39;: 198,
 &#39;1964(c&#39;: 12,
 &#39;The&#39;: 5952,
 &#39;District&#39;: 1052,
 &#39;Court&#39;: 5729,
 &#39;dismissed&#39;: 61,
 &#39;claims&#39;: 611,
 &#39;but&#39;: 1669,
 &#39;Second&#39;: 481,
 &#39;Circuit&#39;: 695,
 &#39;vacated&#39;: 47,
 &#39;judgment&#39;: 1061,
 &#39;remanded&#39;: 129,
 &#39;Among&#39;: 37,
 &#39;other&#39;: 1491,
 &#39;things&#39;: 81,
 &#39;Appeals&#39;: 794,
 &#39;held&#39;: 625,
 &#39;asserted&#39;: 113,
 &#39;injury&#39;: 174,
 &#39;—&#39;: 1921,
 &#39;lost&#39;: 60,
 &#39;revenue&#39;: 51,
 &#39;came&#39;: 32,
 &#39;about&#39;: 767,
 &#39;by&#39;: 4551,
 &#39;reason&#39;: 416,
 &#39;predicate&#39;: 75,
 &#39;frauds&#39;: 23,
 &#39;It&#39;: 1106,
 &#39;accordingly&#39;: 30,
 &#39;determined&#39;: 150,
 &#39;had&#39;: 1656,
 &#39;stated&#39;: 232,
 &#39;a&#39;: 18294,
 &#39;valid&#39;: 136,
 &#39;claim&#39;: 938,
 &#39;Held&#39;: 68,
 &#39;:&#39;: 1401,
 &#39;is&#39;: 9354,
 &#39;reversed&#39;: 181,
 &#39;case&#39;: 1985,
 &#39;541&#39;: 78,
 &#39;F.&#39;: 1407,
 &#39;3d&#39;: 1008,
 &#39;425&#39;: 32,
 &#39;Chief&#39;: 146,
 &#39;Justice&#39;: 872,
 &#39;Roberts&#39;: 124,
 &#39;delivered&#39;: 157,
 &#39;opinion&#39;: 1212,
 &#39;part&#39;: 695,
 &#39;concluding&#39;: 116,
 &#39;because&#39;: 1303,
 &#39;can&#39;: 1523,
 &#39;show&#39;: 217,
 &#39;it&#39;: 4838,
 &#39;alleged&#39;: 202,
 &#39;violation&#39;: 393,
 &#39;Pp&#39;: 393,
 &#39;5&#39;: 623,
 &#39;To&#39;: 306,
 &#39;establish&#39;: 166,
 &#39;an&#39;: 4200,
 &#39;plaintiff&#39;: 258,
 &#39;offense&#39;: 354,
 &#39;only&#39;: 1770,
 &#39;was&#39;: 3521,
 &quot;&#39;&quot;: 4309,
 &#39;for&#39;: 7978,
 &#39;cause&#39;: 375,
 &#39;his&#39;: 1845,
 &#39;proximate&#39;: 26,
 &#39;well&#39;: 492,
 &#39;Holmes&#39;: 34,
 &#39;v.&#39;: 4345,
 &#39;Securities&#39;: 57,
 &#39;Investor&#39;: 6,
 &#39;Protection&#39;: 60,
 &#39;Corporation&#39;: 43,
 &#39;503&#39;: 63,
 &#39;258&#39;: 22,
 &#39;268&#39;: 37,
 &#39;Proximate&#39;: 2,
 &#39;purposes&#39;: 294,
 &#39;should&#39;: 1012,
 &#39;be&#39;: 4659,
 &#39;evaluated&#39;: 12,
 &#39;light&#39;: 286,
 &#39;common&#39;: 264,
 &#39;foundations&#39;: 7,
 &#39;thus&#39;: 437,
 &#39;some&#39;: 736,
 &#39;direct&#39;: 161,
 &#39;relation&#39;: 65,
 &#39;between&#39;: 624,
 &#39;injurious&#39;: 5,
 &#39;conduct&#39;: 686,
 &#39;Ibid&#39;: 461,
 &#39;A&#39;: 857,
 &#39;link&#39;: 22,
 &#39;too&#39;: 179,
 &#39;remote&#39;: 23,
 &#39;purely&#39;: 34,
 &#39;contingent&#39;: 12,
 &#39;indirec[t&#39;: 2,
 &#39;insufficient&#39;: 68,
 &#39;Id.&#39;: 1254,
 &#39;at&#39;: 9800,
 &#39;271&#39;: 14,
 &#39;274&#39;: 39,
 &#39;causal&#39;: 12,
 &#39;theory&#39;: 205,
 &#39;satisfy&#39;: 106,
 &#39;relationship&#39;: 136,
 &#39;requirement&#39;: 376,
 &#39;Indeed&#39;: 196,
 &#39;here&#39;: 652,
 &#39;far&#39;: 204,
 &#39;more&#39;: 1214,
 &#39;attenuated&#39;: 12,
 &#39;than&#39;: 1270,
 &#39;one&#39;: 1262,
 &#39;rejected&#39;: 248,
 &#39;According&#39;: 80,
 &#39;committed&#39;: 136,
 &#39;selling&#39;: 17,
 &#39;failing&#39;: 51,
 &#39;required&#39;: 397,
 &#39;Without&#39;: 38,
 &#39;could&#39;: 1033,
 &#39;pass&#39;: 41,
 &#39;even&#39;: 910,
 &#39;if&#39;: 1636,
 &#39;been&#39;: 1138,
 &#39;so&#39;: 1158,
 &#39;inclined&#39;: 8,
 &#39;Some&#39;: 67,
 &#39;customers&#39;: 53,
 &#39;legally&#39;: 61,
 &#39;obligated&#39;: 10,
 &#39;failed&#39;: 197,
 &#39;Because&#39;: 307,
 &#39;did&#39;: 1303,
 &#39;receive&#39;: 130,
 &#39;determine&#39;: 326,
 &#39;pursue&#39;: 78,
 &#39;those&#39;: 1158,
 &#39;payment&#39;: 52,
 &#39;thereby&#39;: 85,
 &#39;injured&#39;: 30,
 &#39;amount&#39;: 258,
 &#39;portion&#39;: 78,
 &#39;back&#39;: 130,
 &#39;were&#39;: 1191,
 &#39;never&#39;: 247,
 &#39;collected&#39;: 7,
 &#39;As&#39;: 716,
 &#39;reiterated&#39;: 20,
 &#39;[&#39;: 3078,
 &#39;t]he&#39;: 180,
 &#39;general&#39;: 417,
 &#39;tendency&#39;: 12,
 &#39;regard&#39;: 62,
 &#39;damages&#39;: 174,
 &#39;least&#39;: 289,
 &#39;go&#39;: 94,
 &#39;beyond&#39;: 230,
 &#39;first&#39;: 718,
 &#39;step&#39;: 94,
 &#39;i&#39;: 1008,
 &#39;d.&#39;: 975,
 &#39;272&#39;: 29,
 &#39;applies&#39;: 365,
 &#39;full&#39;: 243,
 &#39;force&#39;: 233,
 &#39;inquiries&#39;: 17,
 &#39;e.g.&#39;: 879,
 &#39;ibid&#39;: 207,
 &#39;causation&#39;: 23,
 &#39;move&#39;: 26,
 &#39;suffers&#39;: 15,
 &#39;same&#39;: 765,
 &#39;defect&#39;: 17,
 &#39;Anza&#39;: 20,
 &#39;Ideal&#39;: 19,
 &#39;Steel&#39;: 25,
 &#39;Supply&#39;: 10,
 &#39;Corp.&#39;: 207,
 &#39;547&#39;: 76,
 &#39;451&#39;: 41,
 &#39;458&#39;: 59,
 &#39;461&#39;: 50,
 &#39;where&#39;: 588,
 &#39;causing&#39;: 13,
 &#39;harm&#39;: 146,
 &#39;distinct&#39;: 73,
 &#39;giving&#39;: 86,
 &#39;rise&#39;: 60,
 &#39;see&#39;: 1707,
 &#39;disconnect&#39;: 2,
 &#39;sharper&#39;: 2,
 &#39;In&#39;: 1893,
 &#39;party&#39;: 520,
 &#39;both&#39;: 465,
 &#39;engaged&#39;: 65,
 &#39;harmful&#39;: 22,
 &#39;fraudulent&#39;: 38,
 &#39;act&#39;: 231,
 &#39;Here&#39;: 107,
 &#39;liability&#39;: 247,
 &#39;rests&#39;: 65,
 &#39;just&#39;: 333,
 &#39;separate&#39;: 209,
 &#39;actions&#39;: 258,
 &#39;carried&#39;: 38,
 &#39;parties&#39;: 678,
 &#39;extend&#39;: 71,
 &#39;situations&#39;: 32,
 &#39;defendant&#39;: 613,
 &#39;third&#39;: 159,
 &#39;made&#39;: 653,
 &#39;easier&#39;: 33,
 &#39;fourth&#39;: 41,
 &#39;taxpayer&#39;: 11,
 &#39;taxpayers&#39;: 13,
 &#39;caused&#39;: 112,
 &#39;place&#39;: 389,
 &#39;decided&#39;: 169,
 &#39;Put&#39;: 8,
 &#39;simply&#39;: 305,
 &#39;obligation&#39;: 81,
 &#39;before&#39;: 826,
 &#39;stretched&#39;: 4,
 &#39;chain&#39;: 26,
 &#39;declines&#39;: 15,
 &#39;today&#39;: 275,
 &#39;See&#39;: 3037,
 &#39;460&#39;: 41,
 &#39;9&#39;: 509,
 &#39;b&#39;: 120,
 &#39;attempts&#39;: 59,
 &#39;avoid&#39;: 218,
 &#39;conclusion&#39;: 453,
 &#39;characterizing&#39;: 9,
 &#39;merely&#39;: 201,
 &#39;systematic&#39;: 37,
 &#39;scheme&#39;: 133,
 &#39;defraud&#39;: 39,
 &#39;escape&#39;: 26,
 &#39;embraced&#39;: 14,
 &#39;all&#39;: 1495,
 &#39;indirectly&#39;: 20,
 &#39;harmed&#39;: 15,
 &#39;precedent&#39;: 165,
 &#39;would&#39;: 2822,
 &#39;become&#39;: 106,
 &#39;mere&#39;: 81,
 &#39;pleading&#39;: 45,
 &#39;rule&#39;: 715,
 &#39;makes&#39;: 276,
 &#39;clear&#39;: 455,
 &#39;compensable&#39;: 5,
 &#39;flowing&#39;: 5,
 &#39;...&#39;: 1600,
 &#39;necessarily&#39;: 133,
 &#39;acts&#39;: 187,
 &#39;supra&#39;: 994,
 &#39;457&#39;: 31,
 &#39;led&#39;: 63,
 &#39;injuries&#39;: 28,
 &#39;also&#39;: 1734,
 &#39;errs&#39;: 17,
 &#39;relying&#39;: 43,
 &#39;Bridge&#39;: 14,
 &#39;Phoenix&#39;: 3,
 &#39;Bond&#39;: 5,
 &#39;&amp;&#39;: 499,
 &#39;Indemnity&#39;: 8,
 &#39;Co.&#39;: 462,
 &#39;553&#39;: 61,
 &#39;_&#39;: 2073,
 &#39;There&#39;: 268,
 &#39;plaintiffs&#39;: 336,
 &#39;straightforward&#39;: 45,
 &#39;involved&#39;: 144,
 &#39;easily&#39;: 77,
 &#39;identifiable&#39;: 4,
 &#39;connection&#39;: 70,
 &#39;issue&#39;: 788,
 &#39;there&#39;: 795,
 &#39;petitioners&#39;: 370,
 &#39;misrepresentations&#39;: 16,
 &#39;no&#39;: 1984,
 &#39;independent&#39;: 312,
 &#39;factors&#39;: 215,
 &#39;account[ed&#39;: 3,
 &#39;anything&#39;: 112,
 &#39;Multiple&#39;: 4,
 &#39;steps&#39;: 56,
 &#39;And&#39;: 721,
 &#39;contrast&#39;: 109,
 &#39;certainly&#39;: 79,
 &#39;10&#39;: 567,
 &#39;14&#39;: 413,
 &#39;J.&#39;: 1306,
 &#39;Scalia&#39;: 334,
 &#39;Thomas&#39;: 223,
 &#39;Alito&#39;: 154,
 &#39;JJ&#39;: 104,
 &#39;joined&#39;: 184,
 &#39;Ginsburg&#39;: 118,
 &#39;concurring&#39;: 560,
 &#39;Breyer&#39;: 176,
 &#39;dissenting&#39;: 483,
 &#39;Stevens&#39;: 381,
 &#39;Kennedy&#39;: 228,
 &#39;Sotomayor&#39;: 120,
 &#39;took&#39;: 146,
 &#39;consideration&#39;: 157,
 &#39;decision&#39;: 1001,
 &#39;HEMI&#39;: 3,
 &#39;GROUP&#39;: 3,
 &#39;LLC&#39;: 25,
 &#39;KAI&#39;: 3,
 &#39;GACHUPIN&#39;: 3,
 &#39;PETITIONERS&#39;: 68,
 &#39;CITY&#39;: 12,
 &#39;OF&#39;: 57,
 &#39;NEW&#39;: 8,
 &#39;YORK&#39;: 6,
 &#39;writ&#39;: 286,
 &#39;certiorari&#39;: 374,
 &#39;united&#39;: 168,
 &#39;states&#39;: 313,
 &#39;court&#39;: 2667,
 &#39;appeals&#39;: 221,
 &#39;second&#39;: 420,
 &#39;circuit&#39;: 174,
 &#39;January&#39;: 58,
 &#39;25&#39;: 197,
 &#39;2010&#39;: 352,
 &#39;seldom&#39;: 5,
 &#39;own&#39;: 406,
 &#39;Federal&#39;: 681,
 &#39;however&#39;: 606,
 &#39;vendors&#39;: 6,
 &#39;argues&#39;: 158,
 &#39;constitutes&#39;: 72,
 &#39;lose&#39;: 25,
 &#39;tens&#39;: 7,
 &#39;millions&#39;: 15,
 &#39;dollars&#39;: 18,
 &#39;unrecovered&#39;: 1,
 &#39;we&#39;: 1960,
 &#39;hold&#39;: 205,
 &#39;We&#39;: 899,
 &#39;therefore&#39;: 414,
 &#39;reverse&#39;: 63,
 &#39;contrary&#39;: 247,
 &#39;I&#39;: 1534,
 &#39;This&#39;: 818,
 &#39;arises&#39;: 26,
 &#39;motion&#39;: 320,
 &#39;dismiss&#39;: 90,
 &#39;accept&#39;: 144,
 &#39;true&#39;: 206,
 &#39;factual&#39;: 154,
 &#39;allegations&#39;: 57,
 &#39;amended&#39;: 139,
 &#39;complaint&#39;: 177,
 &#39;Leatherman&#39;: 1,
 &#39;Tarrant&#39;: 1,
 &#39;County&#39;: 123,
 &#39;Narcotics&#39;: 5,
 &#39;Intelligence&#39;: 4,
 &#39;Coordination&#39;: 3,
 &#39;Unit&#39;: 2,
 &#39;507&#39;: 43,
 &#39;163&#39;: 29,
 &#39;164&#39;: 30,
 &#39;1993&#39;: 96,
 &#39;authorizes&#39;: 79,
 &#39;impose&#39;: 182,
 &#39;N.&#39;: 260,
 &#39;Y.&#39;: 84,
 &#39;Unconsol&#39;: 2,
 &#39;Law&#39;: 303,
 &#39;Ann&#39;: 196,
 &#39;9436(1&#39;: 2,
 &#39;West&#39;: 131,
 &#39;Supp&#39;: 333,
 &#39;2009&#39;: 563,
 &#39;Under&#39;: 214,
 &#39;authority&#39;: 532,
 &#39;levied&#39;: 3,
 &#39;$&#39;: 227,
 &#39;1.50&#39;: 1,
 &#39;per&#39;: 215,
 &#39;pack&#39;: 3,
 &#39;each&#39;: 307,
 &#39;standard&#39;: 410,
 &#39;possessed&#39;: 24,
 &#39;within&#39;: 601,
 &#39;sale&#39;: 67,
 &#39;use&#39;: 505,
 &#39;Admin&#39;: 11,
 &#39;Code&#39;: 355,
 &#39;11&#39;: 518,
 &#39;1302(a&#39;: 1,
 &#39;2008&#39;: 437,
 &#39;Record&#39;: 81,
 &#39;A1016&#39;: 1,
 &#39;When&#39;: 243,
 &#39;buy&#39;: 10,
 &#39;seller&#39;: 12,
 &#39;responsible&#39;: 68,
 &#39;charging&#39;: 24,
 &#39;collecting&#39;: 47,
 &#39;remitting&#39;: 1,
 &#39;Tax&#39;: 17,
 &#39;471(2&#39;: 1,
 &#39;Out&#39;: 1,
 &#39;Smokes-Spirits.com&#39;: 3,
 &#39;Inc.&#39;: 546,
 &#39;432&#39;: 26,
 &#39;433&#39;: 20,
 &#39;CA2&#39;: 124,
 &#39;Instead&#39;: 129,
 &#39;recovering&#39;: 2,
 &#39;sold&#39;: 31,
 &#39;outside&#39;: 167,
 &#39;difficult&#39;: 148,
 &#39;often&#39;: 211,
 &#39;reluctant&#39;: 14,
 &#39;tough&#39;: 2,
 &#39;One&#39;: 98,
 &#39;way&#39;: 281,
 &#39;gather&#39;: 8,
 &#39;assist&#39;: 16,
 &#39;through&#39;: 426,
 &#39;63&#39;: 65,
 &#39;Stat&#39;: 412,
 &#39;884&#39;: 6,
 &#39;69&#39;: 34,
 &#39;627&#39;: 10,
 &#39;register&#39;: 74,
 &#39;report&#39;: 114,
 &#39;tobacco&#39;: 12,
 &#39;administrators&#39;: 15,
 &#39;listing&#39;: 41,
 &#39;name&#39;: 80,
 &#39;address&#39;: 246,
 &#39;quantity&#39;: 12,
 &#39;purchased&#39;: 18,
 &#39;have&#39;: 3351,
 &#39;executed&#39;: 25,
 &#39;agreement&#39;: 420,
 &#39;undertake&#39;: 32,
 &#39;cooperate&#39;: 12,
 &#39;fully&#39;: 87,
 &#39;keep&#39;: 250,
 &#39;promptly&#39;: 19,
 &#39;informed&#39;: 95,
 &#39;reference&#39;: 119,
 &#39;any&#39;: 2359,
 &#39;person&#39;: 421,
 &#39;transaction&#39;: 36,
 &#39;including&#39;: 397,
 &#39;i]nformation&#39;: 1,
 &#39;obtained&#39;: 83,
 &#39;may&#39;: 1890,
 &#39;result&#39;: 353,
 &#39;additional&#39;: 214,
 &#39;provided&#39;: 261,
 &#39;disclosure&#39;: 280,
 &#39;permissible&#39;: 48,
 &#39;existing&#39;: 105,
 &#39;laws&#39;: 397,
 &#39;agreements&#39;: 70,
 &#39;A1003&#39;: 1,
 &#39;asserts&#39;: 84,
 &#39;forwards&#39;: 1,
 &#39;A998&#39;: 1,
 &#39;Amended&#39;: 8,
 &#39;Compl&#39;: 5,
 &#39;¶54&#39;: 1,
 &#39;¶¶58&#39;: 2,
 &#39;59&#39;: 49,
 &#39;company&#39;: 103,
 &#39;does&#39;: 1700,
 &#39;alleges&#39;: 24,
 &#39;cost&#39;: 43,
 &#39;hundreds&#39;: 20,
 &#39;year&#39;: 356,
 &#39;excise&#39;: 5,
 &#39;A996&#39;: 3,
 &#39;Based&#39;: 35,
 &#39;federal&#39;: 1542,
 &#39;B&#39;: 206,
 &#39;provides&#39;: 363,
 &#39;private&#39;: 339,
 &#39;action&#39;: 606,
 &#39;a]ny&#39;: 17,
 &#39;business&#39;: 445,
 &#39;property&#39;: 652,
 &#39;section&#39;: 200,
 &#39;1962&#39;: 18,
 &#39;chapter&#39;: 48,
 &#39;Section&#39;: 267,
 &#39;turn&#39;: 125,
 &#39;contains&#39;: 75,
 &#39;criminal&#39;: 495,
 &#39;provisions&#39;: 483,
 &#39;Specifically&#39;: 22,
 &#39;1962(c&#39;: 2,
 &#39;invokes&#39;: 22,
 &#39;unlawful&#39;: 90,
 &#39;employed&#39;: 52,
 &#39;associated&#39;: 35,
 &#39;enterprise&#39;: 19,
 &#39;activities&#39;: 218,
 &#39;affect&#39;: 77,
 &#39;interstate&#39;: 88,
 &#39;commerce&#39;: 83,
 &#39;participate&#39;: 35,
 &#39;affairs&#39;: 31,
 &#39;pattern&#39;: 22,
 &#39;activity&#39;: 154,
 &#39;R]acketeering&#39;: 1,
 &#39;include&#39;: 214,
 &#39;number&#39;: 220,
 &#39;called&#39;: 103,
 &#39;two&#39;: 757,
 &#39;identifying&#39;: 41,
 &#39;constitute&#39;: 120,
 &#39;offenses&#39;: 123,
 &#39;A980&#39;: 4,
 &#39;Invoking&#39;: 5,
 &#39;suffered&#39;: 53,
 &#39;form&#39;: 197,
 &#39;terms--&quot;by&#39;: 1,
 &#39;contest&#39;: 21,
 &#39;characterization&#39;: 26,
 &#39;violations&#39;: 109,
 &#39;actionable&#39;: 7,
 &#39;assume&#39;: 108,
 &#39;without&#39;: 736,
 &#39;deciding&#39;: 106,
 &#39;material&#39;: 172,
 &#39;serve&#39;: 111,
 &#39;determining&#39;: 172,
 &#39;owner&#39;: 40,
 &#39;officer&#39;: 105,
 &#39;Kai&#39;: 1,
 &#39;Gachupin&#39;: 3,
 &#39;individual&#39;: 316,
 &#39;duty&#39;: 194,
 &#39;Nexicon&#39;: 1,
 &#39;No&#39;: 393,
 &#39;03&#39;: 5,
 &#39;CV&#39;: 1,
 &#39;383&#39;: 38,
 &#39;DAB&#39;: 1,
 &#39;2006&#39;: 287,
 &#39;WL&#39;: 20,
 &#39;647716&#39;: 1,
 &#39;*&#39;: 387,
 &#39;7-*8&#39;: 1,
 &#39;SDNY&#39;: 24,
 &#39;Mar.&#39;: 48,
 &#39;formed&#39;: 60,
 &#39;7-*10&#39;: 1,
 &#39;ground&#39;: 196,
 &#39;whether&#39;: 1708,
 &#39;loss&#39;: 58,
 &#39;1964&#39;: 45,
 &#39;further&#39;: 411,
 &#39;proceedings&#39;: 325,
 &#39;established&#39;: 290,
 &#39;operated&#39;: 29,
 &#39;447&#39;: 50,
 &#39;448&#39;: 15,
 &#39;444&#39;: 47,
 &#39;445&#39;: 42,
 &#39;concluded&#39;: 310,
 &#39;440&#39;: 25,
 &#39;viable&#39;: 5,
 &#39;Judge&#39;: 102,
 &#39;Winter&#39;: 15,
 &#39;dissented&#39;: 11,
 &#39;petition&#39;: 473,
 &#39;asking&#39;: 53,
 &#39;Pet&#39;: 233,
 &#39;Cert&#39;: 205,
 &#39;i.&#39;: 13,
 &#39;granted&#39;: 316,
 &#39;556&#39;: 72,
 &#39;II&#39;: 307,
 &#39;Though&#39;: 26,
 &#39;framed&#39;: 16,
 &#39;single&#39;: 202,
 &#39;question&#39;: 966,
 &#39;raises&#39;: 43,
 &#39;issues&#39;: 125,
 &#39;First&#39;: 800,
 &#39;allegedly&#39;: 49,
 &#39;decide&#39;: 301,
 &#39;1992&#39;: 105,
 &#39;set&#39;: 342,
 &#39;forth&#39;: 168,
 &#39;addressed&#39;: 110,
 &#39;brought&#39;: 178,
 &#39;SIPC&#39;: 8,
 &#39;against&#39;: 799,
 &#39;defendants&#39;: 177,
 &#39;whom&#39;: 156,
 &#39;manipulated&#39;: 4,
 &#39;stock&#39;: 38,
 &#39;prices&#39;: 33,
 &#39;262&#39;: 20,
 &#39;263&#39;: 42,
 &#39;reimburse&#39;: 2,
 &#39;certain&#39;: 445,
 &#39;registered&#39;: 87,
 &#39;broker&#39;: 8,
 &#39;dealers&#39;: 47,
 &#39;event&#39;: 105,
 &#39;unable&#39;: 44,
 &#39;meet&#39;: 64,
 &#39;financial&#39;: 80,
 &#39;obligations&#39;: 52,
 &#39;261&#39;: 19,
 &#39;conspiracy&#39;: 59,
 &#39;manipulators&#39;: 1,
 &#39;detected&#39;: 2,
 &#39;collapsed&#39;: 5,
 &#39;insurer&#39;: 1,
 &#39;ultimately&#39;: 76,
 &#39;hook&#39;: 2,
 &#39;nearly&#39;: 73,
 &#39;13&#39;: 452,
 &#39;million&#39;: 63,
 &#39;cover&#39;: 87,
 &#39;conspirators&#39;: 6,
 &#39;phrase&#39;: 187,
 &#39;used&#39;: 324,
 &#39;explained&#39;: 261,
 &#39;Applying&#39;: 43,
 &#39;hand&#39;: 92,
 &#39;quoting&#39;: 424,
 &#39;Associated&#39;: 7,
 &#39;Gen.&#39;: 42,
 &#39;Contractors&#39;: 4,
 &#39;Cal&#39;: 71,
 &#39;Carpenters&#39;: 1,
 &#39;459&#39;: 44,
 &#39;519&#39;: 42,
 &#39;534&#39;: 55,
 &#39;1983&#39;: 137,
 &#39;Southern&#39;: 38,
 &#39;Pacific&#39;: 90,
 &#39;Darnell&#39;: 1,
 &#39;Taenzer&#39;: 1,
 &#39;Lumber&#39;: 2,
 &#39;245&#39;: 15,
 &#39;531&#39;: 44,
 &#39;533&#39;: 70,
 &#39;1918&#39;: 5,
 &#39;internal&#39;: 412,
 &#39;quotation&#39;: 395,
 &#39;marks&#39;: 398,
 &#39;omitted&#39;: 484,
 &#39;Our&#39;: 158,
 &#39;cases&#39;: 934,
 &#39;confirm&#39;: 38,
 &#39;slip&#39;: 349,
 &#39;op&#39;: 346,
 &#39;19&#39;: 240,
 &#39;us&#39;: 462,
 &#39;confirms&#39;: 28,
 &#39;indirect&#39;: 9,
 &#39;considered&#39;: 217,
 &#39;competitor&#39;: 10,
 &#39;National&#39;: 215,
 &#39;defrauded&#39;: 9,
 &#39;able&#39;: 116,
 &#39;undercut&#39;: 11,
 &#39;lower&#39;: 128,
 &#39;offered&#39;: 58,
 &#39;contended&#39;: 20,
 &#39;allowed&#39;: 105,
 &#39;attract&#39;: 11,
 &#39;expense&#39;: 17,
 &#39;Finding&#39;: 24,
 &#39;victim&#39;: 66,
 &#39;being&#39;: 186,
 &#39;recognized&#39;: 245,
 &#39;harms&#39;: 35,
 &#39;when&#39;: 1284,
 &#39;applicable&#39;: 184,
 &#39;offering&#39;: 10,
 &#39;entirely&#39;: 116,
 &#39;defrauding&#39;: 3,
 &#39;constituting&#39;: 33,
 &#39;Thus&#39;: 258,
 &#39;viewed&#39;: 48,
 &#39;point&#39;: 360,
 &#39;important&#39;: 232,
 &#39;nevertheless&#39;: 53,
 &#39;found&#39;: 348,
 &#39;distinction&#39;: 113,
 &#39;relevant&#39;: 386,
 &#39;sufficient&#39;: 207,
 &#39;defeat&#39;: 28,
 &#39;decline&#39;: 53,
 &#39;cf&#39;: 120,
 &#39;n.&#39;: 894,
 &#39;46&#39;: 97,
 &#39;finding&#39;: 240,
 &#39;antitrust&#39;: 30,
 &#39;context&#39;: 325,
 &#39;stems&#39;: 7,
 &#39;most&#39;: 431,
 &#39;persons&#39;: 247,
 &#39;victims&#39;: 59,
 &#39;highlighted&#39;: 9,
 &#39;better&#39;: 85,
 &#39;situated&#39;: 14,
 &#39;incentive&#39;: 33,
 &#39;sue&#39;: 49,
 &#39;269&#39;: 16,
 &#39;270&#39;: 21,
 &#39;seek&#39;: 211,
 &#39;recovery&#39;: 43,
 &#39;imposes&#39;: 87,
 &#39;2.75&#39;: 1,
 &#39;double&#39;: 34,
 &#39;what&#39;: 783,
 &#39;charges&#39;: 80,
 &#39;471(1&#39;: 1,
 &#39;opine&#39;: 2,
 &#39;bring&#39;: 71,
 &#39;Suffice&#39;: 3,
 &#39;say&#39;: 221,
 &#39;concrete&#39;: 29,
 &#39;incentives&#39;: 18,
 &#39;try&#39;: 31,
 &#39;accuses&#39;: 2,
 &#39;Anzas&#39;: 1,
 &#39;substantial&#39;: 213,
 &#39;money&#39;: 134,
 &#39;If&#39;: 429,
 &#39;expected&#39;: 39,
 &#39;appropriate&#39;: 227,
 &#39;remedies&#39;: 79,
 &#39;dissent&#39;: 470,
 &#39;foreseeability&#39;: 6,
 &#39;rather&#39;: 317,
 &#39;existence&#39;: 97,
 &#39;sufficiently&#39;: 94,
 &#39;find&#39;: 233,
 &#39;satisfied&#39;: 77,
 &#39;foreseeable&#39;: 23,
 &#39;consequence&#39;: 79,
 &#39;intended&#39;: 231,
 &#39;indeed&#39;: 87,
 &#39;desired&#39;: 13,
 &#39;falls&#39;: 55,
 &#39;risks&#39;: 36,
 &#39;Congress&#39;: 1679,
 &#39;sought&#39;: 242,
 &#39;prevent&#39;: 189,
 &#39;Post&#39;: 202,
 &#39;6&#39;: 594,
 &#39;line&#39;: 163,
 &#39;reasoning&#39;: 102,
 &#39;sounds&#39;: 10,
 &#39;familiar&#39;: 33,
 &#39;precisely&#39;: 50,
 &#39;argument&#39;: 541,
 &#39;lodged&#39;: 7,
 &#39;majority&#39;: 415,
 &#39;criticized&#39;: 16,
 &#39;view&#39;: 556,
 &#39;permit[ting&#39;: 1,
 &#39;evade&#39;: 9,
 &#39;consequences&#39;: 158,
 &#39;behavior&#39;: 76,
 &#39;470&#39;: 56,
 &#39;carry&#39;: 60,
 &#39;day&#39;: 202,
 &#39;asked&#39;: 146,
 &#39;revisit&#39;: 12,
 &#39;concepts&#39;: 6,
 &#39;course&#39;: 264,
 &#39;many&#39;: 355,
 &#39;shapes&#39;: 5,
 &#39;precedents&#39;: 218,
 &#39;make&#39;: 467,
 &#39;focus&#39;: 62,
 &#39;directness&#39;: 4,
 &#39;mention&#39;: 42,
 &#39;concept&#39;: 62,
 &#39;offers&#39;: 59,
 &#39;responses&#39;: 32,
 &#39;challenges&#39;: 140,
 &#39;our&#39;: 1019,
 &#39;Brief&#39;: 919,
 &#39;42&#39;: 177,
 &#39;Having&#39;: 25,
 &#39;broadly&#39;: 48,
 &#39;contends&#39;: 153,
 &#39;Otherwise&#39;: 13,
 &#39;example&#39;: 331,
 &#39;give&#39;: 215,
 &#39;competitive&#39;: 22,
 &#39;advantage&#39;: 34,
 &#39;over&#39;: 456,
 &#39;454&#39;: 52,
 &#39;455&#39;: 49,
 &#39;allegation&#39;: 16,
 &#39;circumvent&#39;: 10,
 &#39;claiming&#39;: 39,
 &#39;aim&#39;: 42,
 &#39;increase&#39;: 54,
 &#39;market&#39;: 167,
 &#39;share&#39;: 54,
 &#39;460.1&#39;: 1,
 &#39;moreover&#39;: 80,
 &#39;Sedima&#39;: 2,
 &#39;P.&#39;: 107,
 &#39;R.&#39;: 263,
 &#39;L.&#39;: 350,
 &#39;Imrex&#39;: 2,
 &#39;473&#39;: 60,
 &#39;479&#39;: 68,
 &#39;497&#39;: 28,
 &#39;1985&#39;: 74,
 &#39;statement&#39;: 264,
 &#39;went&#39;: 39,
 &#39;allege&#39;: 24,
 &#39;assertion&#39;: 65,
 &#39;legal&#39;: 414,
 &#39;very&#39;: 226,
 &#39;relies&#39;: 92,
 &#39;reaffirmed&#39;: 24,
 &#39;wrongful&#39;: 42,
 &#39;competing&#39;: 32,
 &#39;bidders&#39;: 7,
 &#39;county&#39;: 48,
 &#39;lien&#39;: 4,
 &#39;auction&#39;: 18,
 &#39;liens&#39;: 5,
 &#39;profitable&#39;: 3,
 &#39;lowest&#39;: 8,
 &#39;possible&#39;: 180,
 &#39;bid&#39;: 7,
 &#39;multiple&#39;: 48,
 &#39;low&#39;: 22,
 &#39;bidding&#39;: 4,
 &#39;percentage&#39;: 28,
 &#39;penalty&#39;: 200,
 &#39;bidder&#39;: 6,
 &#39;require&#39;: 330,
 &#39;0&#39;: 4,
 &#39;%&#39;: 135,
 &#39;awarded&#39;: 56,
 &#39;devised&#39;: 11,
 &#39;plan&#39;: 163,
 &#39;allocate&#39;: 3,
 &#39;rotational&#39;: 2,
 &#39;basis&#39;: 381,
 &#39;3&#39;: 747,
 &#39;noted&#39;: 256,
 &#39;created&#39;: 157,
 &#39;perverse&#39;: 9,
 &#39;Bidders&#39;: 1,
 &#39;addition&#39;: 121,
 &#39;themselves&#39;: 141,
 &#39;sen[t&#39;: 1,
 &#39;agents&#39;: 19,
 &#39;behalf&#39;: 110,
 &#39;obtain&#39;: 106,
 &#39;disproportionate&#39;: 29,
 &#39;prohibited&#39;: 108,
 ...}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_doc_counts</span><span class="p">(</span><span class="n">input_corpus</span><span class="p">,</span> <span class="n">weighting</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">doc_counts</span> <span class="o">=</span> <span class="n">input_corpus</span><span class="o">.</span><span class="n">word_doc_counts</span><span class="p">(</span><span class="n">weighting</span><span class="o">=</span><span class="n">weighting</span><span class="p">,</span> <span class="n">filter_stops</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;orth_&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">doc_counts</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="n">limit</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">word_doc_counts</span></code> provides a few ways of quantifying the prevalence of individual words across the corpus: whether a word appears many times in most documents, just a few times in a few documents, many times in a few documents, or just a few times in most documents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# DOCS APPEARING IN / TOTAL # DOCS&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;-----------&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">show_doc_counts</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="s2">&quot;freq&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;LOG(TOTAL # DOCS / # DOCS APPEARING IN)&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;-----------&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">show_doc_counts</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="s2">&quot;idf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># DOCS APPEARING IN / TOTAL # DOCS
-----------
Court           0.9873417721518988
case            0.9873417721518988
certiorari      0.9873417721518988
granted         0.9873417721518988
U.              0.9746835443037974
S.              0.9746835443037974
judgment        0.9746835443037974
v.              0.9746835443037974
decision        0.9746835443037974
court           0.9746835443037974
C.              0.9620253164556962
held            0.9620253164556962
opinion         0.9620253164556962
2009            0.9620253164556962
1               0.9620253164556962
F.              0.9493670886075949
Justice         0.9493670886075949
Id.             0.9493670886075949
e.g.            0.9493670886075949
issue           0.9493670886075949

LOG(TOTAL # DOCS / # DOCS APPEARING IN)
-----------
cigarettes      4.382026634673881
Hemi            4.382026634673881
cigarette       4.382026634673881
RICO            4.382026634673881
racketeering    4.382026634673881
activit[ies     4.382026634673881
1964(c          4.382026634673881
Proximate       4.382026634673881
indirec[t       4.382026634673881
Anza            4.382026634673881
Ideal           4.382026634673881
disconnect      4.382026634673881
sharper         4.382026634673881
Phoenix         4.382026634673881
account[ed      4.382026634673881
HEMI            4.382026634673881
GROUP           4.382026634673881
KAI             4.382026634673881
GACHUPIN        4.382026634673881
YORK            4.382026634673881
</pre></div>
</div>
</div>
</div>
<p>textacy provides implementations of algorithms for identifying words and phrases that are representative of a document (aka <strong>keyterm extraction</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">textacy.extract</span> <span class="kn">import</span> <span class="n">keyterms</span> <span class="k">as</span> <span class="n">ke</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># corpus[0].text</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the Yake algorithim (Campos et al., 2018) on a given document</span>
<span class="n">key_terms_yake</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">yake</span><span class="p">(</span><span class="n">corpus</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">key_terms_yake</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;New York City&#39;, 0.002288298045327596),
 (&#39;New York State&#39;, 0.0060401030525529436),
 (&#39;U. S. C.&#39;, 0.0075325125188752005),
 (&#39;Jenkins Act&#39;, 0.012460549374297763),
 (&#39;York City customer&#39;, 0.021988206972901634),
 (&#39;RICO&#39;, 0.027329026591127712),
 (&#39;Hemi Group&#39;, 0.03384924285412936),
 (&#39;York City cigarette&#39;, 0.03513697406836725),
 (&#39;Jenkins Act information&#39;, 0.03892293549952245),
 (&#39;RICO claim&#39;, 0.042756731344701926)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="keyword-in-context">
<h2>Keyword in context<a class="headerlink" href="#keyword-in-context" title="Permalink to this heading">#</a></h2>
<p>Sometimes researchers find it helpful just to see a particular keyword in context.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;case_name&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;case_name&#39;</span><span class="p">)),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">textacy</span><span class="o">.</span><span class="n">extract</span><span class="o">.</span><span class="n">kwic</span><span class="o">.</span><span class="n">keyword_in_context</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;judgment&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">match</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> HEMI GROUP, LLC AND KAI GACHUPIN v. CITY OF NEW YORK, NEW YORK 
 -------------------------------------------------------------- 

ed the claims, but the Second Circuit vacated the  judgment  and remanded. Among other things, the Court of Ap
the City had stated a valid RICO claim. Held: The  judgment  is reversed, and the case is remanded. 541 F. 3d 
 opinion concurring in part and concurring in the  judgment . Breyer, J., filed a dissenting opinion, in which
  The Second Circuit vacated the District Court&#39;s  judgment  and remanded for further proceedings. The Court o
 it. The City, therefore, has no RICO claim.  The  judgment  of the Court of Appeals for the Second Circuit is
insburg, concurring in part and concurring in the  judgment .  As the Court points out, this is a case &quot;about 
he above-stated view, and I concur in the Court&#39;s  judgment . HEMI GROUP, LLC and KAI GACHUPIN, PETITIONERS v.

 CITIZENS UNITED v. FEDERAL ELECTION COMMISSION 
 ---------------------------------------------- 

ppellee Federal Election Commission (FEC) summary  judgment . Held:  1. Because the question whether §441b app
(Scalia, J., concurring in part and concurring in  judgment ). We agree with that conclusion and hold that sta
t later convened to hear the cause. The resulting  judgment  gives rise to this appeal.  Citizens United has a
m), and then granted the FEC&#39;s motion for summary  judgment , App. 261a-262a. See id., at 261a (&quot;Based on the 
or opinion, we find that the [FEC] is entitled to  judgment  as a matter of law. See Citizen[s] United v. FEC,
onnell, supra, at 339 (Kennedy, J., concurring in  judgment  in part and dissenting in part). The Snowe-Jeffor
rt&#39;s later opinion, which granted the FEC summary  judgment , was &quot;[b]ased on the reasoning of [its] prior opi
62 (Scalia, J., concurring in part, concurring in  judgment  in part, and dissenting in part); id., at 273-275
part, concurring in result in part, concurring in  judgment  in part, and dissenting in part); id., at 322-338
pore over each word of a text to see if, in their  judgment , it accords with the 11-factor test they have pro
er, 502 U. S., at 124 (Kennedy, J., concurring in  judgment ), the quoted language from WRTL provides a suffic
toral opportunities means making and implementing  judgment s about which strengths should be permitted to con
issenting); id., at 773 (White, J., concurring in  judgment ). With the advent of the Internet and the decline
S. 334, 360-361 (1995) (Thomas, J., concurring in  judgment ). Yet television networks and major newspapers ow
t 341-343; id., at 367 (Thomas, J., concurring in  judgment ). At the founding, speech was open, comprehensive
endent expenditures; if they surrender their best  judgment ; and if they put expediency before principle, the
ation&#39;s course; still others simply might suspend  judgment  on these points but decide to think more about is
nell, supra, at 341 (opinion of Kennedy, J.). The  judgment  of the District Court is reversed with respect to
ctions on corporate independent expenditures. The  judgment  is affirmed with respect to BCRA&#39;s disclaimer and
Thomas, JJ., concurring in part and concurring in  judgment ); McConnell, 540 U. S., at 247, 264, 286 (opinion
86 (Thomas, J., concurring in part, concurring in  judgment  in part, and dissenting in part).  These readings
3) (Scalia, J., concurring in part, concurring in  judgment  in part, and dissenting in part) (quoting C. Cook
 U. S. 334, 360 (1995) (Thomas, J., concurring in  judgment ); see also McConnell, 540 U. S., at 252-253 (opin
 an affirmative answer to that question is, in my  judgment , profoundly misguided. Even more misguided is the
 Comm. (NRWC), and have accepted the &quot;legislative  judgment  that the special characteristics of the corporate
 of §203. App. 23a-24a. In its motion for summary  judgment , however, Citizens United expressly abandoned its
Roberts, J., concurring in part and concurring in  judgment ).  Consider just three of the narrower grounds of
s of longstanding practice and Congress&#39; reasoned  judgment  that certain regulations which leave &quot;untouched f
precedents &quot;represent respect for the legislative  judgment  that the special characteristics of the corporate
oach taken by the majority cannot be right, in my  judgment . It disregards our constitutional history and the
erting an &quot; &#39;undue influence on an officeholder&#39;s  judgment &#39; &quot; and from creating &quot; &#39;the appearance of such in
orations).  When the McConnell Court affirmed the  judgment  of the District Court regarding §203, we did not 
ll, 540 U. S., at 306 (Kennedy, J., concurring in  judgment  in part and dissenting in part); see also id., at
63 (Scalia, J., concurring in part, concurring in  judgment  in part, and dissenting in part), a disreputable 
nted where, as here, we deal with a congressional  judgment  that has remained essentially unchanged throughou
tisfy heightened judicial scrutiny of legislative  judgment s will vary up or down with the novelty and plausi
years of bipartisan deliberation and its reasoned  judgment  on this basis, without first confirming that the 
 J., dissenting). &quot;In the meantime, a legislative  judgment  that &#39;enough is enough&#39; should command the greate
Congress&#39; factual findings and its constitutional  judgment : It acknowledges the validity of the interest in 
O, 335 U. S., at 144 (Rutledge, J., concurring in  judgment )), and this, in turn, &quot;interferes with the &#39;open 
he expansive protections afforded by the business  judgment  rule. Blair &amp; Stout 320; see also id., at 298-315
relevance of established facts and the considered  judgment s of state and federal legislatures over many deca
 corporate money in politics.  I would affirm the  judgment  of the District Court. CITIZENS UNITED, APPELLANT
3) (Thomas, J., concurring in part, concurring in  judgment  in part, and dissenting in part) (internal quotat
64 (Thomas, J., concurring in part, concurring in  judgment  in part, and dissenting in part) (quoting Nixon v
ordingly, I respectfully dissent from the Court&#39;s  judgment  upholding BCRA §§201 and 311. FOOTNOTESFootnote 1
al Election Commission&#39;s (FEC) motion for summary  judgment , App. 261a-262a, any question about statutory val
done &quot;on the basis of entirely subjective, ad hoc  judgment s,&quot; 523 U. S., at 690, that suggested anticompetit
539 U. S., at 163-164 (Kennedy, J., concurring in  judgment ). Both Courts also heard criticisms of Austin fro
concurring in part and dissenting in part). In my  judgment , such limitations may be justified to the extent 
&quot;We should defer to [the legislature&#39;s] political  judgment  that unlimited spending threatens the integrity o

 HOLLY WOOD, PETITIONER v. RICHARD F. ALLEN, COMMISSIONER, ALABAMA DEPARTMENT OF CORRECTIONS, et al. 
 --------------------------------------------------------------------------------------------------- 

de a strategic decision, but to whether counsel&#39;s  judgment  was reasonable, a question not before this Court.
onship to §2254(e)(1). Accordingly, we affirm the  judgment  of the Court of Appeals on that basis. I  In 1993
umption that counsel exercised sound professional  judgment , supported by ample reasons, not to present the i
rategic decision, but rather to whether counsel&#39;s  judgment  was reasonable — a question we do not reach. See 
ons were an unreasonable exercise of professional  judgment  and constituted deficient performance under Stric
 itself was a reasonable exercise of professional  judgment  under Strickland or whether the application of St
mination of the facts. Accordingly, we affirm the  judgment  of the Court of Appeals for the Eleventh Circuit.
ess. That was a strategic decision based on their  judgment  that the evidence would do more harm than good. B
resulted from inattention, not reasoned strategic  judgment &quot;); Strickland, 466 U. S., at 690-691. Moreover, &quot;
 itself was a reasonable exercise of professional  judgment  under Strickland or whether the application of St

 AGRON KUCANA v. ERIC H. HOLDER, JR., ATTORNEY GENERAL 
 ----------------------------------------------------- 

.  (1) The amicus defending the Seventh Circuit&#39;s  judgment  urges that regulations suffice to trigger §1252(a
laces within the no-judicial-review category &quot;any  judgment  regarding the granting of relief under section 11
ed. Alito, J., filed an opinion concurring in the  judgment . AGRON KUCANA, PETITIONER v. ERIC H. HOLDER,Jr., 
ubparagraph (D),[1] and regardless of whether the  judgment , decision, or action is made in removal proceedin
urt shall have jurisdiction to review--  &quot;(i) any  judgment  regarding the granting of relief under section 11
micus curiae, in support of the Seventh Circuit&#39;s  judgment . 557 U. S. ___ (2009). Ms. Leiter has ably discha
mmigration decisions to motions for relief from a  judgment  under Federal Rule of Civil Procedure 60(b)). Fed
Nevertheless, in defense of the Seventh Circuit&#39;s  judgment , amicus urges that regulations suffice to trigger
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below 15, 17 (citing, inter alia, Florida Dept. o
laces within the no-judicial-review category &quot;any  judgment  regarding the granting of relief under section 11
  To the clause (i) enumeration of administrative  judgment s that are insulated from judicial review, Congres
dicial review. * * *  For the reasons stated, the  judgment  of the United States Court of Appeals for the Sev
nuary 20, 2010]  Justice Alito, concurring in the  judgment .  I agree that the Court of Appeals had jurisdict
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below 41-42.  Amicus&#39; argument is ingenious but u
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below 19, n. 8 (quoting §1229a(c)(7)(B)). One can
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below. In every one of those examples, Congress e
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below 21-23. But §1252(a)(2)(B)(ii) does not say 
Congress want to exclude review for discretionary  judgment s by the Attorney General that are recited explici
y in the statute, but provide judicial review for  judgment s that are just as lawfully discretionary because 
f for Court-Appointed Amicus Curiae in Support of  Judgment  Below 32-34. The report states that §1252(a)(2)(B

 MARCUS A. WELLONS v. HILTON HALL, WARDEN 
 ---------------------------------------- 

rd for an order granting certiorari, vacating the  judgment  below, and remanding the case (GVR) remains as it
ave to proceed in forma pauperis are granted. The  judgment  is vacated, and the case is remanded to the Eleve
nts Wellons&#39; petition for certiorari, vacates the  judgment  of the Eleventh Circuit, and remands (&quot;GVRs&quot;) in 
erse or set the case for argument; otherwise, the  judgment  below must stand. The same is true if (as the Cou
rits question. If they erred in that regard their  judgment  should be reversed rather than remanded &quot;in light
 we are, to vacate and send back their authorized  judgment s for inconsequential imperfection of opinion — as
 authority or development that casts doubt on the  judgment  of the court below. What the Court has done — usi
t of 1996 (AEDPA) to the &quot;Georgia Supreme Court&#39;s  judgment  as to the substance and effect of the ex parte co
</pre></div>
</div>
</div>
</div>
</section>
<section id="vectorization">
<h2>Vectorization<a class="headerlink" href="#vectorization" title="Permalink to this heading">#</a></h2>
<p>Let’s continue with corpus-level analysis by taking advantage of textacy’s vectorizer class, which wraps functionality from <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> to count the prevalence of certain tokens in each document of the corpus and to apply weights to these counts if desired. We could just work directly in <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, but it can be nice for mental overhead to learn one library and be able to do a great deal with it.</p>
<p>We’ll create a vectorizer, sticking with the normal term frequency defaults but discarding words that appear in fewer than 3 documents or more than 95% of documents. We’ll also limit our features to the top 500 words according to document frequency. This means our feature set, or columns, will have a higher degree of representation across the corpus. We could further scale these counts according to document frequency (or inverse document frequency) weights, or normalize the weights so that they add up to 1 for each document row (L1 norm), and so on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textacy.representations</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">textacy</span><span class="o">.</span><span class="n">representations</span><span class="o">.</span><span class="n">Vectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_df</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span> <span class="n">max_n_terms</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">tokenized_corpus</span> <span class="o">=</span> <span class="p">[[</span><span class="n">token</span><span class="o">.</span><span class="n">orth_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">textacy</span><span class="o">.</span><span class="n">extract</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">filter_nums</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_stops</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_punct</span><span class="o">=</span><span class="kc">True</span><span class="p">))]</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>

<span class="n">dtm</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">)</span>
<span class="n">dtm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;79x500 sparse matrix of type &#39;&lt;class &#39;numpy.int32&#39;&gt;&#39;
	with 22870 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
</div>
</div>
<p>We have now have a matrix representation of our corpus, where rows are documents, and columns (or features) are words from the corpus. The value at any given point is the number of times that the word appears in that document. Once we have a document-term matrix, we could do several things with it just within textacy, though we also can pass it into different algorithms within <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> or other libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at some of the terms</span>
<span class="n">vectorizer</span><span class="o">.</span><span class="n">terms_list</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;$&#39;,
 &#39;2d&#39;,
 &#39;3d&#39;,
 &#39;A.&#39;,
 &#39;AEDPA&#39;,
 &#39;Act&#39;,
 &#39;Amendment&#39;,
 &#39;American&#39;,
 &#39;Ann&#39;,
 &#39;Ante&#39;,
 &#39;App&#39;,
 &#39;Appeals&#39;,
 &#39;B&#39;,
 &#39;Board&#39;,
 &#39;Breyer&#39;,
 &#39;Brief&#39;,
 &#39;Cert&#39;,
 &#39;Cf&#39;,
 &#39;Circuit&#39;,
 &#39;Citizens&#39;]
</pre></div>
</div>
</div>
</div>
<p>We can see that we are still getting a number of terms which might be filtered out, such as symbols and abbreviations. The most straightforward solutions are to filter the terms against a dictionary during vectorization, which carries the risk of inadvertently filtering words that you’d prefer to keep in the dataset, or curating a custom stopword list, which can be inflexible and time consuming. Otherwise, it is often the case that the corpus analysis tools used with the vectorized texts (e.g., topic modeling or stylistic analysis – see below) have ways of recognizing and sequestering unwanted terms so that they can be excluded from the results if desired.</p>
</section>
<section id="exercise-topic-modeling">
<h2>Exercise - topic modeling<a class="headerlink" href="#exercise-topic-modeling" title="Permalink to this heading">#</a></h2>
<ol class="simple">
<li><p>Read through the below code to quickly look at one example of what we can do with a vectorized corpus. Topic modeling is very popular for semantic exploration of texts, and there are numerous implementations of it. Textacy uses implementations from scikit-learn. Our corpus is rather small for topic modeling, but just to see how it’s done here, we’ll go ahead. First, though, topic modeling works best when the texts are divided into approximately equal-sized “chunks.” A quick word-count of the corpus will show that the decisions are of quite variable lengths, which will skew the topic model.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="si">:</span><span class="s2"> &gt;5</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;case_name&#39;</span><span class="p">][:</span><span class="mi">80</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13007  HEMI GROUP, LLC AND KAI GACHUPIN v. CITY OF NEW YORK, NEW YORK
72325  CITIZENS UNITED v. FEDERAL ELECTION COMMISSION
 8333  HOLLY WOOD, PETITIONER v. RICHARD F. ALLEN, COMMISSIONER, ALABAMA DEPARTMENT OF 
 9947  AGRON KUCANA v. ERIC H. HOLDER, JR., ATTORNEY GENERAL
 5508  MARCUS A. WELLONS v. HILTON HALL, WARDEN
 4083  ERIC PRESLEY v. GEORGIA
 7609  NRG POWER MARKETING, LLC, et al. v. MAINE PUBLIC UTILITIES COMMISSION et al.
 6983  E. K. MCDANIEL, WARDEN, et al. v. TROY BROWN
13844  MARYLAND v. MICHAEL BLAINE SHATZER, SR.
 8945  THE HERTZ CORPORATION v. MELINDA FRIEND et al.
11605  FLORIDA v. KEVIN DEWAYNE POWELL
 2343  RICK THALER, DIRECTOR, TEXAS DEPARTMENT OF CRIMINAL JUSTICE, CORRECTIONAL INSTIT
 8531  MAC&#39;S SHELL SERVICE, INC., et al. v. SHELL OIL PRODUCTS CO. LLC et al.
 8259  REED ELSEVIER, INC., et al., v. IRVIN MUCHNICK et al.
 9502  CURTIS DARNELL JOHNSON v. UNITED STATES
  281  JAMAL KIYEMBA et al. v. BARACK H. OBAMA, PRESIDENT OF THE UNITED STATES et al.
12424  MILAVETZ, GALLOP &amp; MILAVETZ, P. A., et al. v. UNITED STATES
13983  TAYLOR JAMES BLOATE v. UNITED STATES
31066  SHADY GROVE ORTHOPEDIC ASSOCIATES, P. A. v. ALLSTATE INSURANCE COMPANY
15135  JOSE PADILLA v. KENTUCKY
 8236  JERRY N. JONES, et al. v. HARRIS ASSOCIATES L. P.
 8634  MARY BERGHUIS, WARDEN v. DIAPOLIS SMITH
15018  GRAHAM COUNTY SOIL AND WATER CONSERVATION DISTRICT, et al. v. UNITED STATES ex r
 8025  UNITED STUDENT AID FUNDS, INC. v. FRANCISCO J. ESPINOSA
 5499  ESTHER HUI, et al. v. YANIRA CASTANEDA, AS PERSONAL REPRESENTATIVE OF THE ESTATE
14398  PAUL RENICO, WARDEN v. REGINALD LETT
27245  KEN L. SALAZAR, SECRETARY OF THE INTERIOR, et al. v. FRANK BUONO
16003  STOLT-NIELSEN S. A., et al. v. ANIMALFEEDS INTERNATIONAL CORP.
12015  MERCK &amp; CO., INC., et al. v. RICHARD REYNOLDS et al.
25675  KAREN L. JERMAN v. CARLISLE, MCNELLIE, RINI, KRAMER &amp; ULRICH LPA, et al.
12618  SONNY PERDUE, GOVERNOR OF GEORGIA, et al. v. KENNY A., BY HIS NEXT FRIEND LINDA 
19636  UNITED STATES v. ROBERT J. STEVENS
19849  TIMOTHY MARK CAMERON ABBOTT v. JACQUELYN VAYE ABBOTT
31417  TERRANCE JAMAR GRAHAM v. FLORIDA
23340  UNITED STATES v. GRAYDON EARL COMSTOCK, JR., et al.
   20  JOE HARRIS SULLIVAN v. FLORIDA
 8980  AMERICAN NEEDLE, INC. v. NATIONAL FOOTBALL LEAGUE et al.
 5179  ARTHUR L. LEWIS, JR., et al. v. CITY OF CHICAGO, ILLINOIS
 9721  UNITED STATES v. MARTIN O&#39;BRIEN AND ARTHUR BURGESS
 6672  BRIDGET HARDT v. RELIANCE STANDARD LIFE INSURANCE COMPANY
 5771  UNITED STATES v. GLENN MARCUS
 4438  JOHN ROBERTSON v. UNITED STATES ex rel. WYKENNA WATSON
 8687  LAWRENCE JOSEPH JEFFERSON v. STEPHEN UPTON, WARDEN
10645  MOHAMED ALI SAMANTAR v. BASHE ABDI YOUSUF et al.
17847  MARY BERGHUIS, WARDEN v. VAN CHESTER THOMPKINS
10183  RICHARD A. LEVIN, TAX COMMISSIONER OF OHIO v. COMMERCE ENERGY, INC., et al.
15010  THOMAS CARR v. UNITED STATES
12933  MICHAEL GARY BARBER, et al. v. J. E. THOMAS, WARDEN
13676  JAN HAMILTON, CHAPTER 13 TRUSTEE v. STEPHANIE KAY LANNING
 8312  WANDA KRUPSKI v. COSTA CROCIERE S. P. A.
 9987  JOSE ANGEL CARACHURI-ROSENDO v. ERIC H. HOLDER, JR., ATTORNEY GENERAL
 8029  MICHAEL J. ASTRUE, COMMISSIONER OF SOCIAL SECURITY v. CATHERINE G. RATLIFF
10821  BRIAN RUSSELL DOLAN v. UNITED STATES
17847  ALBERT HOLLAND v. FLORIDA
11172  NEW PROCESS STEEL, L. P. v. NATIONAL LABOR RELATIONS BOARD
18022  STOP THE BEACH RENOURISHMENT, INC. v. FLORIDA DEPARTMENT OF ENVIRONMENTAL PROTEC
 9320  CITY OF ONTARIO, CALIFORNIA, et al. v. JEFF QUON et al.
18128  WILLIAM G. SCHWAB v. NADEJDA REILLY
13554  PERCY DILLON v. UNITED STATES
25016  ERIC H. HOLDER, JR., ATTORNEY GENERAL, et al. v. HUMANITARIAN LAW PROJECT et al.
10471  RENT-A-CENTER, WEST, INC. v. ANTONIO JACKSON
20738  KAWASAKI KISEN KAISHA LTD. et al. v. REGAL-BELOIT CORP. et al.
18474  MONSANTO COMPANY, et al. v. GEERTSON SEED FARMS et al.
23994  JOHN DOE #1, et al. v. SAM REED, WASHINGTON SECRETARY OF STATE, et al.
16696  ROBERT MORRISON, et al. v. NATIONAL AUSTRALIA BANK LTD. et al.
14013  GRANITE ROCK COMPANY v. INTERNATIONAL BROTHERHOOD OF TEAMSTERS et al.
15751  BILLY JOE MAGWOOD v. TONY PATTERSON, WARDEN, et al.
48969  JEFFREY K. SKILLING v. UNITED STATES
 4629  CONRAD M. BLACK, JOHN A. BOULTBEE, AND MARK S. KIPNIS v. UNITED STATES
39727  FREE ENTERPRISE FUND AND BECKSTEAD AND WATTS, LLP v. PUBLIC COMPANY ACCOUNTING O
29263  BERNARD L. BILSKI AND RAND A. WARSAW v. DAVID J. KAPPOS, UNDER SECRETARY OF COMM
33725  CHRISTIAN LEGAL SOCIETY CHAPTER OF THE UNIVERSITY OF CALIFORNIA, HASTINGS COLLEG
87587  OTIS MCDONALD, et al. v. CITY OF CHICAGO, ILLINOIS, et al.
 8126  DEMARCUS ALI SEARS v. STEPHEN UPTON, WARDEN
 2242  BILL K. WILSON, SUPERINTENDENT, INDIANA STATE PRISON, PETITIONER v. JOSEPH E. CO
 8986  KEVIN ABBOTT, PETITIONER v. UNITED STATES
 4244  LOS ANGELES COUNTY, CALIFORNIA, PETITIONER v. CRAIG ARTHUR HUMPHRIES et al.
   29  COSTCO WHOLESALE CORPORATION, PETITIONER v. OMEGA, S.A.
10250  KEITH SMITH, WARDEN v. FRANK G. SPISAK, JR.
</pre></div>
</div>
</div>
</div>
<p>We’ll re-chunk the texts into documents of not more than 500 words and then recompute the document-term matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunked_corpus_unflattened</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">text</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">500</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="mi">500</span><span class="p">)]</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">tokenized_corpus</span>
<span class="p">]</span>
<span class="n">chunked_corpus</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">chunked_corpus_unflattened</span><span class="p">))</span>
<span class="n">chunked_dtm</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">chunked_corpus</span><span class="p">)</span>
<span class="n">chunked_dtm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;1006x500 sparse matrix of type &#39;&lt;class &#39;numpy.int32&#39;&gt;&#39;
	with 91636 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textacy.tm</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">textacy</span><span class="o">.</span><span class="n">tm</span><span class="o">.</span><span class="n">TopicModel</span><span class="p">(</span><span class="s2">&quot;lda&quot;</span><span class="p">,</span> <span class="n">n_topics</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">chunked_dtm</span><span class="p">)</span>
<span class="n">doc_topic_matrix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">chunked_dtm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">topic_idx</span><span class="p">,</span> <span class="n">top_terms</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">top_topic_terms</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">id_to_term</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">topic_idx</span><span class="si">:</span><span class="s2"> &gt;2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">topic_weights</span><span class="p">(</span><span class="n">doc_topic_matrix</span><span class="p">)[</span><span class="n">topic_idx</span><span class="p">]</span><span class="si">:</span><span class="s2"> &gt;3.0%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">top_terms</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 0  8% | right, rights, Clause, States, Justice, state, Amendment, bear, Constitution, law
 1  4% | fees, carrier, party, attorney, fee, award, services, filed, $, Rule
 2  4% | rights, child, right, Convention, State, custody, Ann, States, Stat, A.
 3  4% | debtor, income, value, felony, delay, time, claimed, Code, property, exempt
 4  8% | sentence, sentencing, time, life, habeas, year, State, federal, years, application
 5  5% | counsel, attorney, Miranda, state, suspect, interrogation, police, right, evidence, advice
 6  1% | business, Director, Office, General, place, corporation, patent, Fed, method, State
 7  4% | Footnote, arbitration, agreement, parties, contract, dispute, clause, Inc., question, Brief
 8  6% | process, petition, disclosure, plaintiffs, challenge, test, applied, referendum, claim, State
 9 11% | Amendment, speech, Hastings, J., public, political, interest, policy, Government, corporations
10  9% | jury, trial, Id., jurors, d., evidence, District, App, judge, reasonable
11 11% | Congress, Board, States, United, statute, power, Act, Commission, authority, foreign
12  8% | F., United, States, 3d, statute, Congress, law, error, criminal, conduct
13 12% | state, federal, law, courts, Act, action, class, Rule, claims, City
14  3% | cross, debt, District, injunction, relief, land, transfer, Government, bankruptcy, agency
</pre></div>
</div>
</div>
</div>
</section>
<section id="document-similarity-with-word2vec-and-clustering">
<h2>Document similarity with word2vec and clustering<a class="headerlink" href="#document-similarity-with-word2vec-and-clustering" title="Permalink to this heading">#</a></h2>
<p>spaCy and textacy provide several built-in methods for measuring the degree of similarity between two documents, including a <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>-based approach that computes the semantic similarity between documents based on the word vector model included with the spaCy language model. This technique is capable of inferring, for example, that two documents are topically related even if they don’t share any words but use synonyms for a shared concept.</p>
<p>To evaluate this similarity comparison, we’ll compute the similarity of each pair of docs in the corpus, and then branch out into <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> a bit to look for clusters based on these similarity measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dim</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">n_docs</span>

<span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span><span class="n">dim</span><span class="p">))</span>
    
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">doc_j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
            <span class="k">continue</span> <span class="c1"># defaults to 0</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">distance_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">distance_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">doc_i</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">doc_j</span><span class="p">)</span>
<span class="n">distance_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.00428384, 0.00913359, ..., 0.0036863 , 0.05862846,
        0.00781636],
       [0.00428384, 0.        , 0.00910768, ..., 0.00630599, 0.05399509,
        0.0058778 ],
       [0.00913359, 0.00910768, 0.        , ..., 0.00614726, 0.04253501,
        0.00566709],
       ...,
       [0.0036863 , 0.00630599, 0.00614726, ..., 0.        , 0.05483739,
        0.00724887],
       [0.05862846, 0.05399509, 0.04253501, ..., 0.05483739, 0.        ,
        0.04504147],
       [0.00781636, 0.0058778 , 0.00566709, ..., 0.00724887, 0.04504147,
        0.        ]])
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.OPTICS.html">OPTICS</a> hierarchical density-based clustering algorithm only finds one cluster with its default settings, but an examination of the legal issue types coded to each decision indicates that the <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>-based clustering has indeed produced a group of semantically related documents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">OPTICS</span>

<span class="n">clustering</span> <span class="o">=</span> <span class="n">OPTICS</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;precomputed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1  0 -1 -1  1 -1 -1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0 -1  0 -1 -1 -1
 -1  1 -1 -1 -1  0 -1 -1 -1 -1  0 -1 -1 -1 -1 -1  1 -1 -1  0  1 -1 -1 -1
 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0 -1 -1 -1  0  0 -1 -1  1 -1 -1 -1  0
  0  1 -1 -1 -1 -1  1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">groupby</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">groupby</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">labels_</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">cluster_label</span><span class="p">,</span> <span class="n">docs</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
    
    <span class="k">if</span> <span class="n">cluster_label</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">cluster_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">corpus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;us_cite_id&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> &lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">issue_area_codes</span><span class="p">[</span><span class="n">corpus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;issue_area&#39;</span><span class="p">]]</span><span class="si">:</span><span class="s2"> &lt;18</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot; | </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">issue_codes</span><span class="p">[</span><span class="n">corpus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;issue&#39;</span><span class="p">]][:</span><span class="mi">60</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">docs</span>
    <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster 0 
---------
558 U.S. 310 | First Amendment    | campaign spending (cf. governmental corruption):
559 U.S. 393 | Judicial Power     | Federal Rules of Civil Procedure including Supreme Court Rul
559 U.S. 335 | Economic Activity  | federal or state regulation of securities
559 U.S. 573 | Civil Rights       | debtors&#39; rights
560 U.S. 126 | Federalism         | national supremacy: miscellaneous
560 U.S. 305 | Economic Activity  | liability, other than as in sufficiency of evidence, electio
561 U.S. 1   | First Amendment    | federal or state internal security legislation: Smith, Inter
561 U.S. 186 | Privacy            | Freedom of Information Act and related federal or state stat
561 U.S. 247 | Economic Activity  | federal or state regulation of securities
561 U.S. 661 | First Amendment    | free exercise of religion
561 U.S. 742 | Criminal Procedure | miscellaneous criminal procedure (cf. due process, prisoners



Cluster 1 
---------
558 U.S. 220 | Criminal Procedure | discovery and inspection (in the context of criminal litigat
559 U.S. 98  | Criminal Procedure | Miranda warnings
559 U.S. 766 | Criminal Procedure | habeas corpus
560 U.S. 258 | Criminal Procedure | Federal Rules of Criminal Procedure
560 U.S. 370 | Criminal Procedure | Miranda warnings
561 U.S. 358 | Criminal Procedure | statutory construction of criminal laws: fraud
561 U.S. 945 | Criminal Procedure | right to counsel (cf. indigents appointment of counsel or in
558 U.S. 139 | Criminal Procedure | cruel and unusual punishment, death penalty (cf. extra legal
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;assyrian&#39;,
 &#39;monarchs&#39;,
 &#39;especially&#39;,
 &#39;sardanapalus&#39;,
 &#39;babylon&#39;,
 &#39;scene&#39;,
 &#39;great&#39;,
 &#39;intellectual&#39;,
 &#39;activity&#39;,
 &#39;sardanapalus&#39;,
 &#39;assyrian&#39;,
 &#39;babylon&#39;,
 &#39;ized&#39;,
 &#39;library&#39;,
 &#39;library&#39;,
 &#39;paper&#39;,
 &#39;clay&#39;,
 &#39;tablets&#39;,
 &#39;writing&#39;,
 &#39;mesopotamia&#39;,
 &#39;early&#39;,
 &#39;sumerian&#39;,
 &#39;days&#39;,
 &#39;collection&#39;,
 &#39;unearthed&#39;,
 &#39;precious&#39;,
 &#39;store&#39;,
 &#39;historical&#39;,
 &#39;material&#39;,
 &#39;world&#39;,
 &#39;chaldean&#39;,
 &#39;line&#39;,
 &#39;babylonian&#39;,
 &#39;monarchs&#39;,
 &#39;nabonidus&#39;,
 &#39;keener&#39;,
 &#39;literary&#39;,
 &#39;tastes&#39;,
 &#39;patronized&#39;,
 &#39;antiquarian&#39;,
 &#39;researches&#39;,
 &#39;date&#39;,
 &#39;worked&#39;,
 &#39;investigators&#39;,
 &#39;accession&#39;,
 &#39;sargon&#39;,
 &#39;commemorated&#39;,
 &#39;fact&#39;,
 &#39;inscriptions&#39;,
 &#39;signs&#39;,
 &#39;disunion&#39;,
 &#39;empire&#39;,
 &#39;sought&#39;,
 &#39;centralize&#39;,
 &#39;bringing&#39;,
 &#39;number&#39;,
 &#39;local&#39;,
 &#39;gods&#39;,
 &#39;babylon&#39;,
 &#39;setting&#39;,
 &#39;temples&#39;,
 &#39;device&#39;,
 &#39;practised&#39;,
 &#39;successfully&#39;,
 &#39;romans&#39;,
 &#39;later&#39;,
 &#39;times&#39;,
 &#39;babylon&#39;,
 &#39;roused&#39;,
 &#39;jealousy&#39;,
 &#39;powerful&#39;,
 &#39;priesthood&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;dominant&#39;,
 &#39;god&#39;,
 &#39;babylonians&#39;,
 &#39;cast&#39;,
 &#39;possible&#39;,
 &#39;alternative&#39;,
 &#39;nabonidus&#39;,
 &#39;found&#39;,
 &#39;cyrus&#39;,
 &#39;persian&#39;,
 &#39;ruler&#39;,
 &#39;adjacent&#39;,
 &#39;median&#39;,
 &#39;empire&#39;,
 &#39;cyrus&#39;,
 &#39;distinguished&#39;,
 &#39;conquering&#39;,
 &#39;croesus&#39;,
 &#39;rich&#39;,
 &#39;king&#39;,
 &#39;lydia&#39;,
 &#39;eastern&#39;,
 &#39;asia&#39;,
 &#39;minor&#39;,
 &#39;came&#39;,
 &#39;babylon&#39;,
 &#39;battle&#39;,
 &#39;outside&#39;,
 &#39;walls&#39;,
 &#39;gates&#39;,
 &#39;city&#39;,
 &#39;opened&#39;,
 &#39;soldiers&#39;,
 &#39;entered&#39;,
 &#39;city&#39;,
 &#39;fighting&#39;,
 &#39;crown&#39;,
 &#39;prince&#39;,
 &#39;belshazzar&#39;,
 &#39;son&#39;,
 &#39;nabonidus&#39;,
 &#39;feasting&#39;,
 &#39;bible&#39;,
 &#39;relates&#39;,
 &#39;hand&#39;,
 &#39;appeared&#39;,
 &#39;wrote&#39;,
 &#39;letters&#39;,
 &#39;fire&#39;,
 &#39;wall&#39;,
 &#39;mystical&#39;,
 &#39;words&#39;,
 &#39;mene&#39;,
 &#39;mene&#39;,
 &#39;tekel&#39;,
 &#39;upharsin&#39;,
 &#39;interpreted&#39;,
 &#39;prophet&#39;,
 &#39;daniel&#39;,
 &#39;summoned&#39;,
 &#39;read&#39;,
 &#39;riddle&#39;,
 &#39;god&#39;,
 &#39;numbered&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;finished&#39;,
 &#39;thou&#39;,
 &#39;art&#39;,
 &#39;weighed&#39;,
 &#39;balance&#39;,
 &#39;found&#39;,
 &#39;wanting&#39;,
 &#39;thy&#39;,
 &#39;kingdom&#39;,
 &#39;given&#39;,
 &#39;medes&#39;,
 &#39;persians&#39;,
 &#39;possibly&#39;,
 &#39;priests&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;knew&#39;,
 &#39;writing&#39;,
 &#39;wall&#39;,
 &#39;belshazzar&#39;,
 &#39;killed&#39;,
 &#39;night&#39;,
 &#39;says&#39;,
 &#39;bible&#39;,
 &#39;nabonidus&#39;,
 &#39;taken&#39;,
 &#39;prisoner&#39;,
 &#39;occupation&#39;,
 &#39;city&#39;,
 &#39;peaceful&#39;,
 &#39;services&#39;,
 &#39;bel&#39;,
 &#39;marduk&#39;,
 &#39;continued&#39;,
 &#39;intermission&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<ol class="simple">
<li><p>Filter the tokens from the HG Well’s <code class="docutils literal notranslate"><span class="pre">text</span></code> variable to 1) lowercase all text, 2) remove punctuation, 3) remove spaces and line breaks, 4) remove numbers, and 5) remove stopwords - all in one line!</p></li>
<li><p>Read through the spacy101 guide and begin to apply its principles to your own corpus: <a class="reference external" href="https://spacy.io/usage/spacy-101">https://spacy.io/usage/spacy-101</a></p></li>
</ol>
</section>
<section id="topic-modeling-going-further">
<h2>Topic modeling - going further<a class="headerlink" href="#topic-modeling-going-further" title="Permalink to this heading">#</a></h2>
<p>There are many different approaches to modeling abstract topics in text data, such as <a class="reference external" href="https://github.com/ddangelov/Top2Vec">top2vec</a> and <a class="reference external" href="https://github.com/cemoody/lda2vec">lda2vec</a>.</p>
<p>Click ahead to see our coverage of the BERTopic algorithm in Chapter 10!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "EastBayEv/SSDS-TAML",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./spring2023"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="7_English_text_preprocessing_basics_applications.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Chapter 7 - English text preprocessing basics - and applications</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="9_BERTopic.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 9 - New Developments: Topic Modeling with BERTopic!</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Software and Services for Data Science (SSDS), Stanford University<br/>
  
      &copy; Copyright 2021-2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>