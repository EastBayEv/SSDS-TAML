
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 5 - Ensemble machine learning, deep learning &#8212; Text Analysis and Machine Learning (TAML) Group</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 6 - Writing about numeric data" href="Chapter6.html" />
    <link rel="prev" title="Chapter 4 - The BERT algorithm" href="Chapter4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Text Analysis and Machine Learning (TAML) Group</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to TAML!
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="how_to.html">
   i. How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="start.html">
   ii. Start coding!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boiler.html">
   iii. Boilerplate code review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrangle.html">
   iv. Numeric data wrangling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="viz.html">
   v. Visualization essentials
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Winter Quarter 2022
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter1.html">
   Chapter 1 - English text preprocessing basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter2.html">
   Chapter 2 - Core machine learning concepts; building text vocabularies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter3.html">
   Chapter 3 - Document encoding (TF-IDF), topic modeling, sentiment analysis, building text classifiers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter4.html">
   Chapter 4 - The BERT algorithm
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 5 - Ensemble machine learning, deep learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter6.html">
   Chapter 6 - Writing about numeric data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter7.html">
   Chapter 7 - Combine the basics in powerful ways!
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="resources.html">
   Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Launch JupyterLab in Binder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Guest_Speakers.html">
   Guest Speakers
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/winter2022/Chapter5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/EastBayEv/SSDS-TAML"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/EastBayEv/SSDS-TAML/issues/new?title=Issue%20on%20page%20%2Fwinter2022/Chapter5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/EastBayEv/SSDS-TAML/master?urlpath=tree/winter2022/Chapter5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensemble-machine-learning">
   Ensemble machine learning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#h2o-superlearner-ensemble">
   H2O SuperLearner ensemble
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deep-learning-basics">
   Deep learning basics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-makes-a-network-deep">
   What makes a network “deep”?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-5-ensemble-machine-learning-deep-learning">
<h1>Chapter 5 - Ensemble machine learning, deep learning<a class="headerlink" href="#chapter-5-ensemble-machine-learning-deep-learning" title="Permalink to this headline">¶</a></h1>
<p>2022 February 23</p>
<p><img alt="kandc" src="../_images/kandc.jpg" /></p>
<p><a class="reference external" href="https://www.texasmonthly.com/the-daily-post/music-monday-uncovering-the-mystery-of-the-king-carter-jazzing-orchestra/">Texas Monthly, Music Monday: Uncovering The Mystery Of The King &amp; Carter Jazzing Orchestra</a></p>
<section id="ensemble-machine-learning">
<h2>Ensemble machine learning<a class="headerlink" href="#ensemble-machine-learning" title="Permalink to this headline">¶</a></h2>
<p>“Ensemble machine learning methods use multiple learning algorithms to obtain better predictive performance than could be obtained from any of the constituent learning algorithms.” <a class="reference external" href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html">H2O.ai ensemble example</a></p>
<p>In this manner, SuperLearner ensembles are powerful tools because they:</p>
<ul class="simple">
<li><p>elucidate issues of algorithmic bias and variance</p></li>
<li><p>circumvent bias introduced by selecting single models</p></li>
<li><p>offer a means to optimize prediction through the stacking/blending of weaker models</p></li>
<li><p>allow for comparison of multiple algorithms, and/or comparison of the same model but tuned in many different ways</p></li>
<li><p>utilize a second-level algorithm that produces an ideal weighted prediction that is suitable for data of virtually all distributions and uses cross-validation to prevent overfitting</p></li>
</ul>
<p>The below example utilizes the h2o package, and requires Java to be installed on your machine.</p>
<ul class="simple">
<li><p>install Java: <a class="reference external" href="https://www.java.com/en/download/help/mac_install.html">https://www.java.com/en/download/help/mac_install.html</a></p></li>
<li><p>h2o SuperLearner example: <a class="reference external" href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html">https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html</a></p></li>
</ul>
<p>Check out some other great tutorials:</p>
<ul class="simple">
<li><p>Python mlens library: <a class="reference external" href="https://mlens.readthedocs.io/en/0.1.x/install/">https://mlens.readthedocs.io/en/0.1.x/install/</a></p></li>
<li><p>Machine Learning Mastery: <a class="reference external" href="https://machinelearningmastery.com/super-learner-ensemble-in-python/">https://machinelearningmastery.com/super-learner-ensemble-in-python/</a></p></li>
<li><p>KDNuggets: <a class="reference external" href="https://www.kdnuggets.com/2018/02/introduction-python-ensembles.html/2#comments">https://www.kdnuggets.com/2018/02/introduction-python-ensembles.html/2#comments</a></p></li>
</ul>
<p>The quintessential R guide:</p>
<ul class="simple">
<li><p>Guide to SuperLearner: <a class="reference external" href="https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html">https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html</a></p></li>
</ul>
<p>Read the papers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.degruyter.com/document/doi/10.2202/1544-6115.1309/html">Van der Laan, M.J.; Polley, E.C.; Hubbard, A.E. Super Learner. Stat. Appl. Genet. Mol. Biol. 2007, 6, 1–21.</a></p></li>
<li><p><a class="reference external" href="https://biostats.bepress.com/ucbbiostat/paper266">Polley, E.C.; van der Laan, M.J. Super Learner in Prediction, UC Berkeley Division of Biostatistics Working Paper Series Paper 266.</a></p></li>
</ul>
</section>
<section id="h2o-superlearner-ensemble">
<h2>H2O SuperLearner ensemble<a class="headerlink" href="#h2o-superlearner-ensemble" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install h2o</span>

<span class="c1"># Requires install of Java</span>
<span class="c1"># https://www.java.com/en/download/help/mac_install.html</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.random_forest</span> <span class="kn">import</span> <span class="n">H2ORandomForestEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.gbm</span> <span class="kn">import</span> <span class="n">H2OGradientBoostingEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.stackedensemble</span> <span class="kn">import</span> <span class="n">H2OStackedEnsembleEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.grid.grid_search</span> <span class="kn">import</span> <span class="n">H2OGridSearch</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="n">h2o</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Checking whether there is an H2O instance running at http://localhost:54321 .
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> not found.
Attempting to start a local H2O server...
  Java Version: java version &quot;1.8.0_321&quot;; Java(TM) SE Runtime Environment (build 1.8.0_321-b07); Java HotSpot(TM) 64-Bit Server VM (build 25.321-b07, mixed mode)
  Starting server from /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages/h2o/backend/bin/h2o.jar
  Ice root: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpo4k3y_az
  JVM stdout: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpo4k3y_az/h2o_evanmuzzall_started_from_python.out
  JVM stderr: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpo4k3y_az/h2o_evanmuzzall_started_from_python.err
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> successful.
Warning: Your H2O cluster version is too old (5 months and 8 days)!Please download and install the latest version from http://h2o.ai/download/
</pre></div>
</div>
<div class="output text_html"><div style="overflow:auto"><table style="width:50%"><tr><td>H2O_cluster_uptime:</td>
<td>04 secs</td></tr>
<tr><td>H2O_cluster_timezone:</td>
<td>America/Los_Angeles</td></tr>
<tr><td>H2O_data_parsing_timezone:</td>
<td>UTC</td></tr>
<tr><td>H2O_cluster_version:</td>
<td>3.34.0.1</td></tr>
<tr><td>H2O_cluster_version_age:</td>
<td>5 months and 8 days !!!</td></tr>
<tr><td>H2O_cluster_name:</td>
<td>H2O_from_python_evanmuzzall_hmzupn</td></tr>
<tr><td>H2O_cluster_total_nodes:</td>
<td>1</td></tr>
<tr><td>H2O_cluster_free_memory:</td>
<td>3.556 Gb</td></tr>
<tr><td>H2O_cluster_total_cores:</td>
<td>16</td></tr>
<tr><td>H2O_cluster_allowed_cores:</td>
<td>16</td></tr>
<tr><td>H2O_cluster_status:</td>
<td>locked, healthy</td></tr>
<tr><td>H2O_connection_url:</td>
<td>http://127.0.0.1:54321</td></tr>
<tr><td>H2O_connection_proxy:</td>
<td>{"http": null, "https": null}</td></tr>
<tr><td>H2O_internal_security:</td>
<td>False</td></tr>
<tr><td>H2O_API_Extensions:</td>
<td>Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4</td></tr>
<tr><td>Python_version:</td>
<td>3.8.8 final</td></tr></table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import a sample binary outcome train/test set into H2O</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://s3.amazonaws.com/erin-data/higgs/higgs_train_10k.csv&quot;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://s3.amazonaws.com/erin-data/higgs/higgs_test_5k.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parse progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>██████| (done) 100%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parse progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>███████████████████████| (done) 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">  response</th><th style="text-align: right;">      x1</th><th style="text-align: right;">       x2</th><th style="text-align: right;">         x3</th><th style="text-align: right;">      x4</th><th style="text-align: right;">       x5</th><th style="text-align: right;">      x6</th><th style="text-align: right;">        x7</th><th style="text-align: right;">        x8</th><th style="text-align: right;">     x9</th><th style="text-align: right;">     x10</th><th style="text-align: right;">      x11</th><th style="text-align: right;">      x12</th><th style="text-align: right;">    x13</th><th style="text-align: right;">     x14</th><th style="text-align: right;">       x15</th><th style="text-align: right;">      x16</th><th style="text-align: right;">    x17</th><th style="text-align: right;">     x18</th><th style="text-align: right;">       x19</th><th style="text-align: right;">        x20</th><th style="text-align: right;">    x21</th><th style="text-align: right;">     x22</th><th style="text-align: right;">     x23</th><th style="text-align: right;">     x24</th><th style="text-align: right;">     x25</th><th style="text-align: right;">     x26</th><th style="text-align: right;">     x27</th><th style="text-align: right;">     x28</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.869293</td><td style="text-align: right;">-0.635082</td><td style="text-align: right;"> 0.22569   </td><td style="text-align: right;">0.32747 </td><td style="text-align: right;">-0.689993</td><td style="text-align: right;">0.754202</td><td style="text-align: right;">-0.248573 </td><td style="text-align: right;">-1.09206  </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.37499 </td><td style="text-align: right;">-0.653674</td><td style="text-align: right;"> 0.930349</td><td style="text-align: right;">1.10744</td><td style="text-align: right;">1.1389  </td><td style="text-align: right;">-1.5782   </td><td style="text-align: right;">-1.04699 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.65793 </td><td style="text-align: right;">-0.0104546</td><td style="text-align: right;">-0.0457672 </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">1.35376 </td><td style="text-align: right;">0.979563</td><td style="text-align: right;">0.978076</td><td style="text-align: right;">0.920005</td><td style="text-align: right;">0.721657</td><td style="text-align: right;">0.988751</td><td style="text-align: right;">0.876678</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.907542</td><td style="text-align: right;"> 0.329147</td><td style="text-align: right;"> 0.359412  </td><td style="text-align: right;">1.49797 </td><td style="text-align: right;">-0.31301 </td><td style="text-align: right;">1.09553 </td><td style="text-align: right;">-0.557525 </td><td style="text-align: right;">-1.58823  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.812581</td><td style="text-align: right;">-0.213642</td><td style="text-align: right;"> 1.27101 </td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.499994</td><td style="text-align: right;">-1.26143  </td><td style="text-align: right;"> 0.732156</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.398701</td><td style="text-align: right;">-1.13893  </td><td style="text-align: right;">-0.00081911</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.30222 </td><td style="text-align: right;">0.833048</td><td style="text-align: right;">0.9857  </td><td style="text-align: right;">0.978098</td><td style="text-align: right;">0.779732</td><td style="text-align: right;">0.992356</td><td style="text-align: right;">0.798343</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.798835</td><td style="text-align: right;"> 1.47064 </td><td style="text-align: right;">-1.63597   </td><td style="text-align: right;">0.453773</td><td style="text-align: right;"> 0.425629</td><td style="text-align: right;">1.10487 </td><td style="text-align: right;"> 1.28232  </td><td style="text-align: right;"> 1.38166  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.851737</td><td style="text-align: right;"> 1.54066 </td><td style="text-align: right;">-0.81969 </td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.99349 </td><td style="text-align: right;"> 0.35608  </td><td style="text-align: right;">-0.208778</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.25695 </td><td style="text-align: right;"> 1.12885  </td><td style="text-align: right;"> 0.900461  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.909753</td><td style="text-align: right;">1.10833 </td><td style="text-align: right;">0.985692</td><td style="text-align: right;">0.951331</td><td style="text-align: right;">0.803252</td><td style="text-align: right;">0.865924</td><td style="text-align: right;">0.780118</td></tr>
<tr><td style="text-align: right;">         0</td><td style="text-align: right;">1.34438 </td><td style="text-align: right;">-0.876626</td><td style="text-align: right;"> 0.935913  </td><td style="text-align: right;">1.99205 </td><td style="text-align: right;"> 0.882454</td><td style="text-align: right;">1.78607 </td><td style="text-align: right;">-1.64678  </td><td style="text-align: right;">-0.942383 </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.42326 </td><td style="text-align: right;">-0.676016</td><td style="text-align: right;"> 0.736159</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">1.29872 </td><td style="text-align: right;">-1.43074  </td><td style="text-align: right;">-0.364658</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.745313</td><td style="text-align: right;">-0.678379 </td><td style="text-align: right;">-1.36036   </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.946652</td><td style="text-align: right;">1.0287  </td><td style="text-align: right;">0.998656</td><td style="text-align: right;">0.728281</td><td style="text-align: right;">0.8692  </td><td style="text-align: right;">1.02674 </td><td style="text-align: right;">0.957904</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.10501 </td><td style="text-align: right;"> 0.321356</td><td style="text-align: right;"> 1.5224    </td><td style="text-align: right;">0.882808</td><td style="text-align: right;">-1.20535 </td><td style="text-align: right;">0.681466</td><td style="text-align: right;">-1.07046  </td><td style="text-align: right;">-0.921871 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.800872</td><td style="text-align: right;"> 1.02097 </td><td style="text-align: right;"> 0.971407</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.596761</td><td style="text-align: right;">-0.350273 </td><td style="text-align: right;"> 0.631194</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.479999</td><td style="text-align: right;">-0.373566 </td><td style="text-align: right;"> 0.113041  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.755856</td><td style="text-align: right;">1.36106 </td><td style="text-align: right;">0.98661 </td><td style="text-align: right;">0.838085</td><td style="text-align: right;">1.1333  </td><td style="text-align: right;">0.872245</td><td style="text-align: right;">0.808487</td></tr>
<tr><td style="text-align: right;">         0</td><td style="text-align: right;">1.59584 </td><td style="text-align: right;">-0.607811</td><td style="text-align: right;"> 0.00707492</td><td style="text-align: right;">1.81845 </td><td style="text-align: right;">-0.111906</td><td style="text-align: right;">0.84755 </td><td style="text-align: right;">-0.566437 </td><td style="text-align: right;"> 1.58124  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.755421</td><td style="text-align: right;"> 0.64311 </td><td style="text-align: right;"> 1.42637 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.921661</td><td style="text-align: right;">-1.19043  </td><td style="text-align: right;">-1.61559 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.651114</td><td style="text-align: right;">-0.654227 </td><td style="text-align: right;">-1.27434   </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">0.823761</td><td style="text-align: right;">0.938191</td><td style="text-align: right;">0.971758</td><td style="text-align: right;">0.789176</td><td style="text-align: right;">0.430553</td><td style="text-align: right;">0.961357</td><td style="text-align: right;">0.957818</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.409391</td><td style="text-align: right;">-1.88468 </td><td style="text-align: right;">-1.02729   </td><td style="text-align: right;">1.67245 </td><td style="text-align: right;">-1.6046  </td><td style="text-align: right;">1.33801 </td><td style="text-align: right;"> 0.0554274</td><td style="text-align: right;"> 0.0134659</td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.509783</td><td style="text-align: right;">-1.03834 </td><td style="text-align: right;"> 0.707862</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.746918</td><td style="text-align: right;">-0.358465 </td><td style="text-align: right;">-1.64665 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.367058</td><td style="text-align: right;"> 0.0694965</td><td style="text-align: right;"> 1.37713   </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">0.869418</td><td style="text-align: right;">1.22208 </td><td style="text-align: right;">1.00063 </td><td style="text-align: right;">0.545045</td><td style="text-align: right;">0.698653</td><td style="text-align: right;">0.977314</td><td style="text-align: right;">0.828786</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.933895</td><td style="text-align: right;"> 0.62913 </td><td style="text-align: right;"> 0.527535  </td><td style="text-align: right;">0.238033</td><td style="text-align: right;">-0.966569</td><td style="text-align: right;">0.547811</td><td style="text-align: right;">-0.0594392</td><td style="text-align: right;">-1.70687  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.941003</td><td style="text-align: right;">-2.65373 </td><td style="text-align: right;">-0.15722 </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.03037 </td><td style="text-align: right;">-0.175505 </td><td style="text-align: right;"> 0.523021</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.37355 </td><td style="text-align: right;"> 1.29125  </td><td style="text-align: right;">-1.46745   </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.901837</td><td style="text-align: right;">1.08367 </td><td style="text-align: right;">0.979696</td><td style="text-align: right;">0.7833  </td><td style="text-align: right;">0.849195</td><td style="text-align: right;">0.894356</td><td style="text-align: right;">0.774879</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.40514 </td><td style="text-align: right;"> 0.536603</td><td style="text-align: right;"> 0.689554  </td><td style="text-align: right;">1.17957 </td><td style="text-align: right;">-0.110061</td><td style="text-align: right;">3.2024  </td><td style="text-align: right;">-1.52696  </td><td style="text-align: right;">-1.57603  </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.93154 </td><td style="text-align: right;"> 0.567342</td><td style="text-align: right;">-0.130033</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">1.78712 </td><td style="text-align: right;"> 0.899499 </td><td style="text-align: right;"> 0.585151</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">0.401865</td><td style="text-align: right;">-0.151202 </td><td style="text-align: right;"> 1.16349   </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.66707 </td><td style="text-align: right;">4.03927 </td><td style="text-align: right;">1.17583 </td><td style="text-align: right;">1.04535 </td><td style="text-align: right;">1.54297 </td><td style="text-align: right;">3.53483 </td><td style="text-align: right;">2.74075 </td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.17657 </td><td style="text-align: right;"> 0.104161</td><td style="text-align: right;"> 1.397     </td><td style="text-align: right;">0.479721</td><td style="text-align: right;"> 0.265513</td><td style="text-align: right;">1.13556 </td><td style="text-align: right;"> 1.53483  </td><td style="text-align: right;">-0.253291 </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.02725 </td><td style="text-align: right;"> 0.534316</td><td style="text-align: right;"> 1.18002 </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.40566 </td><td style="text-align: right;"> 0.0875568</td><td style="text-align: right;">-0.976534</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.25038 </td><td style="text-align: right;"> 0.268541 </td><td style="text-align: right;"> 0.530334  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.833175</td><td style="text-align: right;">0.773968</td><td style="text-align: right;">0.98575 </td><td style="text-align: right;">1.1037  </td><td style="text-align: right;">0.84914 </td><td style="text-align: right;">0.937104</td><td style="text-align: right;">0.812364</td></tr>
</tbody>
</table></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10000, 29)
(5000, 29)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify predictors and response</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;response&quot;</span>
<span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For binary classification, response should be a factor</span>
<span class="n">train</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of CV folds (to generate level-one data for stacking)</span>
<span class="n">nfolds</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There are a few ways to assemble a list of models to stack together:</span>
<span class="c1"># 1. Train individual models and put them in a list</span>
<span class="c1"># 2. Train a grid of models</span>
<span class="c1"># 3. Train several grids of models</span>
<span class="c1"># Note: All base models must have the same cross-validation folds and</span>
<span class="c1"># the cross-validated predicted values must be kept.</span>


<span class="c1"># 1. Generate a 2-model ensemble (GBM + RF)</span>

<span class="c1"># Train and cross-validate a GBM</span>
<span class="n">my_gbm</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="s2">&quot;bernoulli&quot;</span><span class="p">,</span>
                                      <span class="n">ntrees</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                      <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">min_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                      <span class="n">learn_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                      <span class="n">nfolds</span><span class="o">=</span><span class="n">nfolds</span><span class="p">,</span>
                                      <span class="n">fold_assignment</span><span class="o">=</span><span class="s2">&quot;Modulo&quot;</span><span class="p">,</span>
                                      <span class="n">keep_cross_validation_predictions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">my_gbm</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Model Build progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>████████████████████████████████████████████| (done) 100%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2OGradientBoostingEstimator :  Gradient Boosting Machine
Model Key:  GBM_model_python_1645647168083_1


Model Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1579.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on train data. **

MSE: 0.20052170746266884
RMSE: 0.44779650228945383
LogLoss: 0.5879177464092424
Mean Per-Class Error: 0.29613223631461116
AUC: 0.7735466157694937
AUCPR: 0.7909110775032231
Gini: 0.5470932315389874

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4424199442800167: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2433.0</td>
      <td>2272.0</td>
      <td>0.4829</td>
      <td>(2272.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>818.0</td>
      <td>4477.0</td>
      <td>0.1545</td>
      <td>(818.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>3251.0</td>
      <td>6749.0</td>
      <td>0.309</td>
      <td>(3090.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.442420</td>
      <td>0.743441</td>
      <td>244.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.335831</td>
      <td>0.858813</td>
      <td>324.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.542377</td>
      <td>0.726119</td>
      <td>166.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.507400</td>
      <td>0.704200</td>
      <td>192.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.790473</td>
      <td>0.973684</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.158255</td>
      <td>1.000000</td>
      <td>394.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.803933</td>
      <td>0.999575</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.519330</td>
      <td>0.407039</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.513347</td>
      <td>0.703507</td>
      <td>187.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.519330</td>
      <td>0.703868</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.803933</td>
      <td>4703.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.803933</td>
      <td>5245.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.116664</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.158255</td>
      <td>5295.000000</td>
      <td>394.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.803933</td>
      <td>0.999575</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.803933</td>
      <td>0.990557</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.116664</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.158255</td>
      <td>1.000000</td>
      <td>394.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.93 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0165</td>
      <td>0.788097</td>
      <td>1.831345</td>
      <td>1.831345</td>
      <td>0.969697</td>
      <td>0.794128</td>
      <td>0.969697</td>
      <td>0.794128</td>
      <td>0.030217</td>
      <td>0.030217</td>
      <td>83.134461</td>
      <td>83.134461</td>
      <td>0.029154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0309</td>
      <td>0.779039</td>
      <td>1.770538</td>
      <td>1.803008</td>
      <td>0.937500</td>
      <td>0.780161</td>
      <td>0.954693</td>
      <td>0.787619</td>
      <td>0.025496</td>
      <td>0.055713</td>
      <td>77.053824</td>
      <td>80.300766</td>
      <td>0.052737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0403</td>
      <td>0.769898</td>
      <td>1.727844</td>
      <td>1.785476</td>
      <td>0.914894</td>
      <td>0.776514</td>
      <td>0.945409</td>
      <td>0.785029</td>
      <td>0.016242</td>
      <td>0.071955</td>
      <td>72.784441</td>
      <td>78.547579</td>
      <td>0.067279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0520</td>
      <td>0.766379</td>
      <td>1.662591</td>
      <td>1.757827</td>
      <td>0.880342</td>
      <td>0.767629</td>
      <td>0.930769</td>
      <td>0.781114</td>
      <td>0.019452</td>
      <td>0.091407</td>
      <td>66.259090</td>
      <td>75.782669</td>
      <td>0.083756</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.1019</td>
      <td>0.733553</td>
      <td>1.680415</td>
      <td>1.719918</td>
      <td>0.889780</td>
      <td>0.746516</td>
      <td>0.910697</td>
      <td>0.764171</td>
      <td>0.083853</td>
      <td>0.175260</td>
      <td>68.041465</td>
      <td>71.991834</td>
      <td>0.155919</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1501</td>
      <td>0.703064</td>
      <td>1.586872</td>
      <td>1.677195</td>
      <td>0.840249</td>
      <td>0.720131</td>
      <td>0.888075</td>
      <td>0.750029</td>
      <td>0.076487</td>
      <td>0.251747</td>
      <td>58.687245</td>
      <td>67.719474</td>
      <td>0.216040</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.2100</td>
      <td>0.672701</td>
      <td>1.475547</td>
      <td>1.619677</td>
      <td>0.781302</td>
      <td>0.681960</td>
      <td>0.857619</td>
      <td>0.730613</td>
      <td>0.088385</td>
      <td>0.340132</td>
      <td>47.554706</td>
      <td>61.967714</td>
      <td>0.276583</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.3003</td>
      <td>0.631813</td>
      <td>1.294604</td>
      <td>1.521928</td>
      <td>0.685493</td>
      <td>0.653431</td>
      <td>0.805861</td>
      <td>0.707405</td>
      <td>0.116903</td>
      <td>0.457035</td>
      <td>29.460397</td>
      <td>52.192787</td>
      <td>0.333124</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.4003</td>
      <td>0.582373</td>
      <td>1.242682</td>
      <td>1.452169</td>
      <td>0.658000</td>
      <td>0.607055</td>
      <td>0.768923</td>
      <td>0.682336</td>
      <td>0.124268</td>
      <td>0.581303</td>
      <td>24.268178</td>
      <td>45.216866</td>
      <td>0.384704</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.5000</td>
      <td>0.519662</td>
      <td>1.102458</td>
      <td>1.382436</td>
      <td>0.583751</td>
      <td>0.552458</td>
      <td>0.732000</td>
      <td>0.656438</td>
      <td>0.109915</td>
      <td>0.691218</td>
      <td>10.245751</td>
      <td>38.243626</td>
      <td>0.406415</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.6000</td>
      <td>0.470374</td>
      <td>0.906516</td>
      <td>1.303116</td>
      <td>0.480000</td>
      <td>0.494559</td>
      <td>0.690000</td>
      <td>0.629458</td>
      <td>0.090652</td>
      <td>0.781870</td>
      <td>-9.348442</td>
      <td>30.311615</td>
      <td>0.386546</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.7004</td>
      <td>0.436366</td>
      <td>0.795684</td>
      <td>1.230377</td>
      <td>0.421315</td>
      <td>0.451070</td>
      <td>0.651485</td>
      <td>0.603887</td>
      <td>0.079887</td>
      <td>0.861756</td>
      <td>-20.431588</td>
      <td>23.037746</td>
      <td>0.342947</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.8000</td>
      <td>0.408689</td>
      <td>0.584017</td>
      <td>1.149906</td>
      <td>0.309237</td>
      <td>0.422132</td>
      <td>0.608875</td>
      <td>0.581258</td>
      <td>0.058168</td>
      <td>0.919924</td>
      <td>-41.598310</td>
      <td>14.990557</td>
      <td>0.254887</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.9009</td>
      <td>0.350489</td>
      <td>0.580236</td>
      <td>1.086103</td>
      <td>0.307235</td>
      <td>0.385621</td>
      <td>0.575092</td>
      <td>0.559347</td>
      <td>0.058546</td>
      <td>0.978470</td>
      <td>-41.976414</td>
      <td>8.610307</td>
      <td>0.164868</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>1.0000</td>
      <td>0.116664</td>
      <td>0.217253</td>
      <td>1.000000</td>
      <td>0.115035</td>
      <td>0.256620</td>
      <td>0.529500</td>
      <td>0.529347</td>
      <td>0.021530</td>
      <td>1.000000</td>
      <td>-78.274728</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on cross-validation data. **

MSE: 0.20591759601729728
RMSE: 0.4537814408030559
LogLoss: 0.5996635025616064
Mean Per-Class Error: 0.3109957762972908
AUC: 0.752800639024444
AUCPR: 0.7705701530928649
Gini: 0.5056012780488881

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4159392211190996: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1696.0</td>
      <td>3009.0</td>
      <td>0.6395</td>
      <td>(3009.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>538.0</td>
      <td>4757.0</td>
      <td>0.1016</td>
      <td>(538.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2234.0</td>
      <td>7766.0</td>
      <td>0.3547</td>
      <td>(3547.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.415939</td>
      <td>0.728428</td>
      <td>268.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.279109</td>
      <td>0.855982</td>
      <td>346.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.561962</td>
      <td>0.711702</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.517902</td>
      <td>0.688800</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.158348</td>
      <td>1.000000</td>
      <td>392.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.517902</td>
      <td>0.377372</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.515693</td>
      <td>0.687354</td>
      <td>188.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.519427</td>
      <td>0.689004</td>
      <td>185.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.835804</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.835804</td>
      <td>5287.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.098410</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.158348</td>
      <td>5295.000000</td>
      <td>392.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.835804</td>
      <td>0.998489</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.098410</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.158348</td>
      <td>1.000000</td>
      <td>392.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.91 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0101</td>
      <td>0.789519</td>
      <td>1.776382</td>
      <td>1.776382</td>
      <td>0.940594</td>
      <td>0.800149</td>
      <td>0.940594</td>
      <td>0.800149</td>
      <td>0.017941</td>
      <td>0.017941</td>
      <td>77.638160</td>
      <td>77.638160</td>
      <td>0.016666</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0204</td>
      <td>0.781367</td>
      <td>1.815231</td>
      <td>1.795997</td>
      <td>0.961165</td>
      <td>0.785390</td>
      <td>0.950980</td>
      <td>0.792698</td>
      <td>0.018697</td>
      <td>0.036638</td>
      <td>81.523144</td>
      <td>79.599696</td>
      <td>0.034513</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0335</td>
      <td>0.778060</td>
      <td>1.715575</td>
      <td>1.764548</td>
      <td>0.908397</td>
      <td>0.779096</td>
      <td>0.934328</td>
      <td>0.787379</td>
      <td>0.022474</td>
      <td>0.059112</td>
      <td>71.557497</td>
      <td>76.454836</td>
      <td>0.054436</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0407</td>
      <td>0.771218</td>
      <td>1.678733</td>
      <td>1.749367</td>
      <td>0.888889</td>
      <td>0.774200</td>
      <td>0.926290</td>
      <td>0.785047</td>
      <td>0.012087</td>
      <td>0.071199</td>
      <td>67.873256</td>
      <td>74.936719</td>
      <td>0.064823</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0523</td>
      <td>0.764063</td>
      <td>1.693204</td>
      <td>1.736910</td>
      <td>0.896552</td>
      <td>0.766315</td>
      <td>0.919694</td>
      <td>0.780893</td>
      <td>0.019641</td>
      <td>0.090840</td>
      <td>69.320439</td>
      <td>73.691043</td>
      <td>0.081914</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1010</td>
      <td>0.729840</td>
      <td>1.609360</td>
      <td>1.675408</td>
      <td>0.852156</td>
      <td>0.745647</td>
      <td>0.887129</td>
      <td>0.763898</td>
      <td>0.078376</td>
      <td>0.169216</td>
      <td>60.935988</td>
      <td>67.540833</td>
      <td>0.144987</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1501</td>
      <td>0.699633</td>
      <td>1.565478</td>
      <td>1.639448</td>
      <td>0.828921</td>
      <td>0.716835</td>
      <td>0.868088</td>
      <td>0.748503</td>
      <td>0.076865</td>
      <td>0.246081</td>
      <td>56.547794</td>
      <td>63.944843</td>
      <td>0.203998</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2000</td>
      <td>0.675508</td>
      <td>1.426839</td>
      <td>1.586402</td>
      <td>0.755511</td>
      <td>0.686070</td>
      <td>0.840000</td>
      <td>0.732926</td>
      <td>0.071199</td>
      <td>0.317280</td>
      <td>42.683857</td>
      <td>58.640227</td>
      <td>0.249268</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3000</td>
      <td>0.628903</td>
      <td>1.318225</td>
      <td>1.497010</td>
      <td>0.698000</td>
      <td>0.649476</td>
      <td>0.792667</td>
      <td>0.705109</td>
      <td>0.131822</td>
      <td>0.449103</td>
      <td>31.822474</td>
      <td>49.700976</td>
      <td>0.316903</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.579228</td>
      <td>1.218130</td>
      <td>1.427290</td>
      <td>0.645000</td>
      <td>0.605317</td>
      <td>0.755750</td>
      <td>0.680161</td>
      <td>0.121813</td>
      <td>0.570916</td>
      <td>21.813031</td>
      <td>42.728990</td>
      <td>0.363265</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.520964</td>
      <td>1.059490</td>
      <td>1.353730</td>
      <td>0.561000</td>
      <td>0.550914</td>
      <td>0.716800</td>
      <td>0.654312</td>
      <td>0.105949</td>
      <td>0.676865</td>
      <td>5.949008</td>
      <td>35.372993</td>
      <td>0.375909</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6000</td>
      <td>0.470755</td>
      <td>0.900850</td>
      <td>1.278250</td>
      <td>0.477000</td>
      <td>0.494393</td>
      <td>0.676833</td>
      <td>0.627659</td>
      <td>0.090085</td>
      <td>0.766950</td>
      <td>-9.915014</td>
      <td>27.824992</td>
      <td>0.354835</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7009</td>
      <td>0.438080</td>
      <td>0.758050</td>
      <td>1.203363</td>
      <td>0.401388</td>
      <td>0.452376</td>
      <td>0.637181</td>
      <td>0.602425</td>
      <td>0.076487</td>
      <td>0.843437</td>
      <td>-24.194993</td>
      <td>20.336311</td>
      <td>0.302948</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8003</td>
      <td>0.407245</td>
      <td>0.714390</td>
      <td>1.142631</td>
      <td>0.378270</td>
      <td>0.423648</td>
      <td>0.605023</td>
      <td>0.580221</td>
      <td>0.071010</td>
      <td>0.914448</td>
      <td>-28.560979</td>
      <td>14.263100</td>
      <td>0.242609</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9001</td>
      <td>0.350168</td>
      <td>0.580954</td>
      <td>1.080354</td>
      <td>0.307615</td>
      <td>0.382479</td>
      <td>0.572048</td>
      <td>0.558296</td>
      <td>0.057979</td>
      <td>0.972427</td>
      <td>-41.904583</td>
      <td>8.035420</td>
      <td>0.153723</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.098410</td>
      <td>0.276008</td>
      <td>1.000000</td>
      <td>0.146146</td>
      <td>0.265874</td>
      <td>0.529500</td>
      <td>0.529083</td>
      <td>0.027573</td>
      <td>1.000000</td>
      <td>-72.399217</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross-Validation Metrics Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>cv_1_valid</th>
      <th>cv_2_valid</th>
      <th>cv_3_valid</th>
      <th>cv_4_valid</th>
      <th>cv_5_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>accuracy</td>
      <td>0.662000</td>
      <td>0.011028</td>
      <td>0.660500</td>
      <td>0.659000</td>
      <td>0.647500</td>
      <td>0.665000</td>
      <td>0.678000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auc</td>
      <td>0.753708</td>
      <td>0.008455</td>
      <td>0.767336</td>
      <td>0.754202</td>
      <td>0.749615</td>
      <td>0.744636</td>
      <td>0.752753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>err</td>
      <td>0.338000</td>
      <td>0.011028</td>
      <td>0.339500</td>
      <td>0.341000</td>
      <td>0.352500</td>
      <td>0.335000</td>
      <td>0.322000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>err_count</td>
      <td>676.000000</td>
      <td>22.056746</td>
      <td>679.000000</td>
      <td>682.000000</td>
      <td>705.000000</td>
      <td>670.000000</td>
      <td>644.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f0point5</td>
      <td>0.667733</td>
      <td>0.006292</td>
      <td>0.664405</td>
      <td>0.665501</td>
      <td>0.660570</td>
      <td>0.676335</td>
      <td>0.671854</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f1</td>
      <td>0.732593</td>
      <td>0.011290</td>
      <td>0.734662</td>
      <td>0.743802</td>
      <td>0.733056</td>
      <td>0.737666</td>
      <td>0.713778</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f2</td>
      <td>0.812088</td>
      <td>0.030635</td>
      <td>0.821535</td>
      <td>0.842984</td>
      <td>0.823409</td>
      <td>0.811230</td>
      <td>0.761282</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lift_top_group</td>
      <td>1.770414</td>
      <td>0.119520</td>
      <td>1.897533</td>
      <td>1.715529</td>
      <td>1.677038</td>
      <td>1.660517</td>
      <td>1.901455</td>
    </tr>
    <tr>
      <th>8</th>
      <td>logloss</td>
      <td>0.599664</td>
      <td>0.005876</td>
      <td>0.590319</td>
      <td>0.597491</td>
      <td>0.603376</td>
      <td>0.604522</td>
      <td>0.602610</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max_per_class_error</td>
      <td>0.581695</td>
      <td>0.083577</td>
      <td>0.597252</td>
      <td>0.647312</td>
      <td>0.644951</td>
      <td>0.576419</td>
      <td>0.442540</td>
    </tr>
    <tr>
      <th>10</th>
      <td>mcc</td>
      <td>0.336792</td>
      <td>0.022258</td>
      <td>0.340809</td>
      <td>0.343997</td>
      <td>0.303925</td>
      <td>0.330306</td>
      <td>0.364922</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mean_per_class_accuracy</td>
      <td>0.647136</td>
      <td>0.018742</td>
      <td>0.647294</td>
      <td>0.638961</td>
      <td>0.626088</td>
      <td>0.646292</td>
      <td>0.677043</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mean_per_class_error</td>
      <td>0.352864</td>
      <td>0.018742</td>
      <td>0.352705</td>
      <td>0.361039</td>
      <td>0.373912</td>
      <td>0.353708</td>
      <td>0.322957</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mse</td>
      <td>0.205918</td>
      <td>0.002593</td>
      <td>0.201783</td>
      <td>0.204980</td>
      <td>0.207443</td>
      <td>0.208073</td>
      <td>0.207309</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pr_auc</td>
      <td>0.771801</td>
      <td>0.013353</td>
      <td>0.792843</td>
      <td>0.772931</td>
      <td>0.772372</td>
      <td>0.762701</td>
      <td>0.758159</td>
    </tr>
    <tr>
      <th>15</th>
      <td>precision</td>
      <td>0.630703</td>
      <td>0.012138</td>
      <td>0.624585</td>
      <td>0.621859</td>
      <td>0.619718</td>
      <td>0.640816</td>
      <td>0.646538</td>
    </tr>
    <tr>
      <th>16</th>
      <td>r2</td>
      <td>0.172814</td>
      <td>0.011294</td>
      <td>0.190509</td>
      <td>0.176042</td>
      <td>0.165018</td>
      <td>0.161792</td>
      <td>0.170710</td>
    </tr>
    <tr>
      <th>17</th>
      <td>recall</td>
      <td>0.875966</td>
      <td>0.048658</td>
      <td>0.891841</td>
      <td>0.925234</td>
      <td>0.897127</td>
      <td>0.869004</td>
      <td>0.796627</td>
    </tr>
    <tr>
      <th>18</th>
      <td>rmse</td>
      <td>0.453774</td>
      <td>0.002864</td>
      <td>0.449202</td>
      <td>0.452747</td>
      <td>0.455459</td>
      <td>0.456151</td>
      <td>0.455312</td>
    </tr>
    <tr>
      <th>19</th>
      <td>specificity</td>
      <td>0.418305</td>
      <td>0.083577</td>
      <td>0.402748</td>
      <td>0.352688</td>
      <td>0.355049</td>
      <td>0.423581</td>
      <td>0.557460</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scoring History: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>3.918 sec</td>
      <td>0.0</td>
      <td>0.499129</td>
      <td>0.691406</td>
      <td>0.500000</td>
      <td>0.529500</td>
      <td>1.000000</td>
      <td>0.4705</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>3.996 sec</td>
      <td>1.0</td>
      <td>0.488236</td>
      <td>0.669779</td>
      <td>0.689191</td>
      <td>0.674970</td>
      <td>1.340835</td>
      <td>0.3927</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.016 sec</td>
      <td>2.0</td>
      <td>0.479807</td>
      <td>0.653146</td>
      <td>0.719111</td>
      <td>0.725388</td>
      <td>1.545030</td>
      <td>0.3958</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.033 sec</td>
      <td>3.0</td>
      <td>0.473698</td>
      <td>0.641037</td>
      <td>0.724650</td>
      <td>0.731284</td>
      <td>1.569032</td>
      <td>0.3933</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.052 sec</td>
      <td>4.0</td>
      <td>0.467046</td>
      <td>0.627816</td>
      <td>0.746638</td>
      <td>0.760063</td>
      <td>1.683844</td>
      <td>0.3692</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.071 sec</td>
      <td>5.0</td>
      <td>0.462994</td>
      <td>0.619629</td>
      <td>0.750899</td>
      <td>0.766012</td>
      <td>1.696473</td>
      <td>0.3404</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.091 sec</td>
      <td>6.0</td>
      <td>0.458301</td>
      <td>0.609973</td>
      <td>0.756603</td>
      <td>0.772386</td>
      <td>1.733566</td>
      <td>0.3515</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.113 sec</td>
      <td>7.0</td>
      <td>0.455569</td>
      <td>0.604192</td>
      <td>0.758101</td>
      <td>0.773795</td>
      <td>1.748075</td>
      <td>0.3512</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.136 sec</td>
      <td>8.0</td>
      <td>0.452777</td>
      <td>0.598335</td>
      <td>0.763715</td>
      <td>0.778986</td>
      <td>1.754413</td>
      <td>0.3180</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.160 sec</td>
      <td>9.0</td>
      <td>0.449743</td>
      <td>0.591929</td>
      <td>0.768491</td>
      <td>0.784821</td>
      <td>1.776659</td>
      <td>0.3207</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>2022-02-23 12:13:08</td>
      <td>4.184 sec</td>
      <td>10.0</td>
      <td>0.447797</td>
      <td>0.587918</td>
      <td>0.773547</td>
      <td>0.790911</td>
      <td>1.831345</td>
      <td>0.3090</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable Importances: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>x26</td>
      <td>565.332336</td>
      <td>1.000000</td>
      <td>0.410859</td>
    </tr>
    <tr>
      <th>1</th>
      <td>x28</td>
      <td>204.503998</td>
      <td>0.361741</td>
      <td>0.148625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x27</td>
      <td>189.230789</td>
      <td>0.334725</td>
      <td>0.137525</td>
    </tr>
    <tr>
      <th>3</th>
      <td>x23</td>
      <td>124.527618</td>
      <td>0.220273</td>
      <td>0.090501</td>
    </tr>
    <tr>
      <th>4</th>
      <td>x6</td>
      <td>121.551117</td>
      <td>0.215008</td>
      <td>0.088338</td>
    </tr>
    <tr>
      <th>5</th>
      <td>x25</td>
      <td>99.598267</td>
      <td>0.176176</td>
      <td>0.072384</td>
    </tr>
    <tr>
      <th>6</th>
      <td>x4</td>
      <td>44.359753</td>
      <td>0.078467</td>
      <td>0.032239</td>
    </tr>
    <tr>
      <th>7</th>
      <td>x10</td>
      <td>18.008587</td>
      <td>0.031855</td>
      <td>0.013088</td>
    </tr>
    <tr>
      <th>8</th>
      <td>x22</td>
      <td>3.660778</td>
      <td>0.006475</td>
      <td>0.002660</td>
    </tr>
    <tr>
      <th>9</th>
      <td>x18</td>
      <td>3.097153</td>
      <td>0.005478</td>
      <td>0.002251</td>
    </tr>
    <tr>
      <th>10</th>
      <td>x5</td>
      <td>2.104541</td>
      <td>0.003723</td>
      <td>0.001529</td>
    </tr>
    <tr>
      <th>11</th>
      <td>x1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>x2</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>x3</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>x7</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>x8</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>x9</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>x11</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>x12</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>x13</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train and cross-validate a RF</span>
<span class="n">my_rf</span> <span class="o">=</span> <span class="n">H2ORandomForestEstimator</span><span class="p">(</span><span class="n">ntrees</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                 <span class="n">nfolds</span><span class="o">=</span><span class="n">nfolds</span><span class="p">,</span>
                                 <span class="n">fold_assignment</span><span class="o">=</span><span class="s2">&quot;Modulo&quot;</span><span class="p">,</span>
                                 <span class="n">keep_cross_validation_predictions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">my_rf</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>drf Model Build progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>██| (done) 100%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2ORandomForestEstimator :  Distributed Random Forest
Model Key:  DRF_model_python_1645647168083_129


Model Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>50.0</td>
      <td>50.0</td>
      <td>943583.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>1402.0</td>
      <td>1583.0</td>
      <td>1496.78</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: drf
** Reported on train data. **

MSE: 0.20546981364562208
RMSE: 0.45328778236967965
LogLoss: 0.6008794722074892
Mean Per-Class Error: 0.3224386087972231
AUC: 0.7416906451357175
AUCPR: 0.7551298236228338
Gini: 0.48338129027143495

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.3888572089486607: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1938.0</td>
      <td>2767.0</td>
      <td>0.5881</td>
      <td>(2767.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>662.0</td>
      <td>4633.0</td>
      <td>0.125</td>
      <td>(662.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2600.0</td>
      <td>7400.0</td>
      <td>0.3429</td>
      <td>(3429.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.388857</td>
      <td>0.729894</td>
      <td>274.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.178865</td>
      <td>0.852754</td>
      <td>362.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.583101</td>
      <td>0.697594</td>
      <td>175.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.491198</td>
      <td>0.680400</td>
      <td>222.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.999849</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.000040</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.999849</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.491198</td>
      <td>0.356604</td>
      <td>222.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.526118</td>
      <td>0.675027</td>
      <td>205.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.520683</td>
      <td>0.677561</td>
      <td>208.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.999849</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.999849</td>
      <td>5271.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.000040</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.000040</td>
      <td>5295.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.999849</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.999849</td>
      <td>0.995467</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.000040</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.000040</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.91 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0100</td>
      <td>0.945952</td>
      <td>1.794145</td>
      <td>1.794145</td>
      <td>0.950000</td>
      <td>0.978593</td>
      <td>0.950000</td>
      <td>0.978593</td>
      <td>0.017941</td>
      <td>0.017941</td>
      <td>79.414542</td>
      <td>79.414542</td>
      <td>0.016879</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0208</td>
      <td>0.923077</td>
      <td>1.713706</td>
      <td>1.752379</td>
      <td>0.907407</td>
      <td>0.935488</td>
      <td>0.927885</td>
      <td>0.956212</td>
      <td>0.018508</td>
      <td>0.036449</td>
      <td>71.370615</td>
      <td>75.237888</td>
      <td>0.033261</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0300</td>
      <td>0.900000</td>
      <td>1.703822</td>
      <td>1.737488</td>
      <td>0.902174</td>
      <td>0.909819</td>
      <td>0.920000</td>
      <td>0.941984</td>
      <td>0.015675</td>
      <td>0.052125</td>
      <td>70.382231</td>
      <td>73.748820</td>
      <td>0.047024</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0404</td>
      <td>0.882353</td>
      <td>1.634343</td>
      <td>1.710936</td>
      <td>0.865385</td>
      <td>0.890502</td>
      <td>0.905941</td>
      <td>0.928732</td>
      <td>0.016997</td>
      <td>0.069122</td>
      <td>63.434299</td>
      <td>71.093597</td>
      <td>0.061045</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0500</td>
      <td>0.867742</td>
      <td>1.593484</td>
      <td>1.688385</td>
      <td>0.843750</td>
      <td>0.874732</td>
      <td>0.894000</td>
      <td>0.918364</td>
      <td>0.015297</td>
      <td>0.084419</td>
      <td>59.348442</td>
      <td>68.838527</td>
      <td>0.073155</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1000</td>
      <td>0.809095</td>
      <td>1.567517</td>
      <td>1.627951</td>
      <td>0.830000</td>
      <td>0.835855</td>
      <td>0.862000</td>
      <td>0.877109</td>
      <td>0.078376</td>
      <td>0.162795</td>
      <td>56.751653</td>
      <td>62.795090</td>
      <td>0.133465</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1500</td>
      <td>0.760766</td>
      <td>1.507082</td>
      <td>1.587661</td>
      <td>0.798000</td>
      <td>0.783973</td>
      <td>0.840667</td>
      <td>0.846064</td>
      <td>0.075354</td>
      <td>0.238149</td>
      <td>50.708215</td>
      <td>58.766132</td>
      <td>0.187352</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2000</td>
      <td>0.720000</td>
      <td>1.401322</td>
      <td>1.541076</td>
      <td>0.742000</td>
      <td>0.738881</td>
      <td>0.816000</td>
      <td>0.819268</td>
      <td>0.070066</td>
      <td>0.308215</td>
      <td>40.132200</td>
      <td>54.107649</td>
      <td>0.230001</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3022</td>
      <td>0.647059</td>
      <td>1.332350</td>
      <td>1.470488</td>
      <td>0.705479</td>
      <td>0.681472</td>
      <td>0.778623</td>
      <td>0.772667</td>
      <td>0.136166</td>
      <td>0.444381</td>
      <td>33.235024</td>
      <td>47.048806</td>
      <td>0.302192</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.585714</td>
      <td>1.181807</td>
      <td>1.399906</td>
      <td>0.625767</td>
      <td>0.615625</td>
      <td>0.741250</td>
      <td>0.734271</td>
      <td>0.115581</td>
      <td>0.559962</td>
      <td>18.180712</td>
      <td>39.990557</td>
      <td>0.339983</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5032</td>
      <td>0.529412</td>
      <td>1.041278</td>
      <td>1.326356</td>
      <td>0.551357</td>
      <td>0.556314</td>
      <td>0.702305</td>
      <td>0.697774</td>
      <td>0.107460</td>
      <td>0.667422</td>
      <td>4.127779</td>
      <td>32.635552</td>
      <td>0.349037</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6000</td>
      <td>0.471424</td>
      <td>0.977454</td>
      <td>1.270066</td>
      <td>0.517562</td>
      <td>0.500429</td>
      <td>0.672500</td>
      <td>0.665936</td>
      <td>0.094618</td>
      <td>0.762040</td>
      <td>-2.254583</td>
      <td>27.006610</td>
      <td>0.344399</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7049</td>
      <td>0.411765</td>
      <td>0.837166</td>
      <td>1.205644</td>
      <td>0.443279</td>
      <td>0.442787</td>
      <td>0.638388</td>
      <td>0.632728</td>
      <td>0.087819</td>
      <td>0.849858</td>
      <td>-16.283416</td>
      <td>20.564386</td>
      <td>0.308094</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8000</td>
      <td>0.342199</td>
      <td>0.667256</td>
      <td>1.141643</td>
      <td>0.353312</td>
      <td>0.377445</td>
      <td>0.604500</td>
      <td>0.602381</td>
      <td>0.063456</td>
      <td>0.913314</td>
      <td>-33.274353</td>
      <td>14.164306</td>
      <td>0.240838</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9076</td>
      <td>0.250000</td>
      <td>0.528309</td>
      <td>1.068930</td>
      <td>0.279740</td>
      <td>0.296046</td>
      <td>0.565998</td>
      <td>0.566064</td>
      <td>0.056846</td>
      <td>0.970161</td>
      <td>-47.169070</td>
      <td>6.892963</td>
      <td>0.132966</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.000000</td>
      <td>0.322938</td>
      <td>1.000000</td>
      <td>0.170996</td>
      <td>0.166548</td>
      <td>0.529500</td>
      <td>0.529148</td>
      <td>0.029839</td>
      <td>1.000000</td>
      <td>-67.706200</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: drf
** Reported on cross-validation data. **

MSE: 0.19956810017797458
RMSE: 0.4467304558433134
LogLoss: 0.5833973417660576
Mean Per-Class Error: 0.30854313866569527
AUC: 0.7614513722267212
AUCPR: 0.777397370947399
Gini: 0.5229027444534424

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.382028770186007: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1842.0</td>
      <td>2863.0</td>
      <td>0.6085</td>
      <td>(2863.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>526.0</td>
      <td>4769.0</td>
      <td>0.0993</td>
      <td>(526.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2368.0</td>
      <td>7632.0</td>
      <td>0.3389</td>
      <td>(3389.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.382029</td>
      <td>0.737836</td>
      <td>289.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.204063</td>
      <td>0.854720</td>
      <td>367.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.571824</td>
      <td>0.716855</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.505138</td>
      <td>0.690300</td>
      <td>220.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.977634</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.100147</td>
      <td>1.000000</td>
      <td>391.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.977634</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.559896</td>
      <td>0.384004</td>
      <td>189.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.521841</td>
      <td>0.689330</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.553850</td>
      <td>0.691457</td>
      <td>192.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.977634</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.977634</td>
      <td>5291.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.000000</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.100147</td>
      <td>5295.000000</td>
      <td>391.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.977634</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.977634</td>
      <td>0.999245</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.100147</td>
      <td>1.000000</td>
      <td>391.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.88 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0100</td>
      <td>0.901617</td>
      <td>1.775260</td>
      <td>1.775260</td>
      <td>0.940000</td>
      <td>0.929766</td>
      <td>0.940000</td>
      <td>0.929766</td>
      <td>0.017753</td>
      <td>0.017753</td>
      <td>77.525968</td>
      <td>77.525968</td>
      <td>0.016477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0200</td>
      <td>0.877340</td>
      <td>1.775260</td>
      <td>1.775260</td>
      <td>0.940000</td>
      <td>0.889550</td>
      <td>0.940000</td>
      <td>0.909658</td>
      <td>0.017753</td>
      <td>0.035505</td>
      <td>77.525968</td>
      <td>77.525968</td>
      <td>0.032955</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0300</td>
      <td>0.857939</td>
      <td>1.737488</td>
      <td>1.762669</td>
      <td>0.920000</td>
      <td>0.866490</td>
      <td>0.933333</td>
      <td>0.895269</td>
      <td>0.017375</td>
      <td>0.052880</td>
      <td>73.748820</td>
      <td>76.266918</td>
      <td>0.048629</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0416</td>
      <td>0.840000</td>
      <td>1.709485</td>
      <td>1.747839</td>
      <td>0.905172</td>
      <td>0.848993</td>
      <td>0.925481</td>
      <td>0.882365</td>
      <td>0.019830</td>
      <td>0.072710</td>
      <td>70.948520</td>
      <td>74.783904</td>
      <td>0.066121</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0500</td>
      <td>0.830650</td>
      <td>1.776159</td>
      <td>1.752597</td>
      <td>0.940476</td>
      <td>0.835844</td>
      <td>0.928000</td>
      <td>0.874550</td>
      <td>0.014920</td>
      <td>0.087630</td>
      <td>77.615900</td>
      <td>75.259679</td>
      <td>0.079978</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1000</td>
      <td>0.777339</td>
      <td>1.650614</td>
      <td>1.701605</td>
      <td>0.874000</td>
      <td>0.801188</td>
      <td>0.901000</td>
      <td>0.837869</td>
      <td>0.082531</td>
      <td>0.170161</td>
      <td>65.061379</td>
      <td>70.160529</td>
      <td>0.149119</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1500</td>
      <td>0.735883</td>
      <td>1.552408</td>
      <td>1.651873</td>
      <td>0.822000</td>
      <td>0.754507</td>
      <td>0.874667</td>
      <td>0.810082</td>
      <td>0.077620</td>
      <td>0.247781</td>
      <td>55.240793</td>
      <td>65.187284</td>
      <td>0.207823</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2046</td>
      <td>0.700000</td>
      <td>1.397406</td>
      <td>1.583965</td>
      <td>0.739927</td>
      <td>0.715986</td>
      <td>0.838710</td>
      <td>0.784971</td>
      <td>0.076298</td>
      <td>0.324079</td>
      <td>39.740650</td>
      <td>58.396540</td>
      <td>0.253941</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3041</td>
      <td>0.640000</td>
      <td>1.359014</td>
      <td>1.510362</td>
      <td>0.719598</td>
      <td>0.668698</td>
      <td>0.799737</td>
      <td>0.746927</td>
      <td>0.135222</td>
      <td>0.459301</td>
      <td>35.901415</td>
      <td>51.036247</td>
      <td>0.329864</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.581753</td>
      <td>1.219007</td>
      <td>1.440510</td>
      <td>0.645464</td>
      <td>0.610507</td>
      <td>0.762750</td>
      <td>0.714220</td>
      <td>0.116903</td>
      <td>0.576204</td>
      <td>21.900666</td>
      <td>44.050992</td>
      <td>0.374504</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.527643</td>
      <td>1.033050</td>
      <td>1.359018</td>
      <td>0.547000</td>
      <td>0.555356</td>
      <td>0.719600</td>
      <td>0.682447</td>
      <td>0.103305</td>
      <td>0.679509</td>
      <td>3.305005</td>
      <td>35.901794</td>
      <td>0.381528</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6007</td>
      <td>0.480000</td>
      <td>0.915218</td>
      <td>1.284620</td>
      <td>0.484608</td>
      <td>0.502733</td>
      <td>0.680206</td>
      <td>0.652320</td>
      <td>0.092162</td>
      <td>0.771671</td>
      <td>-8.478235</td>
      <td>28.462026</td>
      <td>0.363382</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7066</td>
      <td>0.420000</td>
      <td>0.825694</td>
      <td>1.215840</td>
      <td>0.437205</td>
      <td>0.448026</td>
      <td>0.643787</td>
      <td>0.621702</td>
      <td>0.087441</td>
      <td>0.859112</td>
      <td>-17.430612</td>
      <td>21.583975</td>
      <td>0.324150</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8041</td>
      <td>0.360000</td>
      <td>0.676013</td>
      <td>1.150384</td>
      <td>0.357949</td>
      <td>0.387661</td>
      <td>0.609128</td>
      <td>0.593324</td>
      <td>0.065911</td>
      <td>0.925024</td>
      <td>-32.398731</td>
      <td>15.038379</td>
      <td>0.257011</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9000</td>
      <td>0.280136</td>
      <td>0.466728</td>
      <td>1.077536</td>
      <td>0.247132</td>
      <td>0.321866</td>
      <td>0.570556</td>
      <td>0.564398</td>
      <td>0.044759</td>
      <td>0.969783</td>
      <td>-53.327209</td>
      <td>7.753646</td>
      <td>0.148316</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.000000</td>
      <td>0.302172</td>
      <td>1.000000</td>
      <td>0.160000</td>
      <td>0.208026</td>
      <td>0.529500</td>
      <td>0.528761</td>
      <td>0.030217</td>
      <td>1.000000</td>
      <td>-69.782814</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross-Validation Metrics Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>cv_1_valid</th>
      <th>cv_2_valid</th>
      <th>cv_3_valid</th>
      <th>cv_4_valid</th>
      <th>cv_5_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>accuracy</td>
      <td>0.664800</td>
      <td>0.011719</td>
      <td>0.672500</td>
      <td>0.669000</td>
      <td>0.644000</td>
      <td>0.669500</td>
      <td>0.669000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auc</td>
      <td>0.761771</td>
      <td>0.006352</td>
      <td>0.767895</td>
      <td>0.759037</td>
      <td>0.751985</td>
      <td>0.764674</td>
      <td>0.765263</td>
    </tr>
    <tr>
      <th>2</th>
      <td>err</td>
      <td>0.335200</td>
      <td>0.011719</td>
      <td>0.327500</td>
      <td>0.331000</td>
      <td>0.356000</td>
      <td>0.330500</td>
      <td>0.331000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>err_count</td>
      <td>670.400000</td>
      <td>23.437150</td>
      <td>655.000000</td>
      <td>662.000000</td>
      <td>712.000000</td>
      <td>661.000000</td>
      <td>662.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f0point5</td>
      <td>0.668341</td>
      <td>0.009353</td>
      <td>0.673882</td>
      <td>0.672582</td>
      <td>0.656944</td>
      <td>0.678371</td>
      <td>0.659929</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f1</td>
      <td>0.740280</td>
      <td>0.008140</td>
      <td>0.740388</td>
      <td>0.750000</td>
      <td>0.737463</td>
      <td>0.745083</td>
      <td>0.728466</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f2</td>
      <td>0.829747</td>
      <td>0.014114</td>
      <td>0.821460</td>
      <td>0.847559</td>
      <td>0.840477</td>
      <td>0.826347</td>
      <td>0.812889</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lift_top_group</td>
      <td>1.778484</td>
      <td>0.163896</td>
      <td>1.802657</td>
      <td>1.869159</td>
      <td>1.668211</td>
      <td>1.568266</td>
      <td>1.984127</td>
    </tr>
    <tr>
      <th>8</th>
      <td>logloss</td>
      <td>0.583397</td>
      <td>0.004707</td>
      <td>0.576402</td>
      <td>0.583977</td>
      <td>0.589635</td>
      <td>0.583940</td>
      <td>0.583033</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max_per_class_error</td>
      <td>0.604207</td>
      <td>0.055881</td>
      <td>0.565539</td>
      <td>0.629032</td>
      <td>0.687296</td>
      <td>0.592795</td>
      <td>0.546371</td>
    </tr>
    <tr>
      <th>10</th>
      <td>mcc</td>
      <td>0.350469</td>
      <td>0.025356</td>
      <td>0.362479</td>
      <td>0.365513</td>
      <td>0.308388</td>
      <td>0.345384</td>
      <td>0.370580</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mean_per_class_accuracy</td>
      <td>0.649203</td>
      <td>0.018154</td>
      <td>0.660304</td>
      <td>0.649503</td>
      <td>0.619744</td>
      <td>0.649175</td>
      <td>0.667291</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mean_per_class_error</td>
      <td>0.350797</td>
      <td>0.018154</td>
      <td>0.339696</td>
      <td>0.350497</td>
      <td>0.380256</td>
      <td>0.350825</td>
      <td>0.332709</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mse</td>
      <td>0.199568</td>
      <td>0.001972</td>
      <td>0.196876</td>
      <td>0.199863</td>
      <td>0.202404</td>
      <td>0.199157</td>
      <td>0.199540</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pr_auc</td>
      <td>0.778010</td>
      <td>0.007674</td>
      <td>0.785139</td>
      <td>0.774624</td>
      <td>0.781224</td>
      <td>0.782860</td>
      <td>0.766203</td>
    </tr>
    <tr>
      <th>15</th>
      <td>precision</td>
      <td>0.627718</td>
      <td>0.011221</td>
      <td>0.635807</td>
      <td>0.629278</td>
      <td>0.612370</td>
      <td>0.640159</td>
      <td>0.620979</td>
    </tr>
    <tr>
      <th>16</th>
      <td>r2</td>
      <td>0.198320</td>
      <td>0.009026</td>
      <td>0.210194</td>
      <td>0.196609</td>
      <td>0.185299</td>
      <td>0.197710</td>
      <td>0.201789</td>
    </tr>
    <tr>
      <th>17</th>
      <td>recall</td>
      <td>0.902613</td>
      <td>0.022926</td>
      <td>0.886148</td>
      <td>0.928037</td>
      <td>0.926784</td>
      <td>0.891144</td>
      <td>0.880952</td>
    </tr>
    <tr>
      <th>18</th>
      <td>rmse</td>
      <td>0.446726</td>
      <td>0.002206</td>
      <td>0.443707</td>
      <td>0.447061</td>
      <td>0.449893</td>
      <td>0.446271</td>
      <td>0.446699</td>
    </tr>
    <tr>
      <th>19</th>
      <td>specificity</td>
      <td>0.395793</td>
      <td>0.055881</td>
      <td>0.434461</td>
      <td>0.370968</td>
      <td>0.312704</td>
      <td>0.407205</td>
      <td>0.453629</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scoring History: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>9.876 sec</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>9.905 sec</td>
      <td>1.0</td>
      <td>0.642818</td>
      <td>14.048395</td>
      <td>0.577384</td>
      <td>0.589593</td>
      <td>1.144218</td>
      <td>0.464917</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>9.935 sec</td>
      <td>2.0</td>
      <td>0.615404</td>
      <td>11.895281</td>
      <td>0.595767</td>
      <td>0.598674</td>
      <td>1.167648</td>
      <td>0.470126</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>9.969 sec</td>
      <td>3.0</td>
      <td>0.596109</td>
      <td>10.322973</td>
      <td>0.606984</td>
      <td>0.606263</td>
      <td>1.188141</td>
      <td>0.471944</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.001 sec</td>
      <td>4.0</td>
      <td>0.578952</td>
      <td>8.963477</td>
      <td>0.617051</td>
      <td>0.613281</td>
      <td>1.205225</td>
      <td>0.473260</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.029 sec</td>
      <td>5.0</td>
      <td>0.566757</td>
      <td>7.823122</td>
      <td>0.621447</td>
      <td>0.619131</td>
      <td>1.222342</td>
      <td>0.472650</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.061 sec</td>
      <td>6.0</td>
      <td>0.555494</td>
      <td>6.782681</td>
      <td>0.625539</td>
      <td>0.623303</td>
      <td>1.235544</td>
      <td>0.472576</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.092 sec</td>
      <td>7.0</td>
      <td>0.542668</td>
      <td>5.762143</td>
      <td>0.634190</td>
      <td>0.632386</td>
      <td>1.256193</td>
      <td>0.470778</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.116 sec</td>
      <td>8.0</td>
      <td>0.534223</td>
      <td>5.001247</td>
      <td>0.637938</td>
      <td>0.634830</td>
      <td>1.257749</td>
      <td>0.470999</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.145 sec</td>
      <td>9.0</td>
      <td>0.525930</td>
      <td>4.327270</td>
      <td>0.643458</td>
      <td>0.638581</td>
      <td>1.259426</td>
      <td>0.416980</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.172 sec</td>
      <td>10.0</td>
      <td>0.516709</td>
      <td>3.691988</td>
      <td>0.652861</td>
      <td>0.649779</td>
      <td>1.292382</td>
      <td>0.416650</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.204 sec</td>
      <td>11.0</td>
      <td>0.510283</td>
      <td>3.222738</td>
      <td>0.659091</td>
      <td>0.656853</td>
      <td>1.315126</td>
      <td>0.417606</td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.244 sec</td>
      <td>12.0</td>
      <td>0.501990</td>
      <td>2.723957</td>
      <td>0.669423</td>
      <td>0.667708</td>
      <td>1.341061</td>
      <td>0.422262</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.270 sec</td>
      <td>13.0</td>
      <td>0.496251</td>
      <td>2.349060</td>
      <td>0.675311</td>
      <td>0.675563</td>
      <td>1.374979</td>
      <td>0.405793</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.298 sec</td>
      <td>14.0</td>
      <td>0.492259</td>
      <td>2.050819</td>
      <td>0.679020</td>
      <td>0.680861</td>
      <td>1.408270</td>
      <td>0.405386</td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.327 sec</td>
      <td>15.0</td>
      <td>0.487936</td>
      <td>1.795128</td>
      <td>0.684347</td>
      <td>0.686164</td>
      <td>1.425637</td>
      <td>0.404943</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.356 sec</td>
      <td>16.0</td>
      <td>0.484170</td>
      <td>1.579896</td>
      <td>0.689326</td>
      <td>0.694656</td>
      <td>1.472602</td>
      <td>0.384615</td>
    </tr>
    <tr>
      <th>17</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.384 sec</td>
      <td>17.0</td>
      <td>0.480754</td>
      <td>1.424860</td>
      <td>0.693815</td>
      <td>0.699750</td>
      <td>1.494407</td>
      <td>0.400180</td>
    </tr>
    <tr>
      <th>18</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.413 sec</td>
      <td>18.0</td>
      <td>0.477989</td>
      <td>1.318464</td>
      <td>0.698239</td>
      <td>0.703253</td>
      <td>1.498109</td>
      <td>0.389139</td>
    </tr>
    <tr>
      <th>19</th>
      <td></td>
      <td>2022-02-23 12:13:19</td>
      <td>10.442 sec</td>
      <td>19.0</td>
      <td>0.475932</td>
      <td>1.215350</td>
      <td>0.701065</td>
      <td>0.707162</td>
      <td>1.521093</td>
      <td>0.391439</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()

Variable Importances: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>x26</td>
      <td>7803.849121</td>
      <td>1.000000</td>
      <td>0.101371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>x27</td>
      <td>4741.325195</td>
      <td>0.607562</td>
      <td>0.061589</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x28</td>
      <td>4625.907227</td>
      <td>0.592773</td>
      <td>0.060090</td>
    </tr>
    <tr>
      <th>3</th>
      <td>x23</td>
      <td>3613.875244</td>
      <td>0.463089</td>
      <td>0.046944</td>
    </tr>
    <tr>
      <th>4</th>
      <td>x25</td>
      <td>3548.924072</td>
      <td>0.454766</td>
      <td>0.046100</td>
    </tr>
    <tr>
      <th>5</th>
      <td>x6</td>
      <td>3477.234863</td>
      <td>0.445579</td>
      <td>0.045169</td>
    </tr>
    <tr>
      <th>6</th>
      <td>x4</td>
      <td>3103.802002</td>
      <td>0.397727</td>
      <td>0.040318</td>
    </tr>
    <tr>
      <th>7</th>
      <td>x1</td>
      <td>2902.952637</td>
      <td>0.371990</td>
      <td>0.037709</td>
    </tr>
    <tr>
      <th>8</th>
      <td>x10</td>
      <td>2854.255615</td>
      <td>0.365750</td>
      <td>0.037077</td>
    </tr>
    <tr>
      <th>9</th>
      <td>x7</td>
      <td>2711.995605</td>
      <td>0.347520</td>
      <td>0.035229</td>
    </tr>
    <tr>
      <th>10</th>
      <td>x12</td>
      <td>2698.118896</td>
      <td>0.345742</td>
      <td>0.035048</td>
    </tr>
    <tr>
      <th>11</th>
      <td>x19</td>
      <td>2686.344482</td>
      <td>0.344233</td>
      <td>0.034895</td>
    </tr>
    <tr>
      <th>12</th>
      <td>x20</td>
      <td>2666.914795</td>
      <td>0.341744</td>
      <td>0.034643</td>
    </tr>
    <tr>
      <th>13</th>
      <td>x5</td>
      <td>2663.880127</td>
      <td>0.341355</td>
      <td>0.034604</td>
    </tr>
    <tr>
      <th>14</th>
      <td>x2</td>
      <td>2653.526855</td>
      <td>0.340028</td>
      <td>0.034469</td>
    </tr>
    <tr>
      <th>15</th>
      <td>x16</td>
      <td>2644.946289</td>
      <td>0.338928</td>
      <td>0.034358</td>
    </tr>
    <tr>
      <th>16</th>
      <td>x8</td>
      <td>2601.998779</td>
      <td>0.333425</td>
      <td>0.033800</td>
    </tr>
    <tr>
      <th>17</th>
      <td>x11</td>
      <td>2589.764160</td>
      <td>0.331857</td>
      <td>0.033641</td>
    </tr>
    <tr>
      <th>18</th>
      <td>x3</td>
      <td>2588.894775</td>
      <td>0.331746</td>
      <td>0.033629</td>
    </tr>
    <tr>
      <th>19</th>
      <td>x15</td>
      <td>2535.097900</td>
      <td>0.324852</td>
      <td>0.032931</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train a stacked ensemble using the GBM and GLM above</span>
<span class="n">ensemble</span> <span class="o">=</span> <span class="n">H2OStackedEnsembleEstimator</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="s2">&quot;my_ensemble_binomial&quot;</span><span class="p">,</span>
                                       <span class="n">base_models</span><span class="o">=</span><span class="p">[</span><span class="n">my_gbm</span><span class="p">,</span> <span class="n">my_rf</span><span class="p">])</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>

<span class="c1"># Eval ensemble performance on the test data</span>
<span class="n">perf_stack_test</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stackedensemble Model Build progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>██████████████████████████████████████████| (done) 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare to base learner performance on the test set</span>
<span class="n">perf_gbm_test</span> <span class="o">=</span> <span class="n">my_gbm</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">perf_rf_test</span> <span class="o">=</span> <span class="n">my_rf</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">baselearner_best_auc_test</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">perf_gbm_test</span><span class="o">.</span><span class="n">auc</span><span class="p">(),</span> <span class="n">perf_rf_test</span><span class="o">.</span><span class="n">auc</span><span class="p">())</span>
<span class="n">stack_auc_test</span> <span class="o">=</span> <span class="n">perf_stack_test</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Base-learner Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">baselearner_best_auc_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack_auc_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Base-learner Test AUC:  0.769204725074508
Ensemble Test AUC:  0.7731183158978566
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate predictions on a test set (if neccessary)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>


<span class="c1"># 2. Generate a random grid of models and stack them together</span>

<span class="c1"># Specify GBM hyperparameters for the grid</span>
<span class="n">hyper_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;learn_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
                <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                <span class="s2">&quot;sample_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                <span class="s2">&quot;col_sample_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]}</span>
<span class="n">search_criteria</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;RandomDiscrete&quot;</span><span class="p">,</span> <span class="s2">&quot;max_models&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stackedensemble prediction progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>███████████████████████████████████████████| (done) 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train the grid</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">H2OGridSearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span><span class="n">ntrees</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                        <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                        <span class="n">nfolds</span><span class="o">=</span><span class="n">nfolds</span><span class="p">,</span>
                                                        <span class="n">fold_assignment</span><span class="o">=</span><span class="s2">&quot;Modulo&quot;</span><span class="p">,</span>
                                                        <span class="n">keep_cross_validation_predictions</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                     <span class="n">hyper_params</span><span class="o">=</span><span class="n">hyper_params</span><span class="p">,</span>
                     <span class="n">search_criteria</span><span class="o">=</span><span class="n">search_criteria</span><span class="p">,</span>
                     <span class="n">grid_id</span><span class="o">=</span><span class="s2">&quot;gbm_grid_binomial&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Grid Build progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>█
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>███████| (done) 100%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    col_sample_rate learn_rate max_depth sample_rate  \
0               0.4       0.03         3         0.7   
1               0.2       0.03         4         0.8   
2               0.7       0.01         5         0.9   

                   model_ids             logloss  
0  gbm_grid_binomial_model_3   0.667209869083727  
1  gbm_grid_binomial_model_2  0.6742791229554091  
2  gbm_grid_binomial_model_1  0.6770690446978346  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train a stacked ensemble using the GBM grid</span>
<span class="n">ensemble</span> <span class="o">=</span> <span class="n">H2OStackedEnsembleEstimator</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="s2">&quot;my_ensemble_gbm_grid_binomial&quot;</span><span class="p">,</span>
                                       <span class="n">base_models</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">model_ids</span><span class="p">)</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>

<span class="c1"># Eval ensemble performance on the test data</span>
<span class="n">perf_stack_test</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># Compare to base learner performance on the test set</span>
<span class="n">baselearner_best_auc_test</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">h2o</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test_data</span><span class="o">=</span><span class="n">test</span><span class="p">)</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">model_ids</span><span class="p">])</span>
<span class="n">stack_auc_test</span> <span class="o">=</span> <span class="n">perf_stack_test</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Base-learner Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">baselearner_best_auc_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack_auc_test</span><span class="p">))</span>

<span class="c1"># Generate predictions on a test set (if neccessary)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stackedensemble Model Build progress: |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>██████████████████████████████████████████| (done) 100%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Base-learner Test AUC:  0.748146530400473
Ensemble Test AUC:  0.7510921003414699
stackedensemble prediction progress: |███████████████████████████████████████████| (done) 100%
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-learning-basics">
<h2>Deep learning basics<a class="headerlink" href="#deep-learning-basics" title="Permalink to this headline">¶</a></h2>
<p>Deep learning is a subfield of machine learning that uses a variety of multi-layered artificial neural networks to model datasets and predict outcomes. Deep learning is ideal for numeric, text, image, video, and sound data because deep representative networks store these data as large matrices and recycle error to make better predictions during the next epoch.</p>
<p>To understand deep networks, let’s start with a toy example of a single feed forward neural network - a perceptron.</p>
<p>Read Goodfellow et al’s Deep Learning Book to learn more: <a class="reference external" href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate toy dataset</span>
<span class="n">example</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
           <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
           <span class="s1">&#39;xm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span>
           <span class="p">}</span>
<span class="n">example_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">example</span><span class="p">)</span>
<span class="n">example_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">g</span><span class="o">/</span><span class="n">fhnd1v790cj5ccxlv4rcvsy40000gq</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_59292</span><span class="o">/</span><span class="mf">2635824310.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>            <span class="p">}</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">example_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">example</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">example_df</span>

<span class="ne">NameError</span>: name &#39;pd&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><img alt="perceptron" src="../_images/perceptron.png" /></p>
<p>Perceptron figure modified from <a class="reference external" href="https://sebastianraschka.com/Articles/2015_singlelayer_neurons.html">Sebastian Raschka’s Single-Layer Neural Networks and Gradient Descent</a></p>
<p>Perceptron key terms:</p>
<ul class="simple">
<li><p><strong>Layer:</strong> the network typology of a deep learning model, usually divided into variations of input, hidden, preprocessing, encoder/decoder, and output.</p></li>
<li><p><strong>Inputs:</strong> the features/covariates for a single observation. These are just the individual cells in a dataframe (the 1’s and 0s from <code class="docutils literal notranslate"><span class="pre">example_df</span></code> above), but they could be words from a text or pixels from an image.</p></li>
<li><p><strong>Weights:</strong> the learnable parameters of a model that connect the input layer to the output via the net input (summation) and activation functions.</p></li>
<li><p><strong>Bias term:</strong> A placeholder “1” assures that we do not receive 0 outputs by default.</p></li>
<li><p><strong>Net input function:</strong> computes the weighted sum of the input layer.</p></li>
<li><p><strong>Activation function:</strong> determine if a neuron should be fired or not. In binary classification for example, this means should a 1 or 0 be output?</p></li>
<li><p>Output: one node that contains the y prediction</p></li>
<li><p><strong>Error:</strong> how far off an output prediction was. The weights can be updated by adjusting the learning rate based on the error to reduce it for the next epoch</p></li>
</ul>
</section>
<section id="what-makes-a-network-deep">
<h2>What makes a network “deep”?<a class="headerlink" href="#what-makes-a-network-deep" title="Permalink to this headline">¶</a></h2>
<p>A “deep” network is just network with multiple/many hidden layers for handling potential nonlinear transformations.</p>
<ul class="simple">
<li><p>Fully connected layer: a layer where all nodes are connected to every node in the next layer (as indicated by the purple arrows</p></li>
</ul>
<p><img alt="deep" src="../_images/deep.png" /></p>
<p>Example of “deep” network with two hidden layers modified from <a class="reference external" href="https://devskrol.com/2020/11/22/388/">DevSkrol’s Artificial Neural Network Explained with an Regression Example</a></p>
<blockquote>
<div><p>NOTE: Bias term not shown for some reason!</p>
</div></blockquote>
<p>Let’s go through François Chollet’s “Image classification from scratch” <a class="reference external" href="https://keras.io/examples/vision/image_classification_from_scratch/">tutorial</a> to examine this architecture to predict images of cats versus dogs.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/keras-team/keras-io/blob/master/examples/vision/ipynb/image_classification_from_scratch.ipynb">Click here to open the Colab notebook</a></p>
<p>You should also check out his deep learning book! <a class="reference external" href="https://www.manning.com/books/deep-learning-with-python-second-edition">https://www.manning.com/books/deep-learning-with-python-second-edition</a></p>
<p><img alt="dogcat" src="../_images/dogcat.jpg" /></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "EastBayEv/SSDS-TAML",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./winter2022"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Chapter4.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Chapter 4 - The BERT algorithm</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Chapter6.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Chapter 6 - Writing about numeric data</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Software and Services for Data Science (SSDS) at Stanford Libraries<br/>
        
            &copy; Copyright 2021-2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>