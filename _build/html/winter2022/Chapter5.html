
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 5 - Ensemble machine learning, deep learning &#8212; Text Analysis and Machine Learning (TAML) Group</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 6 - Writing about numeric data" href="Chapter6.html" />
    <link rel="prev" title="Chapter 4 - The BERT algorithm" href="Chapter4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Text Analysis and Machine Learning (TAML) Group</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to TAML!
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="how_to.html">
   i. How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="start.html">
   ii. Start coding!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boiler.html">
   iii. Boilerplate code review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrangle.html">
   iv. Numeric data wrangling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="viz.html">
   v. Visualization essentials
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Winter Quarter 2022
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter1.html">
   Chapter 1 - English text preprocessing basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter2.html">
   Chapter 2 - Core machine learning concepts; building text vocabularies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter3.html">
   Chapter 3 - Document encoding (TF-IDF), topic modeling, sentiment analysis, building text classifiers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter4.html">
   Chapter 4 - The BERT algorithm
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 5 - Ensemble machine learning, deep learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter6.html">
   Chapter 6 - Writing about numeric data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter7.html">
   Chapter 7 - Combine the basics in powerful ways!
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="resources.html">
   Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Launch JupyterLab in Binder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Guest_Speakers.html">
   Guest Speakers
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/winter2022/Chapter5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/EastBayEv/SSDS-TAML"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/EastBayEv/SSDS-TAML/issues/new?title=Issue%20on%20page%20%2Fwinter2022/Chapter5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/EastBayEv/SSDS-TAML/master?urlpath=tree/winter2022/Chapter5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensemble-machine-learning">
   Ensemble machine learning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#h2o-superlearner-ensemble">
   H2O SuperLearner ensemble
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-higgs-boson">
   What is the Higgs Boson?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-h2o-and-java">
     Install h2o and Java
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import">
     Import
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialize-an-h2o-cluster">
     Initialize an h2o cluster
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-a-sample-binary-outcome-train-test-set-into-h2o">
     Import a sample binary outcome train/test set into H2O
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-predictors-and-response">
     Identify predictors and response
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-binary-classification-response-should-be-a-factor">
     For binary classification, response should be a factor
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-cv-folds-to-generate-level-one-data-for-stacking">
     Number of CV folds (to generate level-one data for stacking)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-stack">
     How to stack
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generate-a-2-model-ensemble">
   1. Generate a 2-model ensemble
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-and-cross-validate-a-random-forest">
     Train and cross-validate a random forest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-forest-test-set-performance">
     Random forest test set performance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-and-cross-validate-a-gradient-boosted-machine">
     Train and cross-validate a gradient boosted machine
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-boosted-machine-test-set-performance">
     Gradient boosted machine test set performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-a-stacked-ensemble-using-the-gbm-and-rf-above">
   3. Train a stacked ensemble using the GBM and RF above
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ensemble-performance-on-test-set">
     Ensemble performance on test set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-base-learner-performance-on-the-test-set">
     Compare to base learner performance on the test set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-predictions-on-a-test-set-if-neccessary">
     Generate predictions on a test set (if neccessary)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generate-a-random-grid-of-models-and-stack-them-together">
   4. Generate a random grid of models and stack them together
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specify-gbm-hyperparameters-for-the-grid">
     Specify GBM hyperparameters for the grid
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-a-stacked-ensemble-using-the-gbm-grid">
   5. Train a stacked ensemble using the GBM grid
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eval-ensemble-performance-on-the-test-data">
     Eval ensemble performance on the test data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   6. Compare to base learner performance on the test set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Generate predictions on a test set (if neccessary)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deep-learning-basics">
   Deep learning basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-human-brain-model-key-terms">
     The human brain model key terms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#information-transfer-in-the-human-brain">
     Information transfer in the human brain
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#are-deep-neural-networks-really-like-the-human-brain">
   Are deep neural networks really like the human brain?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-deep-learning">
   Why deep learning?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-makes-a-network-deep">
   What makes a network “deep”?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#classify-images-of-cats-and-dogs">
   Classify images of cats and dogs
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-5-ensemble-machine-learning-deep-learning">
<h1>Chapter 5 - Ensemble machine learning, deep learning<a class="headerlink" href="#chapter-5-ensemble-machine-learning-deep-learning" title="Permalink to this headline">¶</a></h1>
<p>2022 February 23</p>
<p><img alt="kandc" src="../_images/kandc.jpg" /></p>
<p><a class="reference external" href="https://www.texasmonthly.com/the-daily-post/music-monday-uncovering-the-mystery-of-the-king-carter-jazzing-orchestra/">Texas Monthly, Music Monday: Uncovering The Mystery Of The King &amp; Carter Jazzing Orchestra</a></p>
<section id="ensemble-machine-learning">
<h2>Ensemble machine learning<a class="headerlink" href="#ensemble-machine-learning" title="Permalink to this headline">¶</a></h2>
<p>“Ensemble machine learning methods use multiple learning algorithms to obtain better predictive performance than could be obtained from any of the constituent learning algorithms.” <a class="reference external" href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html">H2O.ai ensemble example</a></p>
<p>In this manner, stacking/SuperLearner ensembles are powerful tools because they:</p>
<ol class="simple">
<li><p>Eliminates bias of single algorithm selection for framing a research problem.</p></li>
<li><p>Allows for comparison of multiple algorithms, and/or comparison of the same model but tuned in many different ways.</p></li>
<li><p>Utilizes a second-level algorithm that produces an ideal weighted prediction that is suitable for data of virtually all distributions and uses external cross-validation to prevent overfitting.</p></li>
</ol>
<p>The below example utilizes the h2o package, and requires Java to be installed on your machine.</p>
<ul class="simple">
<li><p>install Java: <a class="reference external" href="https://www.java.com/en/download/help/mac_install.html">https://www.java.com/en/download/help/mac_install.html</a></p></li>
<li><p>h2o SuperLearner example: <a class="reference external" href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html">https://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html</a></p></li>
</ul>
<p>Check out some other tutorials:</p>
<ul class="simple">
<li><p>Python mlens library: <a class="reference external" href="https://mlens.readthedocs.io/en/0.1.x/install/">https://mlens.readthedocs.io/en/0.1.x/install/</a></p></li>
<li><p>Machine Learning Mastery: <a class="reference external" href="https://machinelearningmastery.com/super-learner-ensemble-in-python/">https://machinelearningmastery.com/super-learner-ensemble-in-python/</a></p></li>
<li><p>KDNuggets: <a class="reference external" href="https://www.kdnuggets.com/2018/02/introduction-python-ensembles.html/2#comments">https://www.kdnuggets.com/2018/02/introduction-python-ensembles.html/2#comments</a></p></li>
</ul>
<p>The quintessential R guide:</p>
<ul class="simple">
<li><p>Guide to SuperLearner: <a class="reference external" href="https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html">https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html</a></p></li>
</ul>
<p>Read the papers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.degruyter.com/document/doi/10.2202/1544-6115.1309/html">Van der Laan, M.J.; Polley, E.C.; Hubbard, A.E. Super Learner. Stat. Appl. Genet. Mol. Biol. 2007, 6, 1–21.</a></p></li>
<li><p><a class="reference external" href="https://biostats.bepress.com/ucbbiostat/paper266">Polley, E.C.; van der Laan, M.J. Super Learner in Prediction, UC Berkeley Division of Biostatistics Working Paper Series Paper 266.</a></p></li>
</ul>
</section>
<section id="h2o-superlearner-ensemble">
<h2>H2O SuperLearner ensemble<a class="headerlink" href="#h2o-superlearner-ensemble" title="Permalink to this headline">¶</a></h2>
<p>Use machine learning ensembles to detect whether or not (simulated) particle collisions produce the Higgs Boson particle or not. Learn more about the data: <a class="reference external" href="https://www.kaggle.com/c/higgs/overview">https://www.kaggle.com/c/higgs/overview</a></p>
</section>
<section id="what-is-the-higgs-boson">
<h2>What is the Higgs Boson?<a class="headerlink" href="#what-is-the-higgs-boson" title="Permalink to this headline">¶</a></h2>
<p>“The Higgs boson is the fundamental particle associated with the Higgs field, a field that gives mass to other fundamental particles such as electrons and quarks. A particle’s mass determines how much it resists changing its speed or position when it encounters a force. Not all fundamental particles have mass. The photon, which is the particle of light and carries the electromagnetic force, has no mass at all.” (<a class="reference external" href="https://www.energy.gov/science/doe-explainsthe-higgs-boson">https://www.energy.gov/science/doe-explainsthe-higgs-boson</a>)</p>
<p><img alt="hb" src="../_images/hb.png" /></p>
<section id="install-h2o-and-java">
<h3>Install h2o and Java<a class="headerlink" href="#install-h2o-and-java" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !pip install h2o</span>

<span class="c1"># Requires install of Java</span>
<span class="c1"># https://www.java.com/en/download/help/mac_install.html</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import">
<h3>Import<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.random_forest</span> <span class="kn">import</span> <span class="n">H2ORandomForestEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.gbm</span> <span class="kn">import</span> <span class="n">H2OGradientBoostingEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.glm</span> <span class="kn">import</span> <span class="n">H2OGeneralizedLinearEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.stackedensemble</span> <span class="kn">import</span> <span class="n">H2OStackedEnsembleEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.grid.grid_search</span> <span class="kn">import</span> <span class="n">H2OGridSearch</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="c1"># turn off progress bars</span>
<span class="n">h2o</span><span class="o">.</span><span class="n">no_progress</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-an-h2o-cluster">
<h3>Initialize an h2o cluster<a class="headerlink" href="#initialize-an-h2o-cluster" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h2o</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">nthreads</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_mem_size</span><span class="o">=</span><span class="s1">&#39;2G&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Checking whether there is an H2O instance running at http://localhost:54321 .
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> not found.
Attempting to start a local H2O server...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Java Version: java version &quot;1.8.0_321&quot;; Java(TM) SE Runtime Environment (build 1.8.0_321-b07); Java HotSpot(TM) 64-Bit Server VM (build 25.321-b07, mixed mode)
  Starting server from /Users/evanmuzzall/opt/anaconda3/lib/python3.8/site-packages/h2o/backend/bin/h2o.jar
  Ice root: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpphj7aa44
  JVM stdout: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpphj7aa44/h2o_evanmuzzall_started_from_python.out
  JVM stderr: /var/folders/9g/fhnd1v790cj5ccxlv4rcvsy40000gq/T/tmpphj7aa44/h2o_evanmuzzall_started_from_python.err
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> successful.
Warning: Your H2O cluster version is too old (5 months and 20 days)!Please download and install the latest version from http://h2o.ai/download/
</pre></div>
</div>
<div class="output text_html"><div style="overflow:auto"><table style="width:50%"><tr><td>H2O_cluster_uptime:</td>
<td>03 secs</td></tr>
<tr><td>H2O_cluster_timezone:</td>
<td>America/Los_Angeles</td></tr>
<tr><td>H2O_data_parsing_timezone:</td>
<td>UTC</td></tr>
<tr><td>H2O_cluster_version:</td>
<td>3.34.0.1</td></tr>
<tr><td>H2O_cluster_version_age:</td>
<td>5 months and 20 days !!!</td></tr>
<tr><td>H2O_cluster_name:</td>
<td>H2O_from_python_evanmuzzall_5t6sri</td></tr>
<tr><td>H2O_cluster_total_nodes:</td>
<td>1</td></tr>
<tr><td>H2O_cluster_free_memory:</td>
<td>1.778 Gb</td></tr>
<tr><td>H2O_cluster_total_cores:</td>
<td>16</td></tr>
<tr><td>H2O_cluster_allowed_cores:</td>
<td>16</td></tr>
<tr><td>H2O_cluster_status:</td>
<td>locked, healthy</td></tr>
<tr><td>H2O_connection_url:</td>
<td>http://127.0.0.1:54321</td></tr>
<tr><td>H2O_connection_proxy:</td>
<td>{"http": null, "https": null}</td></tr>
<tr><td>H2O_internal_security:</td>
<td>False</td></tr>
<tr><td>H2O_API_Extensions:</td>
<td>Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4</td></tr>
<tr><td>Python_version:</td>
<td>3.8.8 final</td></tr></table></div></div></div>
</div>
</section>
<section id="import-a-sample-binary-outcome-train-test-set-into-h2o">
<h3>Import a sample binary outcome train/test set into H2O<a class="headerlink" href="#import-a-sample-binary-outcome-train-test-set-into-h2o" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://s3.amazonaws.com/erin-data/higgs/higgs_train_10k.csv&quot;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://s3.amazonaws.com/erin-data/higgs/higgs_test_5k.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">  response</th><th style="text-align: right;">      x1</th><th style="text-align: right;">       x2</th><th style="text-align: right;">         x3</th><th style="text-align: right;">      x4</th><th style="text-align: right;">       x5</th><th style="text-align: right;">      x6</th><th style="text-align: right;">        x7</th><th style="text-align: right;">        x8</th><th style="text-align: right;">     x9</th><th style="text-align: right;">     x10</th><th style="text-align: right;">      x11</th><th style="text-align: right;">      x12</th><th style="text-align: right;">    x13</th><th style="text-align: right;">     x14</th><th style="text-align: right;">       x15</th><th style="text-align: right;">      x16</th><th style="text-align: right;">    x17</th><th style="text-align: right;">     x18</th><th style="text-align: right;">       x19</th><th style="text-align: right;">        x20</th><th style="text-align: right;">    x21</th><th style="text-align: right;">     x22</th><th style="text-align: right;">     x23</th><th style="text-align: right;">     x24</th><th style="text-align: right;">     x25</th><th style="text-align: right;">     x26</th><th style="text-align: right;">     x27</th><th style="text-align: right;">     x28</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.869293</td><td style="text-align: right;">-0.635082</td><td style="text-align: right;"> 0.22569   </td><td style="text-align: right;">0.32747 </td><td style="text-align: right;">-0.689993</td><td style="text-align: right;">0.754202</td><td style="text-align: right;">-0.248573 </td><td style="text-align: right;">-1.09206  </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.37499 </td><td style="text-align: right;">-0.653674</td><td style="text-align: right;"> 0.930349</td><td style="text-align: right;">1.10744</td><td style="text-align: right;">1.1389  </td><td style="text-align: right;">-1.5782   </td><td style="text-align: right;">-1.04699 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.65793 </td><td style="text-align: right;">-0.0104546</td><td style="text-align: right;">-0.0457672 </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">1.35376 </td><td style="text-align: right;">0.979563</td><td style="text-align: right;">0.978076</td><td style="text-align: right;">0.920005</td><td style="text-align: right;">0.721657</td><td style="text-align: right;">0.988751</td><td style="text-align: right;">0.876678</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.907542</td><td style="text-align: right;"> 0.329147</td><td style="text-align: right;"> 0.359412  </td><td style="text-align: right;">1.49797 </td><td style="text-align: right;">-0.31301 </td><td style="text-align: right;">1.09553 </td><td style="text-align: right;">-0.557525 </td><td style="text-align: right;">-1.58823  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.812581</td><td style="text-align: right;">-0.213642</td><td style="text-align: right;"> 1.27101 </td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.499994</td><td style="text-align: right;">-1.26143  </td><td style="text-align: right;"> 0.732156</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.398701</td><td style="text-align: right;">-1.13893  </td><td style="text-align: right;">-0.00081911</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.30222 </td><td style="text-align: right;">0.833048</td><td style="text-align: right;">0.9857  </td><td style="text-align: right;">0.978098</td><td style="text-align: right;">0.779732</td><td style="text-align: right;">0.992356</td><td style="text-align: right;">0.798343</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.798835</td><td style="text-align: right;"> 1.47064 </td><td style="text-align: right;">-1.63597   </td><td style="text-align: right;">0.453773</td><td style="text-align: right;"> 0.425629</td><td style="text-align: right;">1.10487 </td><td style="text-align: right;"> 1.28232  </td><td style="text-align: right;"> 1.38166  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.851737</td><td style="text-align: right;"> 1.54066 </td><td style="text-align: right;">-0.81969 </td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.99349 </td><td style="text-align: right;"> 0.35608  </td><td style="text-align: right;">-0.208778</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.25695 </td><td style="text-align: right;"> 1.12885  </td><td style="text-align: right;"> 0.900461  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.909753</td><td style="text-align: right;">1.10833 </td><td style="text-align: right;">0.985692</td><td style="text-align: right;">0.951331</td><td style="text-align: right;">0.803252</td><td style="text-align: right;">0.865924</td><td style="text-align: right;">0.780118</td></tr>
<tr><td style="text-align: right;">         0</td><td style="text-align: right;">1.34438 </td><td style="text-align: right;">-0.876626</td><td style="text-align: right;"> 0.935913  </td><td style="text-align: right;">1.99205 </td><td style="text-align: right;"> 0.882454</td><td style="text-align: right;">1.78607 </td><td style="text-align: right;">-1.64678  </td><td style="text-align: right;">-0.942383 </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.42326 </td><td style="text-align: right;">-0.676016</td><td style="text-align: right;"> 0.736159</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">1.29872 </td><td style="text-align: right;">-1.43074  </td><td style="text-align: right;">-0.364658</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.745313</td><td style="text-align: right;">-0.678379 </td><td style="text-align: right;">-1.36036   </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.946652</td><td style="text-align: right;">1.0287  </td><td style="text-align: right;">0.998656</td><td style="text-align: right;">0.728281</td><td style="text-align: right;">0.8692  </td><td style="text-align: right;">1.02674 </td><td style="text-align: right;">0.957904</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.10501 </td><td style="text-align: right;"> 0.321356</td><td style="text-align: right;"> 1.5224    </td><td style="text-align: right;">0.882808</td><td style="text-align: right;">-1.20535 </td><td style="text-align: right;">0.681466</td><td style="text-align: right;">-1.07046  </td><td style="text-align: right;">-0.921871 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.800872</td><td style="text-align: right;"> 1.02097 </td><td style="text-align: right;"> 0.971407</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">0.596761</td><td style="text-align: right;">-0.350273 </td><td style="text-align: right;"> 0.631194</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.479999</td><td style="text-align: right;">-0.373566 </td><td style="text-align: right;"> 0.113041  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.755856</td><td style="text-align: right;">1.36106 </td><td style="text-align: right;">0.98661 </td><td style="text-align: right;">0.838085</td><td style="text-align: right;">1.1333  </td><td style="text-align: right;">0.872245</td><td style="text-align: right;">0.808487</td></tr>
<tr><td style="text-align: right;">         0</td><td style="text-align: right;">1.59584 </td><td style="text-align: right;">-0.607811</td><td style="text-align: right;"> 0.00707492</td><td style="text-align: right;">1.81845 </td><td style="text-align: right;">-0.111906</td><td style="text-align: right;">0.84755 </td><td style="text-align: right;">-0.566437 </td><td style="text-align: right;"> 1.58124  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.755421</td><td style="text-align: right;"> 0.64311 </td><td style="text-align: right;"> 1.42637 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.921661</td><td style="text-align: right;">-1.19043  </td><td style="text-align: right;">-1.61559 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.651114</td><td style="text-align: right;">-0.654227 </td><td style="text-align: right;">-1.27434   </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">0.823761</td><td style="text-align: right;">0.938191</td><td style="text-align: right;">0.971758</td><td style="text-align: right;">0.789176</td><td style="text-align: right;">0.430553</td><td style="text-align: right;">0.961357</td><td style="text-align: right;">0.957818</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.409391</td><td style="text-align: right;">-1.88468 </td><td style="text-align: right;">-1.02729   </td><td style="text-align: right;">1.67245 </td><td style="text-align: right;">-1.6046  </td><td style="text-align: right;">1.33801 </td><td style="text-align: right;"> 0.0554274</td><td style="text-align: right;"> 0.0134659</td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.509783</td><td style="text-align: right;">-1.03834 </td><td style="text-align: right;"> 0.707862</td><td style="text-align: right;">0      </td><td style="text-align: right;">0.746918</td><td style="text-align: right;">-0.358465 </td><td style="text-align: right;">-1.64665 </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.367058</td><td style="text-align: right;"> 0.0694965</td><td style="text-align: right;"> 1.37713   </td><td style="text-align: right;">3.10196</td><td style="text-align: right;">0.869418</td><td style="text-align: right;">1.22208 </td><td style="text-align: right;">1.00063 </td><td style="text-align: right;">0.545045</td><td style="text-align: right;">0.698653</td><td style="text-align: right;">0.977314</td><td style="text-align: right;">0.828786</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">0.933895</td><td style="text-align: right;"> 0.62913 </td><td style="text-align: right;"> 0.527535  </td><td style="text-align: right;">0.238033</td><td style="text-align: right;">-0.966569</td><td style="text-align: right;">0.547811</td><td style="text-align: right;">-0.0594392</td><td style="text-align: right;">-1.70687  </td><td style="text-align: right;">2.17308</td><td style="text-align: right;">0.941003</td><td style="text-align: right;">-2.65373 </td><td style="text-align: right;">-0.15722 </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.03037 </td><td style="text-align: right;">-0.175505 </td><td style="text-align: right;"> 0.523021</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.37355 </td><td style="text-align: right;"> 1.29125  </td><td style="text-align: right;">-1.46745   </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.901837</td><td style="text-align: right;">1.08367 </td><td style="text-align: right;">0.979696</td><td style="text-align: right;">0.7833  </td><td style="text-align: right;">0.849195</td><td style="text-align: right;">0.894356</td><td style="text-align: right;">0.774879</td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.40514 </td><td style="text-align: right;"> 0.536603</td><td style="text-align: right;"> 0.689554  </td><td style="text-align: right;">1.17957 </td><td style="text-align: right;">-0.110061</td><td style="text-align: right;">3.2024  </td><td style="text-align: right;">-1.52696  </td><td style="text-align: right;">-1.57603  </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.93154 </td><td style="text-align: right;"> 0.567342</td><td style="text-align: right;">-0.130033</td><td style="text-align: right;">2.21487</td><td style="text-align: right;">1.78712 </td><td style="text-align: right;"> 0.899499 </td><td style="text-align: right;"> 0.585151</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">0.401865</td><td style="text-align: right;">-0.151202 </td><td style="text-align: right;"> 1.16349   </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.66707 </td><td style="text-align: right;">4.03927 </td><td style="text-align: right;">1.17583 </td><td style="text-align: right;">1.04535 </td><td style="text-align: right;">1.54297 </td><td style="text-align: right;">3.53483 </td><td style="text-align: right;">2.74075 </td></tr>
<tr><td style="text-align: right;">         1</td><td style="text-align: right;">1.17657 </td><td style="text-align: right;"> 0.104161</td><td style="text-align: right;"> 1.397     </td><td style="text-align: right;">0.479721</td><td style="text-align: right;"> 0.265513</td><td style="text-align: right;">1.13556 </td><td style="text-align: right;"> 1.53483  </td><td style="text-align: right;">-0.253291 </td><td style="text-align: right;">0      </td><td style="text-align: right;">1.02725 </td><td style="text-align: right;"> 0.534316</td><td style="text-align: right;"> 1.18002 </td><td style="text-align: right;">0      </td><td style="text-align: right;">2.40566 </td><td style="text-align: right;"> 0.0875568</td><td style="text-align: right;">-0.976534</td><td style="text-align: right;">2.54822</td><td style="text-align: right;">1.25038 </td><td style="text-align: right;"> 0.268541 </td><td style="text-align: right;"> 0.530334  </td><td style="text-align: right;">0      </td><td style="text-align: right;">0.833175</td><td style="text-align: right;">0.773968</td><td style="text-align: right;">0.98575 </td><td style="text-align: right;">1.1037  </td><td style="text-align: right;">0.84914 </td><td style="text-align: right;">0.937104</td><td style="text-align: right;">0.812364</td></tr>
</tbody>
</table></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10000, 29)
(5000, 29)
</pre></div>
</div>
</div>
</div>
</section>
<section id="identify-predictors-and-response">
<h3>Identify predictors and response<a class="headerlink" href="#identify-predictors-and-response" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;response&quot;</span>
<span class="n">x</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="for-binary-classification-response-should-be-a-factor">
<h3>For binary classification, response should be a factor<a class="headerlink" href="#for-binary-classification-response-should-be-a-factor" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="number-of-cv-folds-to-generate-level-one-data-for-stacking">
<h3>Number of CV folds (to generate level-one data for stacking)<a class="headerlink" href="#number-of-cv-folds-to-generate-level-one-data-for-stacking" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nfolds</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-to-stack">
<h3>How to stack<a class="headerlink" href="#how-to-stack" title="Permalink to this headline">¶</a></h3>
<p>There are a few ways to assemble a list of models to stack together:</p>
<ol class="simple">
<li><p>Train individual models and put them in a list</p></li>
<li><p>Train a grid of models</p></li>
<li><p>Train several grids of models</p></li>
</ol>
<blockquote>
<div><p>Note: All base models must have the same cross-validation folds and the cross-validated predicted values must be kept.</p>
</div></blockquote>
</section>
</section>
<section id="generate-a-2-model-ensemble">
<h2>1. Generate a 2-model ensemble<a class="headerlink" href="#generate-a-2-model-ensemble" title="Permalink to this headline">¶</a></h2>
<p>Use three algorithms:</p>
<ol class="simple">
<li><p>random forest</p></li>
<li><p>gradient boosted machine</p></li>
<li><p>lasso</p></li>
</ol>
<p>TODO: add RF and GBM defining characteristics</p>
<p>TODO: show how changing hyperparamters randomly can lead to overfitting (specifically # trees)</p>
<section id="train-and-cross-validate-a-random-forest">
<h3>Train and cross-validate a random forest<a class="headerlink" href="#train-and-cross-validate-a-random-forest" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf</span> <span class="o">=</span> <span class="n">H2ORandomForestEstimator</span><span class="p">(</span><span class="n">ntrees</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                              <span class="n">nfolds</span> <span class="o">=</span> <span class="n">nfolds</span><span class="p">,</span>
                              <span class="n">fold_assignment</span> <span class="o">=</span> <span class="s1">&#39;Modulo&#39;</span><span class="p">,</span>
                              <span class="n">keep_cross_validation_predictions</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                              <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rf</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2ORandomForestEstimator :  Distributed Random Forest
Model Key:  DRF_model_python_1646667754917_1


Model Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>100.0</td>
      <td>100.0</td>
      <td>1893916.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>1394.0</td>
      <td>1632.0</td>
      <td>1502.23</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: drf
** Reported on train data. **

MSE: 0.19950487132058212
RMSE: 0.446659681771908
LogLoss: 0.5827049508751073
Mean Per-Class Error: 0.30843686874008425
AUC: 0.7598007062584857
AUCPR: 0.7763300405428175
Gini: 0.5196014125169715

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4104450374569011: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2150.0</td>
      <td>2555.0</td>
      <td>0.543</td>
      <td>(2555.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>716.0</td>
      <td>4579.0</td>
      <td>0.1352</td>
      <td>(716.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2866.0</td>
      <td>7134.0</td>
      <td>0.3271</td>
      <td>(3271.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.410445</td>
      <td>0.736825</td>
      <td>260.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.239052</td>
      <td>0.855587</td>
      <td>344.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.555540</td>
      <td>0.715899</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.520387</td>
      <td>0.690300</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.999592</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.095129</td>
      <td>1.000000</td>
      <td>386.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.999592</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.555540</td>
      <td>0.384066</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.525615</td>
      <td>0.689896</td>
      <td>197.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.555540</td>
      <td>0.691563</td>
      <td>181.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.999592</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.999592</td>
      <td>5294.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.000000</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.095129</td>
      <td>5295.000000</td>
      <td>386.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.999592</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.999592</td>
      <td>0.999811</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.095129</td>
      <td>1.000000</td>
      <td>386.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.89 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0100</td>
      <td>0.925816</td>
      <td>1.794145</td>
      <td>1.794145</td>
      <td>0.950000</td>
      <td>0.947710</td>
      <td>0.950000</td>
      <td>0.947710</td>
      <td>0.017941</td>
      <td>0.017941</td>
      <td>79.414542</td>
      <td>79.414542</td>
      <td>0.016879</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0200</td>
      <td>0.896792</td>
      <td>1.850803</td>
      <td>1.822474</td>
      <td>0.980000</td>
      <td>0.909486</td>
      <td>0.965000</td>
      <td>0.928598</td>
      <td>0.018508</td>
      <td>0.036449</td>
      <td>85.080264</td>
      <td>82.247403</td>
      <td>0.034962</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0300</td>
      <td>0.875029</td>
      <td>1.813031</td>
      <td>1.819326</td>
      <td>0.960000</td>
      <td>0.885540</td>
      <td>0.963333</td>
      <td>0.914245</td>
      <td>0.018130</td>
      <td>0.054580</td>
      <td>81.303116</td>
      <td>81.932641</td>
      <td>0.052242</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0400</td>
      <td>0.857754</td>
      <td>1.718602</td>
      <td>1.794145</td>
      <td>0.910000</td>
      <td>0.866945</td>
      <td>0.950000</td>
      <td>0.902420</td>
      <td>0.017186</td>
      <td>0.071766</td>
      <td>71.860246</td>
      <td>79.414542</td>
      <td>0.067515</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0500</td>
      <td>0.843810</td>
      <td>1.680831</td>
      <td>1.771483</td>
      <td>0.890000</td>
      <td>0.851600</td>
      <td>0.938000</td>
      <td>0.892256</td>
      <td>0.016808</td>
      <td>0.088574</td>
      <td>68.083097</td>
      <td>77.148253</td>
      <td>0.081985</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1000</td>
      <td>0.788384</td>
      <td>1.582625</td>
      <td>1.677054</td>
      <td>0.838000</td>
      <td>0.814850</td>
      <td>0.888000</td>
      <td>0.853553</td>
      <td>0.079131</td>
      <td>0.167705</td>
      <td>58.262512</td>
      <td>67.705382</td>
      <td>0.143901</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1500</td>
      <td>0.745567</td>
      <td>1.571294</td>
      <td>1.641800</td>
      <td>0.832000</td>
      <td>0.766710</td>
      <td>0.869333</td>
      <td>0.824605</td>
      <td>0.078565</td>
      <td>0.246270</td>
      <td>57.129367</td>
      <td>64.180044</td>
      <td>0.204612</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2000</td>
      <td>0.704503</td>
      <td>1.412653</td>
      <td>1.584514</td>
      <td>0.748000</td>
      <td>0.724356</td>
      <td>0.839000</td>
      <td>0.799543</td>
      <td>0.070633</td>
      <td>0.316903</td>
      <td>41.265345</td>
      <td>58.451369</td>
      <td>0.248465</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3001</td>
      <td>0.641026</td>
      <td>1.352755</td>
      <td>1.507209</td>
      <td>0.716284</td>
      <td>0.672193</td>
      <td>0.798067</td>
      <td>0.757065</td>
      <td>0.135411</td>
      <td>0.452314</td>
      <td>35.275489</td>
      <td>50.720927</td>
      <td>0.323514</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.584336</td>
      <td>1.206116</td>
      <td>1.432011</td>
      <td>0.638639</td>
      <td>0.611509</td>
      <td>0.758250</td>
      <td>0.720712</td>
      <td>0.120491</td>
      <td>0.572805</td>
      <td>20.611641</td>
      <td>43.201133</td>
      <td>0.367278</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.529812</td>
      <td>1.046270</td>
      <td>1.354863</td>
      <td>0.554000</td>
      <td>0.556784</td>
      <td>0.717400</td>
      <td>0.687926</td>
      <td>0.104627</td>
      <td>0.677432</td>
      <td>4.627007</td>
      <td>35.486308</td>
      <td>0.377113</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6000</td>
      <td>0.474727</td>
      <td>0.914070</td>
      <td>1.281398</td>
      <td>0.484000</td>
      <td>0.503242</td>
      <td>0.678500</td>
      <td>0.657146</td>
      <td>0.091407</td>
      <td>0.768839</td>
      <td>-8.593012</td>
      <td>28.139754</td>
      <td>0.358849</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7000</td>
      <td>0.418589</td>
      <td>0.857413</td>
      <td>1.220828</td>
      <td>0.454000</td>
      <td>0.447953</td>
      <td>0.646429</td>
      <td>0.627261</td>
      <td>0.085741</td>
      <td>0.854580</td>
      <td>-14.258735</td>
      <td>22.082827</td>
      <td>0.328544</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8000</td>
      <td>0.353428</td>
      <td>0.672332</td>
      <td>1.152266</td>
      <td>0.356000</td>
      <td>0.386946</td>
      <td>0.610125</td>
      <td>0.597222</td>
      <td>0.067233</td>
      <td>0.921813</td>
      <td>-32.766761</td>
      <td>15.226629</td>
      <td>0.258901</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9004</td>
      <td>0.272727</td>
      <td>0.504121</td>
      <td>1.079994</td>
      <td>0.266932</td>
      <td>0.314339</td>
      <td>0.571857</td>
      <td>0.565678</td>
      <td>0.050614</td>
      <td>0.972427</td>
      <td>-49.587862</td>
      <td>7.999424</td>
      <td>0.153086</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.000000</td>
      <td>0.276839</td>
      <td>1.000000</td>
      <td>0.146586</td>
      <td>0.196359</td>
      <td>0.529500</td>
      <td>0.528894</td>
      <td>0.027573</td>
      <td>1.000000</td>
      <td>-72.316082</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: drf
** Reported on cross-validation data. **

MSE: 0.1978311557213644
RMSE: 0.44478214411255806
LogLoss: 0.579741500688161
Mean Per-Class Error: 0.2998532893000535
AUC: 0.7686270909034348
AUCPR: 0.7856172822797098
Gini: 0.5372541818068697

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.42006199163332014: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2190.0</td>
      <td>2515.0</td>
      <td>0.5345</td>
      <td>(2515.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>681.0</td>
      <td>4614.0</td>
      <td>0.1286</td>
      <td>(681.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2871.0</td>
      <td>7129.0</td>
      <td>0.3196</td>
      <td>(3196.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.420062</td>
      <td>0.742756</td>
      <td>267.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.235011</td>
      <td>0.855768</td>
      <td>355.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.560187</td>
      <td>0.726168</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.523067</td>
      <td>0.698300</td>
      <td>208.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.977268</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.130235</td>
      <td>1.000000</td>
      <td>385.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.977268</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.560187</td>
      <td>0.401916</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.523067</td>
      <td>0.698017</td>
      <td>208.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.555878</td>
      <td>0.700147</td>
      <td>189.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.977268</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.977268</td>
      <td>5294.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.020000</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.130235</td>
      <td>5295.000000</td>
      <td>385.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.977268</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.977268</td>
      <td>0.999811</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.020000</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.130235</td>
      <td>1.000000</td>
      <td>385.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.85 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0100</td>
      <td>0.889002</td>
      <td>1.813031</td>
      <td>1.813031</td>
      <td>0.960000</td>
      <td>0.914104</td>
      <td>0.960000</td>
      <td>0.914104</td>
      <td>0.018130</td>
      <td>0.018130</td>
      <td>81.303116</td>
      <td>81.303116</td>
      <td>0.017280</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0200</td>
      <td>0.866936</td>
      <td>1.831917</td>
      <td>1.822474</td>
      <td>0.970000</td>
      <td>0.877796</td>
      <td>0.965000</td>
      <td>0.895950</td>
      <td>0.018319</td>
      <td>0.036449</td>
      <td>83.191690</td>
      <td>82.247403</td>
      <td>0.034962</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0305</td>
      <td>0.850000</td>
      <td>1.780656</td>
      <td>1.808078</td>
      <td>0.942857</td>
      <td>0.857113</td>
      <td>0.957377</td>
      <td>0.882580</td>
      <td>0.018697</td>
      <td>0.055146</td>
      <td>78.065561</td>
      <td>80.807752</td>
      <td>0.052383</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0400</td>
      <td>0.836352</td>
      <td>1.749416</td>
      <td>1.794145</td>
      <td>0.926316</td>
      <td>0.843201</td>
      <td>0.950000</td>
      <td>0.873227</td>
      <td>0.016619</td>
      <td>0.071766</td>
      <td>74.941603</td>
      <td>79.414542</td>
      <td>0.067515</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0500</td>
      <td>0.823457</td>
      <td>1.718602</td>
      <td>1.779037</td>
      <td>0.910000</td>
      <td>0.829764</td>
      <td>0.942000</td>
      <td>0.864535</td>
      <td>0.017186</td>
      <td>0.088952</td>
      <td>71.860246</td>
      <td>77.903683</td>
      <td>0.082788</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1010</td>
      <td>0.770000</td>
      <td>1.655280</td>
      <td>1.716546</td>
      <td>0.876471</td>
      <td>0.793776</td>
      <td>0.908911</td>
      <td>0.828805</td>
      <td>0.084419</td>
      <td>0.173371</td>
      <td>65.527968</td>
      <td>71.654559</td>
      <td>0.153817</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1500</td>
      <td>0.729441</td>
      <td>1.518568</td>
      <td>1.651873</td>
      <td>0.804082</td>
      <td>0.748726</td>
      <td>0.874667</td>
      <td>0.802646</td>
      <td>0.074410</td>
      <td>0.247781</td>
      <td>51.856777</td>
      <td>65.187284</td>
      <td>0.207823</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2000</td>
      <td>0.694800</td>
      <td>1.431539</td>
      <td>1.596789</td>
      <td>0.758000</td>
      <td>0.711801</td>
      <td>0.845500</td>
      <td>0.779935</td>
      <td>0.071577</td>
      <td>0.319358</td>
      <td>43.153919</td>
      <td>59.678942</td>
      <td>0.253683</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3000</td>
      <td>0.636224</td>
      <td>1.371105</td>
      <td>1.521561</td>
      <td>0.726000</td>
      <td>0.665173</td>
      <td>0.805667</td>
      <td>0.741681</td>
      <td>0.137110</td>
      <td>0.456468</td>
      <td>37.110482</td>
      <td>52.156122</td>
      <td>0.332558</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4011</td>
      <td>0.580000</td>
      <td>1.232897</td>
      <td>1.448801</td>
      <td>0.652819</td>
      <td>0.607113</td>
      <td>0.767140</td>
      <td>0.707762</td>
      <td>0.124646</td>
      <td>0.581114</td>
      <td>23.289706</td>
      <td>44.880144</td>
      <td>0.382602</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.529246</td>
      <td>1.050269</td>
      <td>1.369972</td>
      <td>0.556117</td>
      <td>0.554347</td>
      <td>0.725400</td>
      <td>0.677416</td>
      <td>0.103872</td>
      <td>0.684986</td>
      <td>5.026873</td>
      <td>36.997167</td>
      <td>0.393169</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6001</td>
      <td>0.479333</td>
      <td>0.915043</td>
      <td>1.294087</td>
      <td>0.484515</td>
      <td>0.503495</td>
      <td>0.685219</td>
      <td>0.648405</td>
      <td>0.091596</td>
      <td>0.776582</td>
      <td>-8.495659</td>
      <td>29.408712</td>
      <td>0.375094</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7000</td>
      <td>0.427236</td>
      <td>0.846928</td>
      <td>1.230271</td>
      <td>0.448448</td>
      <td>0.452868</td>
      <td>0.651429</td>
      <td>0.620499</td>
      <td>0.084608</td>
      <td>0.861190</td>
      <td>-15.307186</td>
      <td>23.027115</td>
      <td>0.342593</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8000</td>
      <td>0.364682</td>
      <td>0.632672</td>
      <td>1.155571</td>
      <td>0.335000</td>
      <td>0.395935</td>
      <td>0.611875</td>
      <td>0.592429</td>
      <td>0.063267</td>
      <td>0.924457</td>
      <td>-36.732767</td>
      <td>15.557129</td>
      <td>0.264521</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9018</td>
      <td>0.290000</td>
      <td>0.480492</td>
      <td>1.079365</td>
      <td>0.254420</td>
      <td>0.328383</td>
      <td>0.571524</td>
      <td>0.562622</td>
      <td>0.048914</td>
      <td>0.973371</td>
      <td>-51.950815</td>
      <td>7.936472</td>
      <td>0.152117</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.020000</td>
      <td>0.271170</td>
      <td>1.000000</td>
      <td>0.143585</td>
      <td>0.215219</td>
      <td>0.529500</td>
      <td>0.528507</td>
      <td>0.026629</td>
      <td>1.000000</td>
      <td>-72.882999</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross-Validation Metrics Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>cv_1_valid</th>
      <th>cv_2_valid</th>
      <th>cv_3_valid</th>
      <th>cv_4_valid</th>
      <th>cv_5_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>accuracy</td>
      <td>0.684700</td>
      <td>0.009686</td>
      <td>0.688000</td>
      <td>0.683500</td>
      <td>0.668500</td>
      <td>0.691000</td>
      <td>0.692500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auc</td>
      <td>0.768961</td>
      <td>0.005747</td>
      <td>0.777448</td>
      <td>0.764756</td>
      <td>0.763700</td>
      <td>0.766779</td>
      <td>0.772118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>err</td>
      <td>0.315300</td>
      <td>0.009686</td>
      <td>0.312000</td>
      <td>0.316500</td>
      <td>0.331500</td>
      <td>0.309000</td>
      <td>0.307500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>err_count</td>
      <td>630.600000</td>
      <td>19.372662</td>
      <td>624.000000</td>
      <td>633.000000</td>
      <td>663.000000</td>
      <td>618.000000</td>
      <td>615.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f0point5</td>
      <td>0.686030</td>
      <td>0.008300</td>
      <td>0.687034</td>
      <td>0.684970</td>
      <td>0.677061</td>
      <td>0.699269</td>
      <td>0.681818</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f1</td>
      <td>0.744774</td>
      <td>0.007659</td>
      <td>0.747164</td>
      <td>0.753601</td>
      <td>0.741520</td>
      <td>0.748166</td>
      <td>0.733420</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f2</td>
      <td>0.814755</td>
      <td>0.016714</td>
      <td>0.818828</td>
      <td>0.837515</td>
      <td>0.819545</td>
      <td>0.804416</td>
      <td>0.793472</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lift_top_group</td>
      <td>1.815754</td>
      <td>0.126244</td>
      <td>1.897533</td>
      <td>1.775701</td>
      <td>1.760890</td>
      <td>1.660517</td>
      <td>1.984127</td>
    </tr>
    <tr>
      <th>8</th>
      <td>logloss</td>
      <td>0.579742</td>
      <td>0.004706</td>
      <td>0.571577</td>
      <td>0.581464</td>
      <td>0.582822</td>
      <td>0.582803</td>
      <td>0.580041</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max_per_class_error</td>
      <td>0.524409</td>
      <td>0.052263</td>
      <td>0.520085</td>
      <td>0.570968</td>
      <td>0.580890</td>
      <td>0.493450</td>
      <td>0.456653</td>
    </tr>
    <tr>
      <th>10</th>
      <td>mcc</td>
      <td>0.379194</td>
      <td>0.021935</td>
      <td>0.389069</td>
      <td>0.384129</td>
      <td>0.342742</td>
      <td>0.379066</td>
      <td>0.400963</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mean_per_class_accuracy</td>
      <td>0.672491</td>
      <td>0.015187</td>
      <td>0.677339</td>
      <td>0.666853</td>
      <td>0.650241</td>
      <td>0.676707</td>
      <td>0.691316</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mean_per_class_error</td>
      <td>0.327509</td>
      <td>0.015187</td>
      <td>0.322661</td>
      <td>0.333147</td>
      <td>0.349759</td>
      <td>0.323293</td>
      <td>0.308684</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mse</td>
      <td>0.197831</td>
      <td>0.001922</td>
      <td>0.194467</td>
      <td>0.198626</td>
      <td>0.199179</td>
      <td>0.198811</td>
      <td>0.198073</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pr_auc</td>
      <td>0.786175</td>
      <td>0.008145</td>
      <td>0.795368</td>
      <td>0.780520</td>
      <td>0.791291</td>
      <td>0.788378</td>
      <td>0.775318</td>
    </tr>
    <tr>
      <th>15</th>
      <td>precision</td>
      <td>0.651826</td>
      <td>0.011298</td>
      <td>0.652051</td>
      <td>0.645764</td>
      <td>0.639973</td>
      <td>0.670073</td>
      <td>0.651270</td>
    </tr>
    <tr>
      <th>16</th>
      <td>r2</td>
      <td>0.205297</td>
      <td>0.008929</td>
      <td>0.219856</td>
      <td>0.201582</td>
      <td>0.198281</td>
      <td>0.199106</td>
      <td>0.207659</td>
    </tr>
    <tr>
      <th>17</th>
      <td>recall</td>
      <td>0.869391</td>
      <td>0.026604</td>
      <td>0.874763</td>
      <td>0.904673</td>
      <td>0.881372</td>
      <td>0.846863</td>
      <td>0.839286</td>
    </tr>
    <tr>
      <th>18</th>
      <td>rmse</td>
      <td>0.444778</td>
      <td>0.002167</td>
      <td>0.440985</td>
      <td>0.445675</td>
      <td>0.446295</td>
      <td>0.445882</td>
      <td>0.445053</td>
    </tr>
    <tr>
      <th>19</th>
      <td>specificity</td>
      <td>0.475591</td>
      <td>0.052263</td>
      <td>0.479915</td>
      <td>0.429032</td>
      <td>0.419110</td>
      <td>0.506550</td>
      <td>0.543347</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scoring History: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>21.942 sec</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.008 sec</td>
      <td>1.0</td>
      <td>0.642818</td>
      <td>14.048395</td>
      <td>0.577384</td>
      <td>0.589593</td>
      <td>1.144218</td>
      <td>0.464917</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.052 sec</td>
      <td>2.0</td>
      <td>0.615404</td>
      <td>11.895281</td>
      <td>0.595767</td>
      <td>0.598674</td>
      <td>1.167648</td>
      <td>0.470126</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.086 sec</td>
      <td>3.0</td>
      <td>0.596109</td>
      <td>10.322973</td>
      <td>0.606984</td>
      <td>0.606263</td>
      <td>1.188141</td>
      <td>0.471944</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.120 sec</td>
      <td>4.0</td>
      <td>0.578952</td>
      <td>8.963477</td>
      <td>0.617051</td>
      <td>0.613281</td>
      <td>1.205225</td>
      <td>0.473260</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.151 sec</td>
      <td>5.0</td>
      <td>0.566757</td>
      <td>7.823122</td>
      <td>0.621447</td>
      <td>0.619131</td>
      <td>1.222342</td>
      <td>0.472650</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.181 sec</td>
      <td>6.0</td>
      <td>0.555494</td>
      <td>6.782681</td>
      <td>0.625539</td>
      <td>0.623303</td>
      <td>1.235544</td>
      <td>0.472576</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.213 sec</td>
      <td>7.0</td>
      <td>0.542668</td>
      <td>5.762143</td>
      <td>0.634190</td>
      <td>0.632386</td>
      <td>1.256193</td>
      <td>0.470778</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.246 sec</td>
      <td>8.0</td>
      <td>0.534223</td>
      <td>5.001247</td>
      <td>0.637938</td>
      <td>0.634830</td>
      <td>1.257749</td>
      <td>0.470999</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.277 sec</td>
      <td>9.0</td>
      <td>0.525930</td>
      <td>4.327270</td>
      <td>0.643458</td>
      <td>0.638581</td>
      <td>1.259426</td>
      <td>0.416980</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.318 sec</td>
      <td>10.0</td>
      <td>0.516709</td>
      <td>3.691988</td>
      <td>0.652861</td>
      <td>0.649779</td>
      <td>1.292382</td>
      <td>0.416650</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.351 sec</td>
      <td>11.0</td>
      <td>0.510283</td>
      <td>3.222738</td>
      <td>0.659091</td>
      <td>0.656853</td>
      <td>1.315126</td>
      <td>0.417606</td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.385 sec</td>
      <td>12.0</td>
      <td>0.501990</td>
      <td>2.723957</td>
      <td>0.669423</td>
      <td>0.667708</td>
      <td>1.341061</td>
      <td>0.422262</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.416 sec</td>
      <td>13.0</td>
      <td>0.496251</td>
      <td>2.349060</td>
      <td>0.675311</td>
      <td>0.675563</td>
      <td>1.374979</td>
      <td>0.405793</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.448 sec</td>
      <td>14.0</td>
      <td>0.492259</td>
      <td>2.050819</td>
      <td>0.679020</td>
      <td>0.680861</td>
      <td>1.408270</td>
      <td>0.405386</td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.477 sec</td>
      <td>15.0</td>
      <td>0.487936</td>
      <td>1.795128</td>
      <td>0.684347</td>
      <td>0.686164</td>
      <td>1.425637</td>
      <td>0.404943</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.506 sec</td>
      <td>16.0</td>
      <td>0.484170</td>
      <td>1.579896</td>
      <td>0.689326</td>
      <td>0.694656</td>
      <td>1.472602</td>
      <td>0.384615</td>
    </tr>
    <tr>
      <th>17</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.537 sec</td>
      <td>17.0</td>
      <td>0.480754</td>
      <td>1.424860</td>
      <td>0.693815</td>
      <td>0.699750</td>
      <td>1.494407</td>
      <td>0.400180</td>
    </tr>
    <tr>
      <th>18</th>
      <td></td>
      <td>2022-03-07 07:43:11</td>
      <td>22.572 sec</td>
      <td>18.0</td>
      <td>0.477989</td>
      <td>1.318464</td>
      <td>0.698239</td>
      <td>0.703253</td>
      <td>1.498109</td>
      <td>0.389139</td>
    </tr>
    <tr>
      <th>19</th>
      <td></td>
      <td>2022-03-07 07:43:12</td>
      <td>22.604 sec</td>
      <td>19.0</td>
      <td>0.475932</td>
      <td>1.215350</td>
      <td>0.701065</td>
      <td>0.707162</td>
      <td>1.521093</td>
      <td>0.391439</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()

Variable Importances: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>x26</td>
      <td>15628.322266</td>
      <td>1.000000</td>
      <td>0.101301</td>
    </tr>
    <tr>
      <th>1</th>
      <td>x28</td>
      <td>9415.993164</td>
      <td>0.602495</td>
      <td>0.061034</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x27</td>
      <td>9318.841797</td>
      <td>0.596279</td>
      <td>0.060404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>x6</td>
      <td>7188.417969</td>
      <td>0.459961</td>
      <td>0.046595</td>
    </tr>
    <tr>
      <th>4</th>
      <td>x25</td>
      <td>7121.043945</td>
      <td>0.455650</td>
      <td>0.046158</td>
    </tr>
    <tr>
      <th>5</th>
      <td>x23</td>
      <td>7112.994141</td>
      <td>0.455135</td>
      <td>0.046106</td>
    </tr>
    <tr>
      <th>6</th>
      <td>x4</td>
      <td>6268.571289</td>
      <td>0.401103</td>
      <td>0.040632</td>
    </tr>
    <tr>
      <th>7</th>
      <td>x1</td>
      <td>5769.832031</td>
      <td>0.369191</td>
      <td>0.037400</td>
    </tr>
    <tr>
      <th>8</th>
      <td>x10</td>
      <td>5658.928223</td>
      <td>0.362094</td>
      <td>0.036681</td>
    </tr>
    <tr>
      <th>9</th>
      <td>x2</td>
      <td>5388.754395</td>
      <td>0.344807</td>
      <td>0.034929</td>
    </tr>
    <tr>
      <th>10</th>
      <td>x7</td>
      <td>5388.225098</td>
      <td>0.344773</td>
      <td>0.034926</td>
    </tr>
    <tr>
      <th>11</th>
      <td>x19</td>
      <td>5345.022461</td>
      <td>0.342009</td>
      <td>0.034646</td>
    </tr>
    <tr>
      <th>12</th>
      <td>x12</td>
      <td>5334.650391</td>
      <td>0.341345</td>
      <td>0.034579</td>
    </tr>
    <tr>
      <th>13</th>
      <td>x5</td>
      <td>5298.523438</td>
      <td>0.339033</td>
      <td>0.034345</td>
    </tr>
    <tr>
      <th>14</th>
      <td>x20</td>
      <td>5295.863281</td>
      <td>0.338863</td>
      <td>0.034327</td>
    </tr>
    <tr>
      <th>15</th>
      <td>x16</td>
      <td>5240.296387</td>
      <td>0.335308</td>
      <td>0.033967</td>
    </tr>
    <tr>
      <th>16</th>
      <td>x3</td>
      <td>5225.997070</td>
      <td>0.334393</td>
      <td>0.033874</td>
    </tr>
    <tr>
      <th>17</th>
      <td>x8</td>
      <td>5220.911621</td>
      <td>0.334067</td>
      <td>0.033842</td>
    </tr>
    <tr>
      <th>18</th>
      <td>x15</td>
      <td>5183.947266</td>
      <td>0.331702</td>
      <td>0.033602</td>
    </tr>
    <tr>
      <th>19</th>
      <td>x11</td>
      <td>5183.041504</td>
      <td>0.331644</td>
      <td>0.033596</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest-test-set-performance">
<h3>Random forest test set performance<a class="headerlink" href="#random-forest-test-set-performance" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: drf
** Reported on test data. **

MSE: 0.19456237288967487
RMSE: 0.4410922498635346
LogLoss: 0.5723749503451226
Mean Per-Class Error: 0.2902132075244037
AUC: 0.7786910723119803
AUCPR: 0.8019489749908004
Gini: 0.5573821446239606

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.3900028567254543: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>957.0</td>
      <td>1358.0</td>
      <td>0.5866</td>
      <td>(1358.0/2315.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>280.0</td>
      <td>2405.0</td>
      <td>0.1043</td>
      <td>(280.0/2685.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>1237.0</td>
      <td>3763.0</td>
      <td>0.3276</td>
      <td>(1638.0/5000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.390003</td>
      <td>0.745968</td>
      <td>280.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.252355</td>
      <td>0.861172</td>
      <td>348.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.545964</td>
      <td>0.738321</td>
      <td>184.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.503137</td>
      <td>0.710400</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.976952</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.145391</td>
      <td>1.000000</td>
      <td>382.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.976952</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.515110</td>
      <td>0.418565</td>
      <td>204.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.513699</td>
      <td>0.709125</td>
      <td>205.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.515110</td>
      <td>0.709787</td>
      <td>204.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.976952</td>
      <td>2315.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.976952</td>
      <td>2684.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.040096</td>
      <td>2315.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.145391</td>
      <td>2685.000000</td>
      <td>382.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.976952</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.976952</td>
      <td>0.999628</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.040096</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.145391</td>
      <td>1.000000</td>
      <td>382.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 53.70 %, avg score: 52.30 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0100</td>
      <td>0.892945</td>
      <td>1.824953</td>
      <td>1.824953</td>
      <td>0.980000</td>
      <td>0.916686</td>
      <td>0.980000</td>
      <td>0.916686</td>
      <td>0.018250</td>
      <td>0.018250</td>
      <td>82.495345</td>
      <td>82.495345</td>
      <td>0.017818</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0200</td>
      <td>0.869782</td>
      <td>1.713222</td>
      <td>1.769088</td>
      <td>0.920000</td>
      <td>0.881167</td>
      <td>0.950000</td>
      <td>0.898926</td>
      <td>0.017132</td>
      <td>0.035382</td>
      <td>71.322160</td>
      <td>76.908752</td>
      <td>0.033222</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0300</td>
      <td>0.854788</td>
      <td>1.713222</td>
      <td>1.750466</td>
      <td>0.920000</td>
      <td>0.862835</td>
      <td>0.940000</td>
      <td>0.886896</td>
      <td>0.017132</td>
      <td>0.052514</td>
      <td>71.322160</td>
      <td>75.046555</td>
      <td>0.048626</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0400</td>
      <td>0.840256</td>
      <td>1.862197</td>
      <td>1.778399</td>
      <td>1.000000</td>
      <td>0.847272</td>
      <td>0.955000</td>
      <td>0.876990</td>
      <td>0.018622</td>
      <td>0.071136</td>
      <td>86.219739</td>
      <td>77.839851</td>
      <td>0.067248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0500</td>
      <td>0.827591</td>
      <td>1.787709</td>
      <td>1.780261</td>
      <td>0.960000</td>
      <td>0.833668</td>
      <td>0.956000</td>
      <td>0.868325</td>
      <td>0.017877</td>
      <td>0.089013</td>
      <td>78.770950</td>
      <td>78.026071</td>
      <td>0.084261</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1000</td>
      <td>0.771550</td>
      <td>1.623836</td>
      <td>1.702048</td>
      <td>0.872000</td>
      <td>0.797458</td>
      <td>0.914000</td>
      <td>0.832892</td>
      <td>0.081192</td>
      <td>0.170205</td>
      <td>62.383613</td>
      <td>70.204842</td>
      <td>0.151630</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1500</td>
      <td>0.726679</td>
      <td>1.646182</td>
      <td>1.683426</td>
      <td>0.884000</td>
      <td>0.748252</td>
      <td>0.904000</td>
      <td>0.804678</td>
      <td>0.082309</td>
      <td>0.252514</td>
      <td>64.618250</td>
      <td>68.342644</td>
      <td>0.221412</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2012</td>
      <td>0.690000</td>
      <td>1.498487</td>
      <td>1.636364</td>
      <td>0.804688</td>
      <td>0.706711</td>
      <td>0.878728</td>
      <td>0.779748</td>
      <td>0.076723</td>
      <td>0.329236</td>
      <td>49.848696</td>
      <td>63.636431</td>
      <td>0.276537</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3000</td>
      <td>0.628621</td>
      <td>1.368376</td>
      <td>1.548107</td>
      <td>0.734818</td>
      <td>0.658471</td>
      <td>0.831333</td>
      <td>0.739808</td>
      <td>0.135196</td>
      <td>0.464432</td>
      <td>36.837582</td>
      <td>54.810677</td>
      <td>0.355145</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.572950</td>
      <td>1.180633</td>
      <td>1.456238</td>
      <td>0.634000</td>
      <td>0.600572</td>
      <td>0.782000</td>
      <td>0.704999</td>
      <td>0.118063</td>
      <td>0.582495</td>
      <td>18.063315</td>
      <td>45.623836</td>
      <td>0.394158</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.521722</td>
      <td>1.083799</td>
      <td>1.381750</td>
      <td>0.582000</td>
      <td>0.545898</td>
      <td>0.742000</td>
      <td>0.673179</td>
      <td>0.108380</td>
      <td>0.690875</td>
      <td>8.379888</td>
      <td>38.175047</td>
      <td>0.412258</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6000</td>
      <td>0.469495</td>
      <td>0.953445</td>
      <td>1.310366</td>
      <td>0.512000</td>
      <td>0.494960</td>
      <td>0.703667</td>
      <td>0.643476</td>
      <td>0.095345</td>
      <td>0.786220</td>
      <td>-4.655493</td>
      <td>31.036623</td>
      <td>0.402202</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7000</td>
      <td>0.417658</td>
      <td>0.670391</td>
      <td>1.218941</td>
      <td>0.360000</td>
      <td>0.442290</td>
      <td>0.654571</td>
      <td>0.614735</td>
      <td>0.067039</td>
      <td>0.853259</td>
      <td>-32.960894</td>
      <td>21.894121</td>
      <td>0.331013</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8010</td>
      <td>0.360000</td>
      <td>0.700629</td>
      <td>1.153586</td>
      <td>0.376238</td>
      <td>0.389071</td>
      <td>0.619476</td>
      <td>0.586280</td>
      <td>0.070764</td>
      <td>0.924022</td>
      <td>-29.937128</td>
      <td>15.358595</td>
      <td>0.265707</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9000</td>
      <td>0.284405</td>
      <td>0.511634</td>
      <td>1.082971</td>
      <td>0.274747</td>
      <td>0.326935</td>
      <td>0.581556</td>
      <td>0.557752</td>
      <td>0.050652</td>
      <td>0.974674</td>
      <td>-48.836597</td>
      <td>8.297124</td>
      <td>0.161283</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.040000</td>
      <td>0.253259</td>
      <td>1.000000</td>
      <td>0.136000</td>
      <td>0.209755</td>
      <td>0.537000</td>
      <td>0.522953</td>
      <td>0.025326</td>
      <td>1.000000</td>
      <td>-74.674115</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-and-cross-validate-a-gradient-boosted-machine">
<h3>Train and cross-validate a gradient boosted machine<a class="headerlink" href="#train-and-cross-validate-a-gradient-boosted-machine" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbm</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span><span class="n">distribution</span> <span class="o">=</span> <span class="s2">&quot;bernoulli&quot;</span><span class="p">,</span>
                                   <span class="n">ntrees</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                   <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                                   <span class="n">min_rows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                                   <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
                                   <span class="n">nfolds</span> <span class="o">=</span> <span class="n">nfolds</span><span class="p">,</span>
                                   <span class="n">fold_assignment</span> <span class="o">=</span> <span class="s2">&quot;Modulo&quot;</span><span class="p">,</span>
                                   <span class="n">keep_cross_validation_predictions</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                   <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">gbm</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2OGradientBoostingEstimator :  Gradient Boosting Machine
Model Key:  GBM_model_python_1646667754917_970


Model Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1578.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on train data. **

MSE: 0.20052170746266884
RMSE: 0.44779650228945383
LogLoss: 0.5879177464092424
Mean Per-Class Error: 0.29613223631461116
AUC: 0.7735466157694937
AUCPR: 0.7909110775032231
Gini: 0.5470932315389874

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4424199442800167: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2433.0</td>
      <td>2272.0</td>
      <td>0.4829</td>
      <td>(2272.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>818.0</td>
      <td>4477.0</td>
      <td>0.1545</td>
      <td>(818.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>3251.0</td>
      <td>6749.0</td>
      <td>0.309</td>
      <td>(3090.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.442420</td>
      <td>0.743441</td>
      <td>244.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.335831</td>
      <td>0.858813</td>
      <td>324.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.542377</td>
      <td>0.726119</td>
      <td>166.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.507400</td>
      <td>0.704200</td>
      <td>192.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.790473</td>
      <td>0.973684</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.158255</td>
      <td>1.000000</td>
      <td>394.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.803933</td>
      <td>0.999575</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.519330</td>
      <td>0.407039</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.513347</td>
      <td>0.703507</td>
      <td>187.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.519330</td>
      <td>0.703868</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.803933</td>
      <td>4703.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.803933</td>
      <td>5245.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.116664</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.158255</td>
      <td>5295.000000</td>
      <td>394.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.803933</td>
      <td>0.999575</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.803933</td>
      <td>0.990557</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.116664</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.158255</td>
      <td>1.000000</td>
      <td>394.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.93 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0165</td>
      <td>0.788097</td>
      <td>1.831345</td>
      <td>1.831345</td>
      <td>0.969697</td>
      <td>0.794128</td>
      <td>0.969697</td>
      <td>0.794128</td>
      <td>0.030217</td>
      <td>0.030217</td>
      <td>83.134461</td>
      <td>83.134461</td>
      <td>0.029154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0309</td>
      <td>0.779039</td>
      <td>1.770538</td>
      <td>1.803008</td>
      <td>0.937500</td>
      <td>0.780161</td>
      <td>0.954693</td>
      <td>0.787619</td>
      <td>0.025496</td>
      <td>0.055713</td>
      <td>77.053824</td>
      <td>80.300766</td>
      <td>0.052737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0403</td>
      <td>0.769898</td>
      <td>1.727844</td>
      <td>1.785476</td>
      <td>0.914894</td>
      <td>0.776514</td>
      <td>0.945409</td>
      <td>0.785029</td>
      <td>0.016242</td>
      <td>0.071955</td>
      <td>72.784441</td>
      <td>78.547579</td>
      <td>0.067279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0520</td>
      <td>0.766379</td>
      <td>1.662591</td>
      <td>1.757827</td>
      <td>0.880342</td>
      <td>0.767629</td>
      <td>0.930769</td>
      <td>0.781114</td>
      <td>0.019452</td>
      <td>0.091407</td>
      <td>66.259090</td>
      <td>75.782669</td>
      <td>0.083756</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.1019</td>
      <td>0.733553</td>
      <td>1.680415</td>
      <td>1.719918</td>
      <td>0.889780</td>
      <td>0.746516</td>
      <td>0.910697</td>
      <td>0.764171</td>
      <td>0.083853</td>
      <td>0.175260</td>
      <td>68.041465</td>
      <td>71.991834</td>
      <td>0.155919</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1501</td>
      <td>0.703064</td>
      <td>1.586872</td>
      <td>1.677195</td>
      <td>0.840249</td>
      <td>0.720131</td>
      <td>0.888075</td>
      <td>0.750029</td>
      <td>0.076487</td>
      <td>0.251747</td>
      <td>58.687245</td>
      <td>67.719474</td>
      <td>0.216040</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.2100</td>
      <td>0.672701</td>
      <td>1.475547</td>
      <td>1.619677</td>
      <td>0.781302</td>
      <td>0.681960</td>
      <td>0.857619</td>
      <td>0.730613</td>
      <td>0.088385</td>
      <td>0.340132</td>
      <td>47.554706</td>
      <td>61.967714</td>
      <td>0.276583</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.3003</td>
      <td>0.631813</td>
      <td>1.294604</td>
      <td>1.521928</td>
      <td>0.685493</td>
      <td>0.653431</td>
      <td>0.805861</td>
      <td>0.707405</td>
      <td>0.116903</td>
      <td>0.457035</td>
      <td>29.460397</td>
      <td>52.192787</td>
      <td>0.333124</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.4003</td>
      <td>0.582373</td>
      <td>1.242682</td>
      <td>1.452169</td>
      <td>0.658000</td>
      <td>0.607055</td>
      <td>0.768923</td>
      <td>0.682336</td>
      <td>0.124268</td>
      <td>0.581303</td>
      <td>24.268178</td>
      <td>45.216866</td>
      <td>0.384704</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.5000</td>
      <td>0.519662</td>
      <td>1.102458</td>
      <td>1.382436</td>
      <td>0.583751</td>
      <td>0.552458</td>
      <td>0.732000</td>
      <td>0.656438</td>
      <td>0.109915</td>
      <td>0.691218</td>
      <td>10.245751</td>
      <td>38.243626</td>
      <td>0.406415</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.6000</td>
      <td>0.470374</td>
      <td>0.906516</td>
      <td>1.303116</td>
      <td>0.480000</td>
      <td>0.494559</td>
      <td>0.690000</td>
      <td>0.629458</td>
      <td>0.090652</td>
      <td>0.781870</td>
      <td>-9.348442</td>
      <td>30.311615</td>
      <td>0.386546</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.7004</td>
      <td>0.436366</td>
      <td>0.795684</td>
      <td>1.230377</td>
      <td>0.421315</td>
      <td>0.451070</td>
      <td>0.651485</td>
      <td>0.603887</td>
      <td>0.079887</td>
      <td>0.861756</td>
      <td>-20.431588</td>
      <td>23.037746</td>
      <td>0.342947</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.8000</td>
      <td>0.408689</td>
      <td>0.584017</td>
      <td>1.149906</td>
      <td>0.309237</td>
      <td>0.422132</td>
      <td>0.608875</td>
      <td>0.581258</td>
      <td>0.058168</td>
      <td>0.919924</td>
      <td>-41.598310</td>
      <td>14.990557</td>
      <td>0.254887</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.9009</td>
      <td>0.350489</td>
      <td>0.580236</td>
      <td>1.086103</td>
      <td>0.307235</td>
      <td>0.385621</td>
      <td>0.575092</td>
      <td>0.559347</td>
      <td>0.058546</td>
      <td>0.978470</td>
      <td>-41.976414</td>
      <td>8.610307</td>
      <td>0.164868</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>1.0000</td>
      <td>0.116664</td>
      <td>0.217253</td>
      <td>1.000000</td>
      <td>0.115035</td>
      <td>0.256620</td>
      <td>0.529500</td>
      <td>0.529347</td>
      <td>0.021530</td>
      <td>1.000000</td>
      <td>-78.274728</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on cross-validation data. **

MSE: 0.20591759601729728
RMSE: 0.4537814408030559
LogLoss: 0.5996635025616064
Mean Per-Class Error: 0.3109957762972908
AUC: 0.752800639024444
AUCPR: 0.7705701530928649
Gini: 0.5056012780488881

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4159392211190996: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1696.0</td>
      <td>3009.0</td>
      <td>0.6395</td>
      <td>(3009.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>538.0</td>
      <td>4757.0</td>
      <td>0.1016</td>
      <td>(538.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>2234.0</td>
      <td>7766.0</td>
      <td>0.3547</td>
      <td>(3547.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.415939</td>
      <td>0.728428</td>
      <td>268.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.279109</td>
      <td>0.855982</td>
      <td>346.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.561962</td>
      <td>0.711702</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.517902</td>
      <td>0.688800</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.158348</td>
      <td>1.000000</td>
      <td>392.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.517902</td>
      <td>0.377372</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.515693</td>
      <td>0.687354</td>
      <td>188.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.519427</td>
      <td>0.689004</td>
      <td>185.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.835804</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.835804</td>
      <td>5287.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.098410</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.158348</td>
      <td>5295.000000</td>
      <td>392.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.835804</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.835804</td>
      <td>0.998489</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.098410</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.158348</td>
      <td>1.000000</td>
      <td>392.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.91 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0101</td>
      <td>0.789519</td>
      <td>1.776382</td>
      <td>1.776382</td>
      <td>0.940594</td>
      <td>0.800149</td>
      <td>0.940594</td>
      <td>0.800149</td>
      <td>0.017941</td>
      <td>0.017941</td>
      <td>77.638160</td>
      <td>77.638160</td>
      <td>0.016666</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0204</td>
      <td>0.781367</td>
      <td>1.815231</td>
      <td>1.795997</td>
      <td>0.961165</td>
      <td>0.785390</td>
      <td>0.950980</td>
      <td>0.792698</td>
      <td>0.018697</td>
      <td>0.036638</td>
      <td>81.523144</td>
      <td>79.599696</td>
      <td>0.034513</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0335</td>
      <td>0.778060</td>
      <td>1.715575</td>
      <td>1.764548</td>
      <td>0.908397</td>
      <td>0.779096</td>
      <td>0.934328</td>
      <td>0.787379</td>
      <td>0.022474</td>
      <td>0.059112</td>
      <td>71.557497</td>
      <td>76.454836</td>
      <td>0.054436</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0407</td>
      <td>0.771218</td>
      <td>1.678733</td>
      <td>1.749367</td>
      <td>0.888889</td>
      <td>0.774200</td>
      <td>0.926290</td>
      <td>0.785047</td>
      <td>0.012087</td>
      <td>0.071199</td>
      <td>67.873256</td>
      <td>74.936719</td>
      <td>0.064823</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0523</td>
      <td>0.764063</td>
      <td>1.693204</td>
      <td>1.736910</td>
      <td>0.896552</td>
      <td>0.766315</td>
      <td>0.919694</td>
      <td>0.780893</td>
      <td>0.019641</td>
      <td>0.090840</td>
      <td>69.320439</td>
      <td>73.691043</td>
      <td>0.081914</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1010</td>
      <td>0.729840</td>
      <td>1.609360</td>
      <td>1.675408</td>
      <td>0.852156</td>
      <td>0.745647</td>
      <td>0.887129</td>
      <td>0.763898</td>
      <td>0.078376</td>
      <td>0.169216</td>
      <td>60.935988</td>
      <td>67.540833</td>
      <td>0.144987</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.1501</td>
      <td>0.699633</td>
      <td>1.565478</td>
      <td>1.639448</td>
      <td>0.828921</td>
      <td>0.716835</td>
      <td>0.868088</td>
      <td>0.748503</td>
      <td>0.076865</td>
      <td>0.246081</td>
      <td>56.547794</td>
      <td>63.944843</td>
      <td>0.203998</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.2000</td>
      <td>0.675508</td>
      <td>1.426839</td>
      <td>1.586402</td>
      <td>0.755511</td>
      <td>0.686070</td>
      <td>0.840000</td>
      <td>0.732926</td>
      <td>0.071199</td>
      <td>0.317280</td>
      <td>42.683857</td>
      <td>58.640227</td>
      <td>0.249268</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.3000</td>
      <td>0.628903</td>
      <td>1.318225</td>
      <td>1.497010</td>
      <td>0.698000</td>
      <td>0.649476</td>
      <td>0.792667</td>
      <td>0.705109</td>
      <td>0.131822</td>
      <td>0.449103</td>
      <td>31.822474</td>
      <td>49.700976</td>
      <td>0.316903</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.4000</td>
      <td>0.579228</td>
      <td>1.218130</td>
      <td>1.427290</td>
      <td>0.645000</td>
      <td>0.605317</td>
      <td>0.755750</td>
      <td>0.680161</td>
      <td>0.121813</td>
      <td>0.570916</td>
      <td>21.813031</td>
      <td>42.728990</td>
      <td>0.363265</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.5000</td>
      <td>0.520964</td>
      <td>1.059490</td>
      <td>1.353730</td>
      <td>0.561000</td>
      <td>0.550914</td>
      <td>0.716800</td>
      <td>0.654312</td>
      <td>0.105949</td>
      <td>0.676865</td>
      <td>5.949008</td>
      <td>35.372993</td>
      <td>0.375909</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.6000</td>
      <td>0.470755</td>
      <td>0.900850</td>
      <td>1.278250</td>
      <td>0.477000</td>
      <td>0.494393</td>
      <td>0.676833</td>
      <td>0.627659</td>
      <td>0.090085</td>
      <td>0.766950</td>
      <td>-9.915014</td>
      <td>27.824992</td>
      <td>0.354835</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.7009</td>
      <td>0.438080</td>
      <td>0.758050</td>
      <td>1.203363</td>
      <td>0.401388</td>
      <td>0.452376</td>
      <td>0.637181</td>
      <td>0.602425</td>
      <td>0.076487</td>
      <td>0.843437</td>
      <td>-24.194993</td>
      <td>20.336311</td>
      <td>0.302948</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.8003</td>
      <td>0.407245</td>
      <td>0.714390</td>
      <td>1.142631</td>
      <td>0.378270</td>
      <td>0.423648</td>
      <td>0.605023</td>
      <td>0.580221</td>
      <td>0.071010</td>
      <td>0.914448</td>
      <td>-28.560979</td>
      <td>14.263100</td>
      <td>0.242609</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.9001</td>
      <td>0.350168</td>
      <td>0.580954</td>
      <td>1.080354</td>
      <td>0.307615</td>
      <td>0.382479</td>
      <td>0.572048</td>
      <td>0.558296</td>
      <td>0.057979</td>
      <td>0.972427</td>
      <td>-41.904583</td>
      <td>8.035420</td>
      <td>0.153723</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.0000</td>
      <td>0.098410</td>
      <td>0.276008</td>
      <td>1.000000</td>
      <td>0.146146</td>
      <td>0.265874</td>
      <td>0.529500</td>
      <td>0.529083</td>
      <td>0.027573</td>
      <td>1.000000</td>
      <td>-72.399217</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross-Validation Metrics Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>cv_1_valid</th>
      <th>cv_2_valid</th>
      <th>cv_3_valid</th>
      <th>cv_4_valid</th>
      <th>cv_5_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>accuracy</td>
      <td>0.662000</td>
      <td>0.011028</td>
      <td>0.660500</td>
      <td>0.659000</td>
      <td>0.647500</td>
      <td>0.665000</td>
      <td>0.678000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auc</td>
      <td>0.753708</td>
      <td>0.008455</td>
      <td>0.767336</td>
      <td>0.754202</td>
      <td>0.749615</td>
      <td>0.744636</td>
      <td>0.752753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>err</td>
      <td>0.338000</td>
      <td>0.011028</td>
      <td>0.339500</td>
      <td>0.341000</td>
      <td>0.352500</td>
      <td>0.335000</td>
      <td>0.322000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>err_count</td>
      <td>676.000000</td>
      <td>22.056746</td>
      <td>679.000000</td>
      <td>682.000000</td>
      <td>705.000000</td>
      <td>670.000000</td>
      <td>644.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f0point5</td>
      <td>0.667733</td>
      <td>0.006292</td>
      <td>0.664405</td>
      <td>0.665501</td>
      <td>0.660570</td>
      <td>0.676335</td>
      <td>0.671854</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f1</td>
      <td>0.732593</td>
      <td>0.011290</td>
      <td>0.734662</td>
      <td>0.743802</td>
      <td>0.733056</td>
      <td>0.737666</td>
      <td>0.713778</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f2</td>
      <td>0.812088</td>
      <td>0.030635</td>
      <td>0.821535</td>
      <td>0.842984</td>
      <td>0.823409</td>
      <td>0.811230</td>
      <td>0.761282</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lift_top_group</td>
      <td>1.770414</td>
      <td>0.119520</td>
      <td>1.897533</td>
      <td>1.715529</td>
      <td>1.677038</td>
      <td>1.660517</td>
      <td>1.901455</td>
    </tr>
    <tr>
      <th>8</th>
      <td>logloss</td>
      <td>0.599664</td>
      <td>0.005876</td>
      <td>0.590319</td>
      <td>0.597491</td>
      <td>0.603376</td>
      <td>0.604522</td>
      <td>0.602610</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max_per_class_error</td>
      <td>0.581695</td>
      <td>0.083577</td>
      <td>0.597252</td>
      <td>0.647312</td>
      <td>0.644951</td>
      <td>0.576419</td>
      <td>0.442540</td>
    </tr>
    <tr>
      <th>10</th>
      <td>mcc</td>
      <td>0.336792</td>
      <td>0.022258</td>
      <td>0.340809</td>
      <td>0.343997</td>
      <td>0.303925</td>
      <td>0.330306</td>
      <td>0.364922</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mean_per_class_accuracy</td>
      <td>0.647136</td>
      <td>0.018742</td>
      <td>0.647294</td>
      <td>0.638961</td>
      <td>0.626088</td>
      <td>0.646292</td>
      <td>0.677043</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mean_per_class_error</td>
      <td>0.352864</td>
      <td>0.018742</td>
      <td>0.352705</td>
      <td>0.361039</td>
      <td>0.373912</td>
      <td>0.353708</td>
      <td>0.322957</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mse</td>
      <td>0.205918</td>
      <td>0.002593</td>
      <td>0.201783</td>
      <td>0.204980</td>
      <td>0.207443</td>
      <td>0.208073</td>
      <td>0.207309</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pr_auc</td>
      <td>0.771801</td>
      <td>0.013353</td>
      <td>0.792843</td>
      <td>0.772931</td>
      <td>0.772372</td>
      <td>0.762701</td>
      <td>0.758159</td>
    </tr>
    <tr>
      <th>15</th>
      <td>precision</td>
      <td>0.630703</td>
      <td>0.012138</td>
      <td>0.624585</td>
      <td>0.621859</td>
      <td>0.619718</td>
      <td>0.640816</td>
      <td>0.646538</td>
    </tr>
    <tr>
      <th>16</th>
      <td>r2</td>
      <td>0.172814</td>
      <td>0.011294</td>
      <td>0.190509</td>
      <td>0.176042</td>
      <td>0.165018</td>
      <td>0.161792</td>
      <td>0.170710</td>
    </tr>
    <tr>
      <th>17</th>
      <td>recall</td>
      <td>0.875966</td>
      <td>0.048658</td>
      <td>0.891841</td>
      <td>0.925234</td>
      <td>0.897127</td>
      <td>0.869004</td>
      <td>0.796627</td>
    </tr>
    <tr>
      <th>18</th>
      <td>rmse</td>
      <td>0.453774</td>
      <td>0.002864</td>
      <td>0.449202</td>
      <td>0.452747</td>
      <td>0.455459</td>
      <td>0.456151</td>
      <td>0.455312</td>
    </tr>
    <tr>
      <th>19</th>
      <td>specificity</td>
      <td>0.418305</td>
      <td>0.083577</td>
      <td>0.402748</td>
      <td>0.352688</td>
      <td>0.355049</td>
      <td>0.423581</td>
      <td>0.557460</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scoring History: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.154 sec</td>
      <td>0.0</td>
      <td>0.499129</td>
      <td>0.691406</td>
      <td>0.500000</td>
      <td>0.529500</td>
      <td>1.000000</td>
      <td>0.4705</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.168 sec</td>
      <td>1.0</td>
      <td>0.488236</td>
      <td>0.669779</td>
      <td>0.689191</td>
      <td>0.674970</td>
      <td>1.340835</td>
      <td>0.3927</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.183 sec</td>
      <td>2.0</td>
      <td>0.479807</td>
      <td>0.653146</td>
      <td>0.719111</td>
      <td>0.725388</td>
      <td>1.545030</td>
      <td>0.3958</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.197 sec</td>
      <td>3.0</td>
      <td>0.473698</td>
      <td>0.641037</td>
      <td>0.724650</td>
      <td>0.731284</td>
      <td>1.569032</td>
      <td>0.3933</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.211 sec</td>
      <td>4.0</td>
      <td>0.467046</td>
      <td>0.627816</td>
      <td>0.746638</td>
      <td>0.760063</td>
      <td>1.683844</td>
      <td>0.3692</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.227 sec</td>
      <td>5.0</td>
      <td>0.462994</td>
      <td>0.619629</td>
      <td>0.750899</td>
      <td>0.766012</td>
      <td>1.696473</td>
      <td>0.3404</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.242 sec</td>
      <td>6.0</td>
      <td>0.458301</td>
      <td>0.609973</td>
      <td>0.756603</td>
      <td>0.772386</td>
      <td>1.733566</td>
      <td>0.3515</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.256 sec</td>
      <td>7.0</td>
      <td>0.455569</td>
      <td>0.604192</td>
      <td>0.758101</td>
      <td>0.773795</td>
      <td>1.748075</td>
      <td>0.3512</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.287 sec</td>
      <td>8.0</td>
      <td>0.452777</td>
      <td>0.598335</td>
      <td>0.763715</td>
      <td>0.778986</td>
      <td>1.754413</td>
      <td>0.3180</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.303 sec</td>
      <td>9.0</td>
      <td>0.449743</td>
      <td>0.591929</td>
      <td>0.768491</td>
      <td>0.784821</td>
      <td>1.776659</td>
      <td>0.3207</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>2022-03-07 07:43:16</td>
      <td>1.321 sec</td>
      <td>10.0</td>
      <td>0.447797</td>
      <td>0.587918</td>
      <td>0.773547</td>
      <td>0.790911</td>
      <td>1.831345</td>
      <td>0.3090</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable Importances: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>x26</td>
      <td>565.332336</td>
      <td>1.000000</td>
      <td>0.410859</td>
    </tr>
    <tr>
      <th>1</th>
      <td>x28</td>
      <td>204.503998</td>
      <td>0.361741</td>
      <td>0.148625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>x27</td>
      <td>189.230789</td>
      <td>0.334725</td>
      <td>0.137525</td>
    </tr>
    <tr>
      <th>3</th>
      <td>x23</td>
      <td>124.527618</td>
      <td>0.220273</td>
      <td>0.090501</td>
    </tr>
    <tr>
      <th>4</th>
      <td>x6</td>
      <td>121.551117</td>
      <td>0.215008</td>
      <td>0.088338</td>
    </tr>
    <tr>
      <th>5</th>
      <td>x25</td>
      <td>99.598267</td>
      <td>0.176176</td>
      <td>0.072384</td>
    </tr>
    <tr>
      <th>6</th>
      <td>x4</td>
      <td>44.359753</td>
      <td>0.078467</td>
      <td>0.032239</td>
    </tr>
    <tr>
      <th>7</th>
      <td>x10</td>
      <td>18.008587</td>
      <td>0.031855</td>
      <td>0.013088</td>
    </tr>
    <tr>
      <th>8</th>
      <td>x22</td>
      <td>3.660778</td>
      <td>0.006475</td>
      <td>0.002660</td>
    </tr>
    <tr>
      <th>9</th>
      <td>x18</td>
      <td>3.097153</td>
      <td>0.005478</td>
      <td>0.002251</td>
    </tr>
    <tr>
      <th>10</th>
      <td>x5</td>
      <td>2.104541</td>
      <td>0.003723</td>
      <td>0.001529</td>
    </tr>
    <tr>
      <th>11</th>
      <td>x1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>x2</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>x3</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>x7</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>x8</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>x9</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>x11</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>x12</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>x13</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="gradient-boosted-machine-test-set-performance">
<h3>Gradient boosted machine test set performance<a class="headerlink" href="#gradient-boosted-machine-test-set-performance" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbm</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on test data. **

MSE: 0.20579980230216896
RMSE: 0.453651630992515
LogLoss: 0.5991607617229083
Mean Per-Class Error: 0.3132779098342524
AUC: 0.7522686229794354
AUCPR: 0.7766705936284869
Gini: 0.5045372459588708

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.42008076282776335: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>948.0</td>
      <td>1367.0</td>
      <td>0.5905</td>
      <td>(1367.0/2315.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>325.0</td>
      <td>2360.0</td>
      <td>0.121</td>
      <td>(325.0/2685.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>1273.0</td>
      <td>3727.0</td>
      <td>0.3384</td>
      <td>(1692.0/5000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.420081</td>
      <td>0.736120</td>
      <td>265.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.271036</td>
      <td>0.859410</td>
      <td>354.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.544346</td>
      <td>0.716075</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.484325</td>
      <td>0.682800</td>
      <td>209.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.788080</td>
      <td>0.977778</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.143335</td>
      <td>1.000000</td>
      <td>396.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.803916</td>
      <td>0.999568</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.544346</td>
      <td>0.374728</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.506104</td>
      <td>0.676890</td>
      <td>192.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.544346</td>
      <td>0.686722</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.803916</td>
      <td>2314.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.803916</td>
      <td>2663.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.116664</td>
      <td>2315.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.143335</td>
      <td>2685.000000</td>
      <td>396.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.803916</td>
      <td>0.999568</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.803916</td>
      <td>0.991806</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.116664</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.143335</td>
      <td>1.000000</td>
      <td>396.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 53.70 %, avg score: 52.40 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0178</td>
      <td>0.788097</td>
      <td>1.820350</td>
      <td>1.820350</td>
      <td>0.977528</td>
      <td>0.793217</td>
      <td>0.977528</td>
      <td>0.793217</td>
      <td>0.032402</td>
      <td>0.032402</td>
      <td>82.035026</td>
      <td>82.035026</td>
      <td>0.031538</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.0316</td>
      <td>0.779039</td>
      <td>1.700267</td>
      <td>1.767909</td>
      <td>0.913043</td>
      <td>0.779782</td>
      <td>0.949367</td>
      <td>0.787350</td>
      <td>0.023464</td>
      <td>0.055866</td>
      <td>70.026718</td>
      <td>76.790892</td>
      <td>0.052410</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.0406</td>
      <td>0.771638</td>
      <td>1.779433</td>
      <td>1.770464</td>
      <td>0.955556</td>
      <td>0.776606</td>
      <td>0.950739</td>
      <td>0.784968</td>
      <td>0.016015</td>
      <td>0.071881</td>
      <td>77.943306</td>
      <td>77.046353</td>
      <td>0.067561</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0532</td>
      <td>0.766379</td>
      <td>1.507493</td>
      <td>1.708181</td>
      <td>0.809524</td>
      <td>0.767939</td>
      <td>0.917293</td>
      <td>0.780935</td>
      <td>0.018994</td>
      <td>0.090875</td>
      <td>50.749313</td>
      <td>70.818107</td>
      <td>0.081372</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.1000</td>
      <td>0.728488</td>
      <td>1.639370</td>
      <td>1.675978</td>
      <td>0.880342</td>
      <td>0.745772</td>
      <td>0.900000</td>
      <td>0.764479</td>
      <td>0.076723</td>
      <td>0.167598</td>
      <td>63.937035</td>
      <td>67.597765</td>
      <td>0.145999</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.1502</td>
      <td>0.692784</td>
      <td>1.468984</td>
      <td>1.606796</td>
      <td>0.788845</td>
      <td>0.713905</td>
      <td>0.862850</td>
      <td>0.747576</td>
      <td>0.073743</td>
      <td>0.241341</td>
      <td>46.898440</td>
      <td>60.679615</td>
      <td>0.196848</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.2014</td>
      <td>0.670097</td>
      <td>1.513035</td>
      <td>1.582960</td>
      <td>0.812500</td>
      <td>0.676769</td>
      <td>0.850050</td>
      <td>0.729575</td>
      <td>0.077467</td>
      <td>0.318808</td>
      <td>51.303538</td>
      <td>58.296025</td>
      <td>0.253581</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.3022</td>
      <td>0.624524</td>
      <td>1.296887</td>
      <td>1.487540</td>
      <td>0.696429</td>
      <td>0.647864</td>
      <td>0.798809</td>
      <td>0.702320</td>
      <td>0.130726</td>
      <td>0.449534</td>
      <td>29.688747</td>
      <td>48.753955</td>
      <td>0.318217</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.4002</td>
      <td>0.571753</td>
      <td>1.189526</td>
      <td>1.414563</td>
      <td>0.638776</td>
      <td>0.598000</td>
      <td>0.759620</td>
      <td>0.676774</td>
      <td>0.116574</td>
      <td>0.566108</td>
      <td>18.952609</td>
      <td>41.456274</td>
      <td>0.358333</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.5002</td>
      <td>0.508286</td>
      <td>1.027933</td>
      <td>1.337268</td>
      <td>0.552000</td>
      <td>0.540824</td>
      <td>0.718113</td>
      <td>0.649595</td>
      <td>0.102793</td>
      <td>0.668901</td>
      <td>2.793296</td>
      <td>33.726770</td>
      <td>0.364366</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.6000</td>
      <td>0.462089</td>
      <td>0.914305</td>
      <td>1.266915</td>
      <td>0.490982</td>
      <td>0.486185</td>
      <td>0.680333</td>
      <td>0.622415</td>
      <td>0.091248</td>
      <td>0.760149</td>
      <td>-8.569467</td>
      <td>26.691496</td>
      <td>0.345894</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.7000</td>
      <td>0.432698</td>
      <td>0.849162</td>
      <td>1.207236</td>
      <td>0.456000</td>
      <td>0.445603</td>
      <td>0.648286</td>
      <td>0.597156</td>
      <td>0.084916</td>
      <td>0.845065</td>
      <td>-15.083799</td>
      <td>20.723597</td>
      <td>0.313316</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.8022</td>
      <td>0.405301</td>
      <td>0.645027</td>
      <td>1.135611</td>
      <td>0.346380</td>
      <td>0.419238</td>
      <td>0.609823</td>
      <td>0.574489</td>
      <td>0.065922</td>
      <td>0.910987</td>
      <td>-35.497272</td>
      <td>13.561078</td>
      <td>0.234961</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.9000</td>
      <td>0.346606</td>
      <td>0.590267</td>
      <td>1.076350</td>
      <td>0.316973</td>
      <td>0.382333</td>
      <td>0.578000</td>
      <td>0.553608</td>
      <td>0.057728</td>
      <td>0.968715</td>
      <td>-40.973293</td>
      <td>7.635009</td>
      <td>0.148413</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>1.0000</td>
      <td>0.116664</td>
      <td>0.312849</td>
      <td>1.000000</td>
      <td>0.168000</td>
      <td>0.257595</td>
      <td>0.537000</td>
      <td>0.524007</td>
      <td>0.031285</td>
      <td>1.000000</td>
      <td>-68.715084</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="train-a-stacked-ensemble-using-the-gbm-and-rf-above">
<h2>3. Train a stacked ensemble using the GBM and RF above<a class="headerlink" href="#train-a-stacked-ensemble-using-the-gbm-and-rf-above" title="Permalink to this headline">¶</a></h2>
<p>What’s going on here - anything suspicious?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">H2OStackedEnsembleEstimator</span><span class="p">(</span><span class="n">model_id</span> <span class="o">=</span> <span class="s2">&quot;my_ensemble_binomial&quot;</span><span class="p">,</span>
                                       <span class="n">base_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">rf</span><span class="p">,</span> <span class="n">gbm</span><span class="p">])</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2OStackedEnsembleEstimator :  Stacked Ensemble
Model Key:  my_ensemble_binomial

No model summary for this model

ModelMetricsBinomialGLM: stackedensemble
** Reported on train data. **

MSE: 0.034414533979938884
RMSE: 0.1855115467563647
LogLoss: 0.18617000727747787
Null degrees of freedom: 9999
Residual degrees of freedom: 9997
Null deviance: 13828.113387424342
Residual deviance: 3723.4001455495572
AIC: 3729.4001455495572
AUC: 0.9999900453478558
AUCPR: 0.9999911890971335
Gini: 0.9999800906957117

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4952892042214926: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>4692.0</td>
      <td>13.0</td>
      <td>0.0028</td>
      <td>(13.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3.0</td>
      <td>5292.0</td>
      <td>0.0006</td>
      <td>(3.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>4695.0</td>
      <td>5305.0</td>
      <td>0.0016</td>
      <td>(16.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.495289</td>
      <td>0.998491</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.495289</td>
      <td>0.999056</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.550520</td>
      <td>0.998978</td>
      <td>192.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.512894</td>
      <td>0.998400</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.947625</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.432910</td>
      <td>1.000000</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.947625</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.495289</td>
      <td>0.996790</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.512894</td>
      <td>0.998300</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.512894</td>
      <td>0.998394</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.947625</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.947625</td>
      <td>5283.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.040123</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.432910</td>
      <td>5295.000000</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.947625</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.947625</td>
      <td>0.997734</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.040123</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.432910</td>
      <td>1.000000</td>
      <td>211.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.69 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.01</td>
      <td>0.939745</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.943046</td>
      <td>1.000000</td>
      <td>0.943046</td>
      <td>0.018886</td>
      <td>0.018886</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.018886</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.02</td>
      <td>0.935499</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.937644</td>
      <td>1.000000</td>
      <td>0.940345</td>
      <td>0.018886</td>
      <td>0.037771</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.037771</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.03</td>
      <td>0.932326</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.933926</td>
      <td>1.000000</td>
      <td>0.938205</td>
      <td>0.018886</td>
      <td>0.056657</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.056657</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.04</td>
      <td>0.929278</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.930792</td>
      <td>1.000000</td>
      <td>0.936352</td>
      <td>0.018886</td>
      <td>0.075543</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.075543</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.05</td>
      <td>0.926211</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.927677</td>
      <td>1.000000</td>
      <td>0.934617</td>
      <td>0.018886</td>
      <td>0.094429</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.094429</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.10</td>
      <td>0.912796</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.919384</td>
      <td>1.000000</td>
      <td>0.927000</td>
      <td>0.094429</td>
      <td>0.188857</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.188857</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.15</td>
      <td>0.899271</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.905914</td>
      <td>1.000000</td>
      <td>0.919971</td>
      <td>0.094429</td>
      <td>0.283286</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.283286</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.20</td>
      <td>0.883838</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.891593</td>
      <td>1.000000</td>
      <td>0.912877</td>
      <td>0.094429</td>
      <td>0.377715</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.377715</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.30</td>
      <td>0.849319</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.867316</td>
      <td>1.000000</td>
      <td>0.897690</td>
      <td>0.188857</td>
      <td>0.566572</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.566572</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.40</td>
      <td>0.794174</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.824146</td>
      <td>1.000000</td>
      <td>0.879304</td>
      <td>0.188857</td>
      <td>0.755430</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.755430</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.50</td>
      <td>0.693718</td>
      <td>1.888574</td>
      <td>1.888574</td>
      <td>1.000</td>
      <td>0.750479</td>
      <td>1.000000</td>
      <td>0.853539</td>
      <td>0.188857</td>
      <td>0.944287</td>
      <td>88.857413</td>
      <td>88.857413</td>
      <td>0.944287</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.60</td>
      <td>0.267411</td>
      <td>0.557129</td>
      <td>1.666667</td>
      <td>0.295</td>
      <td>0.427287</td>
      <td>0.882500</td>
      <td>0.782497</td>
      <td>0.055713</td>
      <td>1.000000</td>
      <td>-44.287063</td>
      <td>66.666667</td>
      <td>0.850159</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.70</td>
      <td>0.180121</td>
      <td>0.000000</td>
      <td>1.428571</td>
      <td>0.000</td>
      <td>0.216202</td>
      <td>0.756429</td>
      <td>0.701598</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>42.857143</td>
      <td>0.637620</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.80</td>
      <td>0.138450</td>
      <td>0.000000</td>
      <td>1.250000</td>
      <td>0.000</td>
      <td>0.157657</td>
      <td>0.661875</td>
      <td>0.633605</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>25.000000</td>
      <td>0.425080</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.90</td>
      <td>0.104401</td>
      <td>0.000000</td>
      <td>1.111111</td>
      <td>0.000</td>
      <td>0.122343</td>
      <td>0.588333</td>
      <td>0.576798</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>11.111111</td>
      <td>0.212540</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.00</td>
      <td>0.038562</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000</td>
      <td>0.077432</td>
      <td>0.529500</td>
      <td>0.526862</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<section id="ensemble-performance-on-test-set">
<h3>Ensemble performance on test set<a class="headerlink" href="#ensemble-performance-on-test-set" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_stack_test</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">perf_stack_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomialGLM: stackedensemble
** Reported on test data. **

MSE: 0.19097357833656903
RMSE: 0.43700523833996435
LogLoss: 0.5620616630522318
Null degrees of freedom: 4999
Residual degrees of freedom: 4997
Null deviance: 6905.196403260959
Residual deviance: 5620.616630522318
AIC: 5626.616630522318
AUC: 0.7787452892036794
AUCPR: 0.8019528045514408
Gini: 0.5574905784073587

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.3261076325075436: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>971.0</td>
      <td>1344.0</td>
      <td>0.5806</td>
      <td>(1344.0/2315.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>285.0</td>
      <td>2400.0</td>
      <td>0.1061</td>
      <td>(285.0/2685.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>1256.0</td>
      <td>3744.0</td>
      <td>0.3258</td>
      <td>(1629.0/5000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.326108</td>
      <td>0.746617</td>
      <td>288.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.150854</td>
      <td>0.860876</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.609668</td>
      <td>0.740688</td>
      <td>155.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.486185</td>
      <td>0.708400</td>
      <td>212.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.942076</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.087693</td>
      <td>1.000000</td>
      <td>389.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.942076</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.543978</td>
      <td>0.420678</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.502175</td>
      <td>0.704968</td>
      <td>204.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.543978</td>
      <td>0.710596</td>
      <td>186.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.942076</td>
      <td>2315.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.942076</td>
      <td>2683.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.049868</td>
      <td>2315.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.087693</td>
      <td>2685.000000</td>
      <td>389.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.942076</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.942076</td>
      <td>0.999255</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.049868</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.087693</td>
      <td>1.000000</td>
      <td>389.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 53.70 %, avg score: 52.14 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.01</td>
      <td>0.916338</td>
      <td>1.862197</td>
      <td>1.862197</td>
      <td>1.000</td>
      <td>0.924969</td>
      <td>1.000000</td>
      <td>0.924969</td>
      <td>0.018622</td>
      <td>0.018622</td>
      <td>86.219739</td>
      <td>86.219739</td>
      <td>0.018622</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.02</td>
      <td>0.909256</td>
      <td>1.713222</td>
      <td>1.787709</td>
      <td>0.920</td>
      <td>0.912814</td>
      <td>0.960000</td>
      <td>0.918892</td>
      <td>0.017132</td>
      <td>0.035754</td>
      <td>71.322160</td>
      <td>78.770950</td>
      <td>0.034026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.03</td>
      <td>0.900496</td>
      <td>1.713222</td>
      <td>1.762880</td>
      <td>0.920</td>
      <td>0.905124</td>
      <td>0.946667</td>
      <td>0.914302</td>
      <td>0.017132</td>
      <td>0.052886</td>
      <td>71.322160</td>
      <td>76.288020</td>
      <td>0.049431</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.04</td>
      <td>0.893308</td>
      <td>1.824953</td>
      <td>1.778399</td>
      <td>0.980</td>
      <td>0.896996</td>
      <td>0.955000</td>
      <td>0.909976</td>
      <td>0.018250</td>
      <td>0.071136</td>
      <td>82.495345</td>
      <td>77.839851</td>
      <td>0.067248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.05</td>
      <td>0.884151</td>
      <td>1.750466</td>
      <td>1.772812</td>
      <td>0.940</td>
      <td>0.889545</td>
      <td>0.952000</td>
      <td>0.905890</td>
      <td>0.017505</td>
      <td>0.088641</td>
      <td>75.046555</td>
      <td>77.281192</td>
      <td>0.083457</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.10</td>
      <td>0.844421</td>
      <td>1.653631</td>
      <td>1.713222</td>
      <td>0.888</td>
      <td>0.864111</td>
      <td>0.920000</td>
      <td>0.885000</td>
      <td>0.082682</td>
      <td>0.171322</td>
      <td>65.363128</td>
      <td>71.322160</td>
      <td>0.154044</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.15</td>
      <td>0.803300</td>
      <td>1.608939</td>
      <td>1.678461</td>
      <td>0.864</td>
      <td>0.824145</td>
      <td>0.901333</td>
      <td>0.864715</td>
      <td>0.080447</td>
      <td>0.251769</td>
      <td>60.893855</td>
      <td>67.846058</td>
      <td>0.219804</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.20</td>
      <td>0.768014</td>
      <td>1.482309</td>
      <td>1.629423</td>
      <td>0.796</td>
      <td>0.786533</td>
      <td>0.875000</td>
      <td>0.845170</td>
      <td>0.074115</td>
      <td>0.325885</td>
      <td>48.230912</td>
      <td>62.942272</td>
      <td>0.271889</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.30</td>
      <td>0.690902</td>
      <td>1.337058</td>
      <td>1.531968</td>
      <td>0.718</td>
      <td>0.730971</td>
      <td>0.822667</td>
      <td>0.807103</td>
      <td>0.133706</td>
      <td>0.459590</td>
      <td>33.705773</td>
      <td>53.196772</td>
      <td>0.344688</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.40</td>
      <td>0.605813</td>
      <td>1.284916</td>
      <td>1.470205</td>
      <td>0.690</td>
      <td>0.647687</td>
      <td>0.789500</td>
      <td>0.767249</td>
      <td>0.128492</td>
      <td>0.588082</td>
      <td>28.491620</td>
      <td>47.020484</td>
      <td>0.406224</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.50</td>
      <td>0.513835</td>
      <td>1.035382</td>
      <td>1.383240</td>
      <td>0.556</td>
      <td>0.561543</td>
      <td>0.742800</td>
      <td>0.726108</td>
      <td>0.103538</td>
      <td>0.691620</td>
      <td>3.538175</td>
      <td>38.324022</td>
      <td>0.413866</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.60</td>
      <td>0.434118</td>
      <td>0.912477</td>
      <td>1.304780</td>
      <td>0.490</td>
      <td>0.474993</td>
      <td>0.700667</td>
      <td>0.684256</td>
      <td>0.091248</td>
      <td>0.782868</td>
      <td>-8.752328</td>
      <td>30.477964</td>
      <td>0.394963</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.70</td>
      <td>0.360893</td>
      <td>0.744879</td>
      <td>1.224794</td>
      <td>0.400</td>
      <td>0.396396</td>
      <td>0.657714</td>
      <td>0.643133</td>
      <td>0.074488</td>
      <td>0.857356</td>
      <td>-25.512104</td>
      <td>22.479383</td>
      <td>0.339861</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.80</td>
      <td>0.289899</td>
      <td>0.666667</td>
      <td>1.155028</td>
      <td>0.358</td>
      <td>0.324702</td>
      <td>0.620250</td>
      <td>0.603329</td>
      <td>0.066667</td>
      <td>0.924022</td>
      <td>-33.333333</td>
      <td>15.502793</td>
      <td>0.267867</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.90</td>
      <td>0.202715</td>
      <td>0.491620</td>
      <td>1.081316</td>
      <td>0.264</td>
      <td>0.250001</td>
      <td>0.580667</td>
      <td>0.564070</td>
      <td>0.049162</td>
      <td>0.973184</td>
      <td>-50.837989</td>
      <td>8.131595</td>
      <td>0.158066</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.00</td>
      <td>0.049055</td>
      <td>0.268156</td>
      <td>1.000000</td>
      <td>0.144</td>
      <td>0.137303</td>
      <td>0.537000</td>
      <td>0.521394</td>
      <td>0.026816</td>
      <td>1.000000</td>
      <td>-73.184358</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-to-base-learner-performance-on-the-test-set">
<h3>Compare to base learner performance on the test set<a class="headerlink" href="#compare-to-base-learner-performance-on-the-test-set" title="Permalink to this headline">¶</a></h3>
<p>The ensemble is a little better, but it is still pretty close…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_gbm_test</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">perf_rf_test</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">baselearner_best_auc_test</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">perf_gbm_test</span><span class="o">.</span><span class="n">auc</span><span class="p">(),</span> <span class="n">perf_rf_test</span><span class="o">.</span><span class="n">auc</span><span class="p">())</span>
<span class="n">stack_auc_test</span> <span class="o">=</span> <span class="n">perf_stack_test</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Base-learner Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">baselearner_best_auc_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack_auc_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Base-learner Test AUC:  0.7786910723119803
Ensemble Test AUC:  0.7787452892036794
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-predictions-on-a-test-set-if-neccessary">
<h3>Generate predictions on a test set (if neccessary)<a class="headerlink" href="#generate-predictions-on-a-test-set-if-neccessary" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">predictions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">  predict</th><th style="text-align: right;">      p0</th><th style="text-align: right;">      p1</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.70526 </td><td style="text-align: right;">0.29474 </td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.513641</td><td style="text-align: right;">0.486359</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.612075</td><td style="text-align: right;">0.387925</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.247459</td><td style="text-align: right;">0.752541</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.496399</td><td style="text-align: right;">0.503601</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.297365</td><td style="text-align: right;">0.702635</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.341914</td><td style="text-align: right;">0.658086</td></tr>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.71747 </td><td style="text-align: right;">0.28253 </td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.634757</td><td style="text-align: right;">0.365243</td></tr>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.708404</td><td style="text-align: right;">0.291596</td></tr>
</tbody>
</table></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="generate-a-random-grid-of-models-and-stack-them-together">
<h2>4. Generate a random grid of models and stack them together<a class="headerlink" href="#generate-a-random-grid-of-models-and-stack-them-together" title="Permalink to this headline">¶</a></h2>
<section id="specify-gbm-hyperparameters-for-the-grid">
<h3>Specify GBM hyperparameters for the grid<a class="headerlink" href="#specify-gbm-hyperparameters-for-the-grid" title="Permalink to this headline">¶</a></h3>
<p>Keep in mind it might be easier to define sequences of numbers for your various hyperparameter tunings.</p>
<p>Also, exponential and logarithmic scales are probably preferred to linear ones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyper_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;learn_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                <span class="s2">&quot;sample_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                <span class="s2">&quot;col_sample_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]}</span>
<span class="n">search_criteria</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;RandomDiscrete&quot;</span><span class="p">,</span> <span class="s2">&quot;max_models&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train the grid</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">H2OGridSearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span><span class="n">ntrees</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                                        <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                                                        <span class="n">nfolds</span> <span class="o">=</span> <span class="n">nfolds</span><span class="p">,</span>
                                                        <span class="n">fold_assignment</span> <span class="o">=</span> <span class="s1">&#39;Modulo&#39;</span><span class="p">,</span>
                                                        <span class="n">keep_cross_validation_predictions</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
                     <span class="n">hyper_params</span><span class="o">=</span><span class="n">hyper_params</span><span class="p">,</span>
                     <span class="n">search_criteria</span><span class="o">=</span><span class="n">search_criteria</span><span class="p">,</span>
                     <span class="n">grid_id</span><span class="o">=</span><span class="s2">&quot;gbm_grid_binomial&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    col_sample_rate learn_rate max_depth sample_rate  \
0               0.4        0.8         3         0.7   
1               0.2        0.8         4         0.8   
2               0.7       0.03         5         0.9   

                   model_ids             logloss  
0  gbm_grid_binomial_model_3     0.5866851338931  
1  gbm_grid_binomial_model_2  0.6144661087268164  
2  gbm_grid_binomial_model_1  0.6535517466453371  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="train-a-stacked-ensemble-using-the-gbm-grid">
<h2>5. Train a stacked ensemble using the GBM grid<a class="headerlink" href="#train-a-stacked-ensemble-using-the-gbm-grid" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">H2OStackedEnsembleEstimator</span><span class="p">(</span><span class="n">model_id</span> <span class="o">=</span> <span class="s2">&quot;my_ensemble_gbm_grid_binomial&quot;</span><span class="p">,</span>
                                       <span class="n">base_models</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">model_ids</span><span class="p">)</span>
<span class="n">ensemble</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2OStackedEnsembleEstimator :  Stacked Ensemble
Model Key:  my_ensemble_gbm_grid_binomial

No model summary for this model

ModelMetricsBinomialGLM: stackedensemble
** Reported on train data. **

MSE: 0.17897505903570504
RMSE: 0.42305443980143387
LogLoss: 0.5357403550336852
Null degrees of freedom: 9999
Residual degrees of freedom: 9996
Null deviance: 13828.113387424342
Residual deviance: 10714.807100673706
AIC: 10722.807100673706
AUC: 0.8093464349400262
AUCPR: 0.8219046127206588
Gini: 0.6186928698800525

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4037334009318257: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2723.0</td>
      <td>1982.0</td>
      <td>0.4213</td>
      <td>(1982.0/4705.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>779.0</td>
      <td>4516.0</td>
      <td>0.1471</td>
      <td>(779.0/5295.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>3502.0</td>
      <td>6498.0</td>
      <td>0.2761</td>
      <td>(2761.0/10000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.403733</td>
      <td>0.765878</td>
      <td>248.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.241819</td>
      <td>0.864462</td>
      <td>330.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.579602</td>
      <td>0.756389</td>
      <td>167.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.515885</td>
      <td>0.734700</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.904517</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.118691</td>
      <td>1.000000</td>
      <td>385.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.904517</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.515885</td>
      <td>0.467751</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.528054</td>
      <td>0.731350</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.515885</td>
      <td>0.733957</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.904517</td>
      <td>4705.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.904517</td>
      <td>5281.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.077394</td>
      <td>4705.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.118691</td>
      <td>5295.000000</td>
      <td>385.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.904517</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.904517</td>
      <td>0.997356</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.077394</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.118691</td>
      <td>1.000000</td>
      <td>385.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 52.95 %, avg score: 52.96 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.01</td>
      <td>0.887257</td>
      <td>1.869688</td>
      <td>1.869688</td>
      <td>0.990</td>
      <td>0.893840</td>
      <td>0.990000</td>
      <td>0.893840</td>
      <td>0.018697</td>
      <td>0.018697</td>
      <td>86.968839</td>
      <td>86.968839</td>
      <td>0.018484</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.02</td>
      <td>0.879296</td>
      <td>1.794145</td>
      <td>1.831917</td>
      <td>0.950</td>
      <td>0.883362</td>
      <td>0.970000</td>
      <td>0.888601</td>
      <td>0.017941</td>
      <td>0.036638</td>
      <td>79.414542</td>
      <td>83.191690</td>
      <td>0.035363</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.03</td>
      <td>0.872364</td>
      <td>1.850803</td>
      <td>1.838212</td>
      <td>0.980</td>
      <td>0.875594</td>
      <td>0.973333</td>
      <td>0.884265</td>
      <td>0.018508</td>
      <td>0.055146</td>
      <td>85.080264</td>
      <td>83.821215</td>
      <td>0.053446</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.04</td>
      <td>0.866487</td>
      <td>1.775260</td>
      <td>1.822474</td>
      <td>0.940</td>
      <td>0.869257</td>
      <td>0.965000</td>
      <td>0.880513</td>
      <td>0.017753</td>
      <td>0.072899</td>
      <td>77.525968</td>
      <td>82.247403</td>
      <td>0.069923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.05</td>
      <td>0.860642</td>
      <td>1.756374</td>
      <td>1.809254</td>
      <td>0.930</td>
      <td>0.863476</td>
      <td>0.958000</td>
      <td>0.877106</td>
      <td>0.017564</td>
      <td>0.090463</td>
      <td>75.637394</td>
      <td>80.925401</td>
      <td>0.085999</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.10</td>
      <td>0.834422</td>
      <td>1.688385</td>
      <td>1.748820</td>
      <td>0.894</td>
      <td>0.847602</td>
      <td>0.926000</td>
      <td>0.862354</td>
      <td>0.084419</td>
      <td>0.174882</td>
      <td>68.838527</td>
      <td>74.881964</td>
      <td>0.159154</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.15</td>
      <td>0.807362</td>
      <td>1.650614</td>
      <td>1.716084</td>
      <td>0.874</td>
      <td>0.821115</td>
      <td>0.908667</td>
      <td>0.848607</td>
      <td>0.082531</td>
      <td>0.257413</td>
      <td>65.061379</td>
      <td>71.608436</td>
      <td>0.228295</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.20</td>
      <td>0.776635</td>
      <td>1.578848</td>
      <td>1.681775</td>
      <td>0.836</td>
      <td>0.792606</td>
      <td>0.890500</td>
      <td>0.834607</td>
      <td>0.078942</td>
      <td>0.336355</td>
      <td>57.884797</td>
      <td>68.177526</td>
      <td>0.289809</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.30</td>
      <td>0.711611</td>
      <td>1.423985</td>
      <td>1.595845</td>
      <td>0.754</td>
      <td>0.744221</td>
      <td>0.845000</td>
      <td>0.804478</td>
      <td>0.142398</td>
      <td>0.478754</td>
      <td>42.398489</td>
      <td>59.584514</td>
      <td>0.379923</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.40</td>
      <td>0.629691</td>
      <td>1.278565</td>
      <td>1.516525</td>
      <td>0.677</td>
      <td>0.671084</td>
      <td>0.803000</td>
      <td>0.771130</td>
      <td>0.127856</td>
      <td>0.606610</td>
      <td>27.856468</td>
      <td>51.652502</td>
      <td>0.439129</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.50</td>
      <td>0.541550</td>
      <td>1.118036</td>
      <td>1.436827</td>
      <td>0.592</td>
      <td>0.587137</td>
      <td>0.760800</td>
      <td>0.734331</td>
      <td>0.111804</td>
      <td>0.718414</td>
      <td>11.803588</td>
      <td>43.682720</td>
      <td>0.464216</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.60</td>
      <td>0.445375</td>
      <td>0.942398</td>
      <td>1.354422</td>
      <td>0.499</td>
      <td>0.492175</td>
      <td>0.717167</td>
      <td>0.693972</td>
      <td>0.094240</td>
      <td>0.812653</td>
      <td>-5.760151</td>
      <td>35.442241</td>
      <td>0.451973</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.70</td>
      <td>0.357635</td>
      <td>0.734655</td>
      <td>1.265884</td>
      <td>0.389</td>
      <td>0.402200</td>
      <td>0.670286</td>
      <td>0.652290</td>
      <td>0.073466</td>
      <td>0.886119</td>
      <td>-26.534466</td>
      <td>26.588426</td>
      <td>0.395577</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.80</td>
      <td>0.287211</td>
      <td>0.576015</td>
      <td>1.179651</td>
      <td>0.305</td>
      <td>0.323135</td>
      <td>0.624625</td>
      <td>0.611146</td>
      <td>0.057602</td>
      <td>0.943720</td>
      <td>-42.398489</td>
      <td>17.965061</td>
      <td>0.305463</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.90</td>
      <td>0.212128</td>
      <td>0.400378</td>
      <td>1.093065</td>
      <td>0.212</td>
      <td>0.250433</td>
      <td>0.578778</td>
      <td>0.571067</td>
      <td>0.040038</td>
      <td>0.983758</td>
      <td>-59.962229</td>
      <td>9.306474</td>
      <td>0.178020</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.00</td>
      <td>0.076684</td>
      <td>0.162417</td>
      <td>1.000000</td>
      <td>0.086</td>
      <td>0.156392</td>
      <td>0.529500</td>
      <td>0.529599</td>
      <td>0.016242</td>
      <td>1.000000</td>
      <td>-83.758263</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<section id="eval-ensemble-performance-on-the-test-data">
<h3>Eval ensemble performance on the test data<a class="headerlink" href="#eval-ensemble-performance-on-the-test-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_stack_test</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">perf_stack_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomialGLM: stackedensemble
** Reported on test data. **

MSE: 0.19646981512542924
RMSE: 0.44324915693707667
LogLoss: 0.5753535672126392
Null degrees of freedom: 4999
Residual degrees of freedom: 4996
Null deviance: 6905.196403260959
Residual deviance: 5753.5356721263925
AIC: 5761.5356721263925
AUC: 0.7658850264045916
AUCPR: 0.7928758222962261
Gini: 0.5317700528091831

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.35412909231741746: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1068.0</td>
      <td>1247.0</td>
      <td>0.5387</td>
      <td>(1247.0/2315.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>367.0</td>
      <td>2318.0</td>
      <td>0.1367</td>
      <td>(367.0/2685.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>1435.0</td>
      <td>3565.0</td>
      <td>0.3228</td>
      <td>(1614.0/5000.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.354129</td>
      <td>0.741760</td>
      <td>275.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.178761</td>
      <td>0.860706</td>
      <td>362.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.580789</td>
      <td>0.727106</td>
      <td>159.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.520792</td>
      <td>0.696400</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.897976</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.094361</td>
      <td>1.000000</td>
      <td>396.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.897976</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.580789</td>
      <td>0.394906</td>
      <td>159.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.519258</td>
      <td>0.695464</td>
      <td>191.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.579075</td>
      <td>0.696613</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.897976</td>
      <td>2315.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.897976</td>
      <td>2680.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.081080</td>
      <td>2315.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.094361</td>
      <td>2685.000000</td>
      <td>396.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.897976</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.897976</td>
      <td>0.998138</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.081080</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.094361</td>
      <td>1.000000</td>
      <td>396.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 53.70 %, avg score: 52.42 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.01</td>
      <td>0.887794</td>
      <td>1.862197</td>
      <td>1.862197</td>
      <td>1.000</td>
      <td>0.891943</td>
      <td>1.000000</td>
      <td>0.891943</td>
      <td>0.018622</td>
      <td>0.018622</td>
      <td>86.219739</td>
      <td>86.219739</td>
      <td>0.018622</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.02</td>
      <td>0.878222</td>
      <td>1.787709</td>
      <td>1.824953</td>
      <td>0.960</td>
      <td>0.883015</td>
      <td>0.980000</td>
      <td>0.887479</td>
      <td>0.017877</td>
      <td>0.036499</td>
      <td>78.770950</td>
      <td>82.495345</td>
      <td>0.035635</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.03</td>
      <td>0.872278</td>
      <td>1.824953</td>
      <td>1.824953</td>
      <td>0.980</td>
      <td>0.875645</td>
      <td>0.980000</td>
      <td>0.883535</td>
      <td>0.018250</td>
      <td>0.054749</td>
      <td>82.495345</td>
      <td>82.495345</td>
      <td>0.053453</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.04</td>
      <td>0.865552</td>
      <td>1.713222</td>
      <td>1.797020</td>
      <td>0.920</td>
      <td>0.869065</td>
      <td>0.965000</td>
      <td>0.879917</td>
      <td>0.017132</td>
      <td>0.071881</td>
      <td>71.322160</td>
      <td>79.702048</td>
      <td>0.068857</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.05</td>
      <td>0.858329</td>
      <td>1.750466</td>
      <td>1.787709</td>
      <td>0.940</td>
      <td>0.861865</td>
      <td>0.960000</td>
      <td>0.876307</td>
      <td>0.017505</td>
      <td>0.089385</td>
      <td>75.046555</td>
      <td>78.770950</td>
      <td>0.085066</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.10</td>
      <td>0.830711</td>
      <td>1.564246</td>
      <td>1.675978</td>
      <td>0.840</td>
      <td>0.844201</td>
      <td>0.900000</td>
      <td>0.860254</td>
      <td>0.078212</td>
      <td>0.167598</td>
      <td>56.424581</td>
      <td>67.597765</td>
      <td>0.145999</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.15</td>
      <td>0.799415</td>
      <td>1.579143</td>
      <td>1.643700</td>
      <td>0.848</td>
      <td>0.815299</td>
      <td>0.882667</td>
      <td>0.845269</td>
      <td>0.078957</td>
      <td>0.246555</td>
      <td>57.914339</td>
      <td>64.369957</td>
      <td>0.208542</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.20</td>
      <td>0.768224</td>
      <td>1.534451</td>
      <td>1.616387</td>
      <td>0.824</td>
      <td>0.785330</td>
      <td>0.868000</td>
      <td>0.830284</td>
      <td>0.076723</td>
      <td>0.323277</td>
      <td>53.445065</td>
      <td>61.638734</td>
      <td>0.266258</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.30</td>
      <td>0.697137</td>
      <td>1.333333</td>
      <td>1.522036</td>
      <td>0.716</td>
      <td>0.733487</td>
      <td>0.817333</td>
      <td>0.798018</td>
      <td>0.133333</td>
      <td>0.456611</td>
      <td>33.333333</td>
      <td>52.203600</td>
      <td>0.338252</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.40</td>
      <td>0.614587</td>
      <td>1.199255</td>
      <td>1.441341</td>
      <td>0.644</td>
      <td>0.654905</td>
      <td>0.774000</td>
      <td>0.762240</td>
      <td>0.119926</td>
      <td>0.576536</td>
      <td>19.925512</td>
      <td>44.134078</td>
      <td>0.381288</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.50</td>
      <td>0.529258</td>
      <td>1.031657</td>
      <td>1.359404</td>
      <td>0.554</td>
      <td>0.572284</td>
      <td>0.730000</td>
      <td>0.724249</td>
      <td>0.103166</td>
      <td>0.679702</td>
      <td>3.165736</td>
      <td>35.940410</td>
      <td>0.388125</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.60</td>
      <td>0.439839</td>
      <td>0.890130</td>
      <td>1.281192</td>
      <td>0.478</td>
      <td>0.483960</td>
      <td>0.688000</td>
      <td>0.684201</td>
      <td>0.089013</td>
      <td>0.768715</td>
      <td>-10.986965</td>
      <td>28.119181</td>
      <td>0.364395</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.70</td>
      <td>0.362819</td>
      <td>0.830540</td>
      <td>1.216813</td>
      <td>0.446</td>
      <td>0.399804</td>
      <td>0.653429</td>
      <td>0.643572</td>
      <td>0.083054</td>
      <td>0.851769</td>
      <td>-16.945996</td>
      <td>21.681298</td>
      <td>0.327795</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.80</td>
      <td>0.291686</td>
      <td>0.681564</td>
      <td>1.149907</td>
      <td>0.366</td>
      <td>0.326802</td>
      <td>0.617500</td>
      <td>0.603976</td>
      <td>0.068156</td>
      <td>0.919926</td>
      <td>-31.843575</td>
      <td>14.990689</td>
      <td>0.259018</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.90</td>
      <td>0.209548</td>
      <td>0.499069</td>
      <td>1.077592</td>
      <td>0.268</td>
      <td>0.251839</td>
      <td>0.578667</td>
      <td>0.564850</td>
      <td>0.049907</td>
      <td>0.969832</td>
      <td>-50.093110</td>
      <td>7.759156</td>
      <td>0.150826</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.00</td>
      <td>0.081080</td>
      <td>0.301676</td>
      <td>1.000000</td>
      <td>0.162</td>
      <td>0.158619</td>
      <td>0.537000</td>
      <td>0.524227</td>
      <td>0.030168</td>
      <td>1.000000</td>
      <td>-69.832402</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id1">
<h2>6. Compare to base learner performance on the test set<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baselearner_best_auc_test</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">h2o</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">test_data</span><span class="o">=</span><span class="n">test</span><span class="p">)</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">model_ids</span><span class="p">])</span>
<span class="n">stack_auc_test</span> <span class="o">=</span> <span class="n">perf_stack_test</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Base-learner Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">baselearner_best_auc_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble Test AUC:  </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack_auc_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Base-learner Test AUC:  0.7535296885746348
Ensemble Test AUC:  0.7658850264045916
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>Generate predictions on a test set (if neccessary)<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions2</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">predictions2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">  predict</th><th style="text-align: right;">      p0</th><th style="text-align: right;">      p1</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.752499</td><td style="text-align: right;">0.247501</td></tr>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.692124</td><td style="text-align: right;">0.307876</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.490744</td><td style="text-align: right;">0.509256</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.293398</td><td style="text-align: right;">0.706602</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.514172</td><td style="text-align: right;">0.485828</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.292388</td><td style="text-align: right;">0.707612</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.336833</td><td style="text-align: right;">0.663167</td></tr>
<tr><td style="text-align: right;">        0</td><td style="text-align: right;">0.661777</td><td style="text-align: right;">0.338223</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.612586</td><td style="text-align: right;">0.387414</td></tr>
<tr><td style="text-align: right;">        1</td><td style="text-align: right;">0.627887</td><td style="text-align: right;">0.372113</td></tr>
</tbody>
</table></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="deep-learning-basics">
<h2>Deep learning basics<a class="headerlink" href="#deep-learning-basics" title="Permalink to this headline">¶</a></h2>
<p>Deep learning is a subfield of machine learning that uses a variety of multi-layered artificial neural networks to model datasets and predict outcomes.</p>
<section id="the-human-brain-model-key-terms">
<h3>The human brain model key terms<a class="headerlink" href="#the-human-brain-model-key-terms" title="Permalink to this headline">¶</a></h3>
<p>The idea was originally modelled on the human brain, which has ~100 billion neurons.</p>
<ul class="simple">
<li><p>The <strong>soma</strong> (neuron body) holds the architecture for cell function and energy processing.</p></li>
<li><p><strong>Dendrites</strong> receive information from other neurons and transfer it towards the soma.</p></li>
<li><p><strong>Axons</strong> send information from the soma towards other dendrites/soma.</p></li>
<li><p>Dendrites and axons are connected by a <strong>synapse</strong>.</p></li>
</ul>
</section>
<section id="information-transfer-in-the-human-brain">
<h3>Information transfer in the human brain<a class="headerlink" href="#information-transfer-in-the-human-brain" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>An outbound neuron produces an electrical signal called a <strong>spike</strong> that travel’s to the synapse, where chemicals called <strong>neurotransmitters</strong>.</p></li>
<li><p>Receptors on the inbound neuron receive the neurotransmitter, to generate another electrical signal to send the original signal to the soma.</p></li>
<li><p>Whether or not neurons are fired in simultaneously or in success depend on the strength/amount of the spikes. If a certain threshold is crossed, the next neuron will be activated.</p></li>
</ol>
<p><img alt="neuron" src="../_images/neuron.png" /></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Neuron">Wikipedia</a></p>
</section>
</section>
<section id="are-deep-neural-networks-really-like-the-human-brain">
<h2>Are deep neural networks really like the human brain?<a class="headerlink" href="#are-deep-neural-networks-really-like-the-human-brain" title="Permalink to this headline">¶</a></h2>
<p>Deep artificial networks were originally modelled on the human brain, and many argue for and against their likeness. See for yourself by reading the below posts!</p>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/nerd-for-tech/neural-networks-68531432fb5">Neural Networks</a></p></li>
<li><p><a class="reference external" href="https://medium.com/swlh/do-neural-networks-really-work-like-neurons-667859dbfb4f">Do neural networks really work like neurons?</a></p></li>
<li><p><a class="reference external" href="https://analyticsindiamag.com/neural-networks-not-work-like-human-brains-lets-debunk-myth/">Neural Networks Do Not Work Like Human Brains – Let’s Debunk The Myth</a></p></li>
<li><p><a class="reference external" href="https://bdtechtalks.com/2020/06/22/direct-fit-artificial-neural-networks/">Artificial neural networks are more similar to the brain than they get credit for</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/heres-why-we-may-need-to-rethink-artificial-neural-networks-c7492f51b7bc">Here’s Why We May Need to Rethink Artificial Neural Networks</a></p></li>
<li><p><a class="reference external" href="https://www.quantamagazine.org/artificial-neural-nets-finally-yield-clues-to-how-brains-learn-20210218/">Artificial Neural Nets Finally Yield Clues to How Brains Learn</a></p></li>
</ul>
</section>
<section id="why-deep-learning">
<h2>Why deep learning?<a class="headerlink" href="#why-deep-learning" title="Permalink to this headline">¶</a></h2>
<p>Deep learning is ideal for all data types, but especially text, image, video, and sound because deep representative networks store these data as large matrices. Also, error is recycled (backpropagated) to update the model weights and make better predictions during the next epoch. .</p>
<p>To understand deep networks, let’s start with a toy example of a single feed forward neural network - a perceptron.</p>
<p>Read Goodfellow et al’s Deep Learning Book to learn more: <a class="reference external" href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># generate toy dataset</span>
<span class="n">example</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
           <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
           <span class="s1">&#39;xm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="s1">&#39;output&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span>
           <span class="p">}</span>
<span class="n">example_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">example</span><span class="p">)</span>
<span class="n">example_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>xm</th>
      <th>output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><img alt="perceptron" src="../_images/perceptron.png" /></p>
<p>Perceptron figure modified from <a class="reference external" href="https://sebastianraschka.com/Articles/2015_singlelayer_neurons.html">Sebastian Raschka’s Single-Layer Neural Networks and Gradient Descent</a></p>
<p>Perceptron key terms:</p>
<ul class="simple">
<li><p><strong>Layer:</strong> the neural architecture or the network typology of a deep learning model, usually divided into variations of input, hidden, preprocessing, encoder/decoder, and output.</p></li>
<li><p><strong>Inputs/Nodes:</strong> features/covariates/predictors/independent variables (the columns of 1’s and 0s from <code class="docutils literal notranslate"><span class="pre">example_df</span></code> above), but they could be words from a text or pixels from an image.</p></li>
<li><p><strong>Weights:</strong> the learnable parameters of a model that connect the input layer to the output via the net input (summation) and activation functions. Weights are often randomly initialized.</p></li>
<li><p><strong>Bias term:</strong> A placeholder “1” assures that we do not receive only 0 predictions of our features are zero or close to 0.</p></li>
<li><p><strong>Net input function:</strong> computes the weighted sum of the input layer.</p></li>
<li><p><strong>Activation function:</strong> determines if a neuron should be fired or not. In binary classification for example, this defines a threshold (0.5 for example) for determining if a 1 or 0 should be predicted.</p></li>
<li><p><strong>Output:</strong> a node that contains the y prediction.</p></li>
<li><p><strong>Error:</strong> how far off an output prediction was. The weights are updated by adjusting the learning rate based on the error to reduce it for the next epoch.</p></li>
<li><p><strong>Epoch:</strong> full pass of the training data.</p></li>
<li><p><strong>Backpropagation:</strong></p></li>
<li><p><strong>Hyperparameters:</strong> our definition of the neural architecture, including but not limited to: number of hidden units, weight initialization, learning rate, batch size, dropout, etc.</p></li>
</ul>
</section>
<section id="what-makes-a-network-deep">
<h2>What makes a network “deep”?<a class="headerlink" href="#what-makes-a-network-deep" title="Permalink to this headline">¶</a></h2>
<p>A “deep” network is just network with multiple/many hidden layers for handling potential nonlinear transformations.</p>
<ul class="simple">
<li><p>Fully connected layer: a layer where all nodes are connected to every node in the next layer (as indicated by the purple arrows</p></li>
</ul>
<p><img alt="deep" src="../_images/deep.png" /></p>
<p>Example of “deep” network with two hidden layers modified from <a class="reference external" href="https://devskrol.com/2020/11/22/388/">DevSkrol’s Artificial Neural Network Explained with an Regression Example</a></p>
<blockquote>
<div><p>NOTE: Bias term not shown for some reason?</p>
</div></blockquote>
</section>
<section id="classify-images-of-cats-and-dogs">
<h2>Classify images of cats and dogs<a class="headerlink" href="#classify-images-of-cats-and-dogs" title="Permalink to this headline">¶</a></h2>
<p>Let’s go through François Chollet’s “Image classification from scratch” <a class="reference external" href="https://keras.io/examples/vision/image_classification_from_scratch/">tutorial</a> to examine this architecture and predict images of cats versus dogs.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/keras-team/keras-io/blob/master/examples/vision/ipynb/image_classification_from_scratch.ipynb">Click here to open the Colab notebook</a></p>
<blockquote>
<div><p>NOTE: One pain point for working with your own images is importing them correctly. Schedule a consultation with SSDS if you need help! <a class="reference external" href="https://ssds.stanford.edu/">https://ssds.stanford.edu/</a></p>
</div></blockquote>
<p>You should also check out his deep learning book Deep Learning with Python (R version also available): <a class="reference external" href="https://www.manning.com/books/deep-learning-with-python-second-edition">https://www.manning.com/books/deep-learning-with-python-second-edition</a></p>
<p><img alt="dogcat" src="../_images/dogcat.jpg" /></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "EastBayEv/SSDS-TAML",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./winter2022"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Chapter4.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Chapter 4 - The BERT algorithm</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Chapter6.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Chapter 6 - Writing about numeric data</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Software and Services for Data Science (SSDS) at Stanford Libraries<br/>
        
            &copy; Copyright 2021-2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>